{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1IBffwatfk47UdEVFPK0SIY81VeyUoIFS","timestamp":1666210019426},{"file_id":"1nh5-GeRJjev5nadjz8F6_Yd821V0E0gg","timestamp":1666015349653}],"collapsed_sections":["92UhQ5RW9pvc","tK443_qGEePA","Nt2jpc7Tsads"],"mount_file_id":"1ZyRAuQV-RnlTpoB4wnzT9smn2DhufD-H","authorship_tag":"ABX9TyOAyg4Yg3HtXflYrHq6WiKZ"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"9fc90fab9c6441bea258f357842baaed":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3c99466fdd1f4a188339a87f2520536c","IPY_MODEL_a5f8b4db9ba647d0b03be473c568371c","IPY_MODEL_f61715b79bfb4d709203793dc05ca358"],"layout":"IPY_MODEL_71e1f08201f846aaa9ebf61ccdcc5930"}},"3c99466fdd1f4a188339a87f2520536c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9a167157f6284724921ad90710b7910d","placeholder":"​","style":"IPY_MODEL_1e867ba54bed4b9b801d9fbc6cdd84d9","value":"100%"}},"a5f8b4db9ba647d0b03be473c568371c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_47c99e3e4a4b4e8e826a44f38c0660e4","max":22447,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6d9c73019cdd45f28e9f8f09b2d69183","value":22447}},"f61715b79bfb4d709203793dc05ca358":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1edeab21663b449d86c4a5f6757d5d69","placeholder":"​","style":"IPY_MODEL_0a8ed0cc33244d13b67b9c7c0331ea55","value":" 22447/22447 [00:19&lt;00:00, 1936.37it/s]"}},"71e1f08201f846aaa9ebf61ccdcc5930":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a167157f6284724921ad90710b7910d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e867ba54bed4b9b801d9fbc6cdd84d9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"47c99e3e4a4b4e8e826a44f38c0660e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6d9c73019cdd45f28e9f8f09b2d69183":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1edeab21663b449d86c4a5f6757d5d69":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a8ed0cc33244d13b67b9c7c0331ea55":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1d019713062f4011990ce5c394427544":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d940f7e2e13841ab827fda75757c94b1","IPY_MODEL_27002a5f648944f091742847ed3dc4c1","IPY_MODEL_82d31061ad4743049a029212e733517a"],"layout":"IPY_MODEL_fee28fdca6c44454b1ea50d5be5b8776"}},"d940f7e2e13841ab827fda75757c94b1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4ca35c9611a24906b821e98371338d3e","placeholder":"​","style":"IPY_MODEL_837c06e80e2e4cb18bb269191d929e15","value":"100%"}},"27002a5f648944f091742847ed3dc4c1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_326bd7d27a7e4905a03a33e601933eae","max":5927,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e01c71ee9b5340eaa41d4141a721fbc4","value":5927}},"82d31061ad4743049a029212e733517a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cf9ce952e4e44b859ee41f3e7682c20e","placeholder":"​","style":"IPY_MODEL_64b06965a892438b93509052319931a9","value":" 5927/5927 [00:08&lt;00:00, 427.12it/s]"}},"fee28fdca6c44454b1ea50d5be5b8776":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ca35c9611a24906b821e98371338d3e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"837c06e80e2e4cb18bb269191d929e15":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"326bd7d27a7e4905a03a33e601933eae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e01c71ee9b5340eaa41d4141a721fbc4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cf9ce952e4e44b859ee41f3e7682c20e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"64b06965a892438b93509052319931a9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b8d69ecc085145daad6d7c892401145b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e7708648946d4f89b153140a1ff008f4","IPY_MODEL_721663bcaedf467f95d662b5aa819c26","IPY_MODEL_ba000201731a42df89c981d96e1caa13"],"layout":"IPY_MODEL_f838515cc12d4a60a29dabe0bdbbbcfd"}},"e7708648946d4f89b153140a1ff008f4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8046e06a0ca644fbb3c0964aabd07cfe","placeholder":"​","style":"IPY_MODEL_7144aeb664b94b09bd70f40924dbe55f","value":"100%"}},"721663bcaedf467f95d662b5aa819c26":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4c76405cdf074245b3e6c64239fa3c2f","max":9796,"min":0,"orientation":"horizontal","style":"IPY_MODEL_76fe68a0e8ce4a48804f3dc94a83b607","value":9796}},"ba000201731a42df89c981d96e1caa13":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f2769269d2bf470ba11edfac36db6f78","placeholder":"​","style":"IPY_MODEL_df045cb62a4145868f8d5f4bfedd255b","value":" 9796/9796 [00:04&lt;00:00, 2020.12it/s]"}},"f838515cc12d4a60a29dabe0bdbbbcfd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8046e06a0ca644fbb3c0964aabd07cfe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7144aeb664b94b09bd70f40924dbe55f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4c76405cdf074245b3e6c64239fa3c2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"76fe68a0e8ce4a48804f3dc94a83b607":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f2769269d2bf470ba11edfac36db6f78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df045cb62a4145868f8d5f4bfedd255b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8e545914642b4596aa9ed03764375c62":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1a94ce1675bc400e91c03b835c80cd37","IPY_MODEL_1c366ca351584cbda4801808dc452315","IPY_MODEL_3431b7b96df04c89b0e5d54d59266022"],"layout":"IPY_MODEL_a4dd26bff150486e9550e1e73e8267e2"}},"1a94ce1675bc400e91c03b835c80cd37":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0c427924690741d6a314f8dd79a1e268","placeholder":"​","style":"IPY_MODEL_919fdd9f887d49fda89c04f3b72aad56","value":"100%"}},"1c366ca351584cbda4801808dc452315":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8d941f5ca487432a848071f35b275f70","max":3266,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d08f99f499f347cc97976393fd9cc8aa","value":3266}},"3431b7b96df04c89b0e5d54d59266022":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c6e3be3198b14a9993e78c168d05da30","placeholder":"​","style":"IPY_MODEL_0f74adbb115c4693b2ad79416ab22f7e","value":" 3266/3266 [00:01&lt;00:00, 2058.63it/s]"}},"a4dd26bff150486e9550e1e73e8267e2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0c427924690741d6a314f8dd79a1e268":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"919fdd9f887d49fda89c04f3b72aad56":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8d941f5ca487432a848071f35b275f70":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d08f99f499f347cc97976393fd9cc8aa":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c6e3be3198b14a9993e78c168d05da30":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0f74adbb115c4693b2ad79416ab22f7e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d411a81a06a94b8298f5e90192bb25b9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ca83eff8b5a244529d20a71b1f8cacfd","IPY_MODEL_3bc159a2a0c54951bf21f6a5b368c835","IPY_MODEL_3c130c85123543de80b59aa8d02e88f9"],"layout":"IPY_MODEL_86ed57aca8a8495690dcf4d9d993337c"}},"ca83eff8b5a244529d20a71b1f8cacfd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_39e954100aa84b85b394bb6b713f7155","placeholder":"​","style":"IPY_MODEL_40c5cad1d93a4d02bebe6a83d1a724d3","value":"100%"}},"3bc159a2a0c54951bf21f6a5b368c835":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c9a02c63b4b64fc29437b0717c201ea8","max":5927,"min":0,"orientation":"horizontal","style":"IPY_MODEL_158565d2b4814faaac29f8141427dd5f","value":5927}},"3c130c85123543de80b59aa8d02e88f9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_820badd400c24ea6b13b9ec763dc1543","placeholder":"​","style":"IPY_MODEL_add79652b5da4a26b40ddd1e90a3e3e4","value":" 5927/5927 [00:07&lt;00:00, 465.42it/s]"}},"86ed57aca8a8495690dcf4d9d993337c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"39e954100aa84b85b394bb6b713f7155":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"40c5cad1d93a4d02bebe6a83d1a724d3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c9a02c63b4b64fc29437b0717c201ea8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"158565d2b4814faaac29f8141427dd5f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"820badd400c24ea6b13b9ec763dc1543":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"add79652b5da4a26b40ddd1e90a3e3e4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"T-m8UH7pFGbw","executionInfo":{"status":"ok","timestamp":1666211029114,"user_tz":-180,"elapsed":2901,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"985ec00b-8a82-4178-9c45-5074e935dcb3"},"outputs":[{"output_type":"stream","name":"stdout","text":["Archive:  /content/drive/MyDrive/4 курс/NLP/ДЗ1/public_data (1).zip\n","  inflating: test_data.csv           \n","  inflating: train_data.csv          \n","  inflating: train_solution.csv      \n"]}],"source":["!unzip \"/content/drive/MyDrive/4 курс/NLP/ДЗ1/public_data (1).zip\""]},{"cell_type":"code","source":["# !unzip \"/content/drive/MyDrive/4 курс/NLP/ДЗ1/archive (3).zip\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yswVgWXAFRc1","executionInfo":{"status":"ok","timestamp":1666211031358,"user_tz":-180,"elapsed":2272,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"60a72f50-6a83-46e4-da47-f00e4785694c"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Archive:  /content/drive/MyDrive/4 курс/NLP/ДЗ1/archive (3).zip\n","  inflating: News_Category_Dataset_v3.json  \n"]}]},{"cell_type":"code","source":["!cp \"/content/drive/MyDrive/4 курс/NLP/ДЗ1/students_dubki_chat.csv\" .\n","!cp \"/content/drive/MyDrive/4 курс/NLP/ДЗ1/nlp_chat.csv\" ."],"metadata":{"id":"Ne0SdM-2z_lI","executionInfo":{"status":"ok","timestamp":1666211033179,"user_tz":-180,"elapsed":1829,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","import numpy as np\n","from matplotlib import pyplot as plt\n","import re\n","from nltk.corpus import stopwords\n","import nltk \n","from nltk.tokenize import TweetTokenizer"],"metadata":{"id":"DY8QD2HL8de8","executionInfo":{"status":"ok","timestamp":1666211039440,"user_tz":-180,"elapsed":2880,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["pd.set_option('display.max_columns', None)  \n","pd.set_option('display.expand_frame_repr', False)\n","pd.set_option('max_colwidth', 800)\n","nltk.download(\"stopwords\")\n","tknzr = TweetTokenizer()\n","nltk.download('punkt')"],"metadata":{"id":"HaadK0pF1kzA","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666211041220,"user_tz":-180,"elapsed":1787,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"49af73d8-ffc4-424f-bb82-7b0df78e416d"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/stopwords.zip.\n","[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Unzipping tokenizers/punkt.zip.\n"]},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":6}]},{"cell_type":"markdown","source":["# NEW_data"],"metadata":{"id":"MrmFtI8J8dwM"}},{"cell_type":"code","source":["# df = pd.read_json('/content/News_Category_Dataset_v3.json', lines=True)"],"metadata":{"id":"zL8ptR_T8dwN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data = df[df['category'] == 'STYLE & BEAUTY'].short_description\n","# categoty = pd.Series([2 for i in range(len(new_data))])"],"metadata":{"id":"l6u_Qkom8dwO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data = pd.DataFrame(new_data).reset_index()"],"metadata":{"id":"yHpMbeR68dwO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data['category'] = pd.Series([2 for i in range(len(new_data))])"],"metadata":{"id":"zSxp91fb8dwP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data =new_data.drop('index', axis=1)"],"metadata":{"id":"YGJDD9748dwP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# len(new_data)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666167715078,"user_tz":-180,"elapsed":10,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"1fa2d877-31de-4297-d8f1-8b1cbacd17ae","id":"5P8tTqb18dwP"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["9814"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["# new_data.sample(20)"],"metadata":{"id":"khpXhqlY8dwQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data.to_csv('new_data_fashion.csv')"],"metadata":{"id":"TSaD3w3i8dwQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# del df\n","# del new_data"],"metadata":{"id":"-sGCDdNY8dwQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# DATA_for_CNN"],"metadata":{"id":"G5Sqzopr87Ul"}},{"cell_type":"code","source":["df = pd.read_csv(\"train_data.csv\")\n","labels = pd.read_csv(\"train_solution.csv\")"],"metadata":{"id":"7cmshuzcFimD","executionInfo":{"status":"ok","timestamp":1666211041223,"user_tz":-180,"elapsed":25,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["df = df.merge(labels, left_on='id', right_on='id')\n"],"metadata":{"id":"Mj6D4xjHFk19","executionInfo":{"status":"ok","timestamp":1666211041226,"user_tz":-180,"elapsed":26,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":389},"id":"xsHAXknhFhOA","executionInfo":{"status":"ok","timestamp":1666211041229,"user_tz":-180,"elapsed":28,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"af1ec5a2-a202-4b2f-b3ac-2cedb9bbd635"},"source":["df.head()"],"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          message  category\n","0  271828  Over $616 million in Bitcoin was electrocated in September with Wrapped Bitcoin (WBTC) data from CoinDesk. The emissions increased by more than 160 per cent compared to August, when $232 million was currentized.  WBTC's output grew along with the demand for over-the-counter (OTC) market, reported by Grapefruit Trading. It became one of the first OTC platforms to release WBTC via the BitGo service.  The Grapefruit Trading Trader Getty Hill claims that clients' interest in translating bitcoin into WBTC comes from their desire to use the first cryptation in the decentralized finance ecosystem (DeFi).  CEO's FTX Exchange Sam Bankman-Frid acknowledged that the demand for WBTC at the OTC market remained significant, though not as high as it had been in previous months during the rapid rise o...         1\n","1  271829                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Quiz: Thursday or friday?         0\n","2  271830  The Australian Revenue Authority will start collecting taxes from crypto transactions this year. The Authority has developed methods to search for and identify cryptovaly investors.  In March 2018, the Australian Revenue Authority announced that the forthcoming identification process would involve AML and bilateral agreements. The data comparison method will also be used to deonymize buyers of crypthalates. Tax agent Liz Russell notes that most users will soon be identified and their debts will be known.  The authorities believe that, because of Bitcoin's recent strong appreciation to $200,000, investors could have earned profits that were not recorded in their tax obligations. If users have suffered losses, these amounts can be deducted from taxable profits.  The Authority recalls tha...         1\n","3  271831                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Let's continue😉. I present to you my new review          2\n","4  271832                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Here comes your future palette.         2"],"text/html":["\n","  <div id=\"df-c346f2a3-bb53-4434-a023-1092306f69ef\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>271828</td>\n","      <td>Over $616 million in Bitcoin was electrocated in September with Wrapped Bitcoin (WBTC) data from CoinDesk. The emissions increased by more than 160 per cent compared to August, when $232 million was currentized.  WBTC's output grew along with the demand for over-the-counter (OTC) market, reported by Grapefruit Trading. It became one of the first OTC platforms to release WBTC via the BitGo service.  The Grapefruit Trading Trader Getty Hill claims that clients' interest in translating bitcoin into WBTC comes from their desire to use the first cryptation in the decentralized finance ecosystem (DeFi).  CEO's FTX Exchange Sam Bankman-Frid acknowledged that the demand for WBTC at the OTC market remained significant, though not as high as it had been in previous months during the rapid rise o...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>271829</td>\n","      <td>Quiz: Thursday or friday?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>271830</td>\n","      <td>The Australian Revenue Authority will start collecting taxes from crypto transactions this year. The Authority has developed methods to search for and identify cryptovaly investors.  In March 2018, the Australian Revenue Authority announced that the forthcoming identification process would involve AML and bilateral agreements. The data comparison method will also be used to deonymize buyers of crypthalates. Tax agent Liz Russell notes that most users will soon be identified and their debts will be known.  The authorities believe that, because of Bitcoin's recent strong appreciation to $200,000, investors could have earned profits that were not recorded in their tax obligations. If users have suffered losses, these amounts can be deducted from taxable profits.  The Authority recalls tha...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>271831</td>\n","      <td>Let's continue😉. I present to you my new review</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>271832</td>\n","      <td>Here comes your future palette.</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c346f2a3-bb53-4434-a023-1092306f69ef')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c346f2a3-bb53-4434-a023-1092306f69ef button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c346f2a3-bb53-4434-a023-1092306f69ef');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["df[df.category == 2].sample(30)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"VmRCZeYt6X8R","executionInfo":{"status":"ok","timestamp":1666211132627,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"20da1ade-1aec-4124-943f-ede0d22b22eb"},"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          message  category\n","3251  275079                                  Well, my mid-income bunnies, tonight the Fairy Katenka will tell you where to paint his head and where to make a manic quickly and cheaply. (Dasha, close your eyes, don't read!) I'm just saying, this isn't a red-handed post.   One: head! As we know, God gave us the head to paint our mouths and make selfies, but there's still hair to dye and comb. Three of my colleagues went to the Beauty Towns in Bauman's to Umida and praised her very much. I got to a girl named Sabina, and I didn't regret it, because for 3,000 I was toneed into cold blonds and made the roots dark and cold as I had to. It took me about two hours late. I'm happy. For 3,000 in Moscow, you might get a bang cut somewhere.   Two: nails! Manic is great! I always go to Dashka, who's in Instagram.          2\n","3269  275097                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     If you had any questions about the tissue masks, we've figured it out. No further questions.         2\n","3673  275501                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   We're going to open one chakra and present you with a pilot issue of the post.         2\n","3257  275085  And we're gonna start with what we're gonna have to run away from -- Becca primer for a awful ton of money!!!! 3 kosels for full and 1,590 for Travelse (from Old-Russian: checker). Instagram, I think everyone said it was the best primer of their lives (they probably didn't go to a girlfriend), so I bought it.  I'm about to quote on a website that makes me laugh and wants to advise the store to hire a normal copier, but for what I've bought, I'm selling it, the scream: Lighting primer instantly improves the tone of the skin, hides imperfections, little wrinkles and signs of fatigue, and creates a fresh, relaxing view. (Written view only gives me vacation, pay, and New Year's holidays with moisturizers in Olivier) Dummy, dehydrated, and tired skin becomes moist, glowing, and filled with ...         2\n","2953  274781                                                                                           If anything could be removed at the legislative level, I would choose November and February. Completely pissing off unnecessary months, November - all dying, February - all died like your nerve cells in 2020. The only thing that saves me this month is handra, anxiety, chtoni and sraco-hobia -- beautiful stuff (homey, because I've been couched mold since March), tasty food, dumb TV shows, and something very familiar with ATMOSPHER, like vintage pubs in 2008. So today I'm gonna make a set of flavoured candles for the house that (a) really smell, not just promise (b) do it, budget (who wants to tell me that the knob isn't a budget, goes to the joman's website and admires the 7K candles).  Opens our top.          2\n","3466  275294                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            She told me a little bit about her attitude towards makeup and bad practice.  Pride says most of the girls in the interview don't treat makeup as a means to please someone, but as a way of expressing themselves.           2\n","640   272468  It's never happened, and again, the sensation! I've been caught in the ads of Sobian Moscow by my bright-eyed follies in the face of a couple of people! All I can say is, don't go in the woods, because love from the fountain's commercials can't tell the difference. About how people keep trying to get into someone else's wallet on the Internet, we'll talk about it separately, and I've got a carousel with auto-tans. I'm a tough man, and I want to go back to 2007 like this, and the napkin marks are still fresh on my feet. Today I have a refreshing (!) gel for sublime bronze auto-tan from the same line as napkins.  In short, if napkins are a violent teenager, they are their older brother, who is calm and mad.  It's smooth, it's very nice, it's very cool or it's refreshing. I didn't notice,...         2\n","2703  274531                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Abort, girls, don't take         2\n","424   272252                                                                                                                                                                                                                                                                                                                                                                                                                                   Hey! It's New Year's Eve coming up, which means it's time to start promising to lose weight from January, buy a ticket to the gym, and that's it. I can't do such miracles for you, I don't go to my gym, but it's easy to help fight for clean and beautiful skin.  So in the gap between the approaches to the Olivier's Olivia, you're gonna be contesting.   Together with an online shop          2\n","2208  274036                                                                                                                                                                                                                                                                       The budget beauty queen eats a fo bo soup and is ready to give gifts. We've sorted out your hair, everyone has Nastya's contacts, now the bags. I moved on to my lap bags a long time ago because I don't carry a laptop, a can of beans and 33 pompoons. Ira's girlfriend stitched them up, and first of all, you can choose the color, the size and the lining, and second of all, she makes the cutest embroidery on the ground. I'm a lucky unicorn, pizza and cactus man! There's a phone, keys, powder, passport, lip gloss, and a bottle of wine.           2\n","1024  272852                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         I really want to get you something. Something fashionable and self-tested.  Let's have two sets of three of the colorist's cubes.  Just write me a name.         2\n","3532  275360       Back to decorative business like a circus poodle. If you think there's nail polish on the left, you think the Moscows are born with a shell. It's blushing. Yes, liquid lumber in the shape of nail polish!!!!! Genius? Yes.  It's like a lacquer, too.  In fact, the liquid lumbers are clearly designed by God to give us, crooked-mindedly, all the chances of success: they are very easy to smash when they pass, they look better than evil sisters' beets in Russian fairy tales.  The boots are good. We should get them. It's also desirable to paint yourself in an electric car so that everyone can turn their heads when you start rubbing nail polish on their cheeks. I put more on my hand so I could see the maximum shade in the FRIDAY. You need two times less on the cheek. Well, me. You don't know.         2\n","2528  274356                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Even water is more expert than you are at anything.         2\n","653   272481                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              In Moscow, this morning is as gray as your Sundays and dark as prospects for the future! My alter ego Vadik is on air, so it's not a good day. I can't see the world's imperfections, I closed my eyes, turned on my paperwork, and I went to work.   Exactly a month I've been testing a box from          2\n","39    271867  I'm sure I'm not the only one here who likes to get a good cry out of running out of milk in the fridge, from the in vainness of being, the realization that this morning at work, and the fact that adult life isn't great, 16 was much cooler.  I love it. But then you get up in the morning with a face the size of a house, and it looks like you guys from ufc went pretty good in your eyes.  You can save yourself with suicide or patches, the other one is preferable, because suddenly you have a mortgage that no one else will pay.  Patchi is expensive: the gold will be put there, the snail will be wrapped, and the effects will be the same cups, only the view on the other side. That's the way it is!  Run to the organ shop for the Dashman patches!  Plus: - cheap - size on half a face - glued to ...         2\n","2213  274041                                                                                                                                                                                                                                                                                                                                     That I'm all about the bad stuff and the competitions. For example, Lollipop lip balm from lush. And he's awful awesome. There's a awful mountain of balsams of different colors and masks, and I've tried almost everything. The best ones are Lollipop and Lip Service, the rest is money for wind and flavour. It's better to buy a carmex or a Mac lunch for these moneys.  The balsam skull in the canal is because in the spring, avitaminosis rips me like a cat or a domestic twerp.         2\n","1300  273128                                                                                                                                                                                                                                                                                                                               If I could become an ambassador of one thing, I'd choose between the shade of asphyxia urban decay and the pancake \"marine rich man\" from the teremka for a long time. Both want to fall and enjoy life.  There's a shade in the shadows, pencils, lipstick, and probably some lip gloss, but my advice to you is to take the shadows one day: in them you can climb your eyes, cheekbones, cheekbones, or just smash your face out, or just add the form of the scenery element (lat. Ebanutosti)         2\n","3407  275235                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Who's this kid to have someone listen to his opinion about things? Another set that will provide a fart thrust that will be able to get you to the market in Sevastopol so that you can buy a lot of rubber springs.         2\n","1437  273265  Monday's morning is the best time to give in to debauchery thoughts, so there's a poor man's messenger on the air again.  Remember last night I promised to tell you about the budgetary analogy of the Stick Glog? And I remember.  1. To me, it's like a bounty wing, considering I'm painting my face two or three times with a decorative.  2. I DON'T WANT the creators to \"why didn't I ever order anything for the ali express\" I mean, I've been going through all the stages: denial, bidding, and \"not living rich, not starting,\" and the other day I found it in nyx. BUDGET ANALOGUE. The baby hides in the category of metalized shadows, by the way, the shades there are all just adorable, the right one called Frostbite.  The baby's desperate to get away from her fans, but it wasn't right, so I took ...         2\n","1854  273682                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           The guys from Natura Syberica are really cool. I wrote a post about a washroom that everyone canonized and I didn't have a foam, they wrote, assumed that marriage and sent a new one. I never doubted they were cool.         2\n","146   271974                                                                                                                                                                                                                                                                                                                                                                                                                                                             By the way, for several years, she's been taking beautiful red-colored browns with a shimmer (the shade between a gentle salmon and the feeling that she was rubbing on a brick) for some funny money like 149. It was the best blush of my life, but what do you think happened? Sleep out of production, like everyone else adorable.  There's nothing good there.         2\n","1115  272943                                                                                                                                                                                                                                                                                                                                                                      One of the few copyright channels I've found and read lately. All copier-like) - - Yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah.          2\n","569   272397                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Orangerea, cedar oil squeezing and scrubbing. (I've eaten a crucifix, it's blinded, butter and sugar)         2\n","3353  275181                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              I swear to myself I'll take PATCHA and THANKS with me next time! It's just genius.  I leave it, dear diary, it's like a note here, or it's gonna blow out of the hole's head again.         2\n","502   272330                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    That's where the marshmallow coach came from. Don't thank me.         2\n","1316  273144                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 In the meantime, it's my friend Natasha's anger.         2\n","1994  273822                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              And now the promised ways to style the crop top, 💯0 and 1 piece:  📌         2\n","3667  275495  A wise man said that the main thing in Russia is to have a good chunk. Not in the eyebrow, in the eye. But in addition to the puff of every self-respecting post-Councilian, there must be a nice coat that hangs in the back of a rack all year and wears it on special occasions or in the days of the pasturous minor.  And here's your coat. And now that the posture's up, you're the dressiest one on the bus, the mood of the sponge, the coat enters the subway car in front of you. During these days, a playlist is formed under a coat made of Stas Costuschina and the Commissioner's team. Days like this, you're one step closer to a 40-year-old accountant who came back in winter night from a corporativian looking in the kitchen far away with a cognac shot in one hand with a spoon of fat olive in th...         2\n","197   272025                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Birthday's over, and there's no gift. Estée, Tom, ♪ ♪ ♪ ♪ ♪ ♪ Estee, Tom, Tom ♪         2\n","2048  273876                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Be advised: Wash more often         2"],"text/html":["\n","  <div id=\"df-330532a0-1e50-410f-9d42-fa40bd1126cf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3251</th>\n","      <td>275079</td>\n","      <td>Well, my mid-income bunnies, tonight the Fairy Katenka will tell you where to paint his head and where to make a manic quickly and cheaply. (Dasha, close your eyes, don't read!) I'm just saying, this isn't a red-handed post.   One: head! As we know, God gave us the head to paint our mouths and make selfies, but there's still hair to dye and comb. Three of my colleagues went to the Beauty Towns in Bauman's to Umida and praised her very much. I got to a girl named Sabina, and I didn't regret it, because for 3,000 I was toneed into cold blonds and made the roots dark and cold as I had to. It took me about two hours late. I'm happy. For 3,000 in Moscow, you might get a bang cut somewhere.   Two: nails! Manic is great! I always go to Dashka, who's in Instagram.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3269</th>\n","      <td>275097</td>\n","      <td>If you had any questions about the tissue masks, we've figured it out. No further questions.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3673</th>\n","      <td>275501</td>\n","      <td>We're going to open one chakra and present you with a pilot issue of the post.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3257</th>\n","      <td>275085</td>\n","      <td>And we're gonna start with what we're gonna have to run away from -- Becca primer for a awful ton of money!!!! 3 kosels for full and 1,590 for Travelse (from Old-Russian: checker). Instagram, I think everyone said it was the best primer of their lives (they probably didn't go to a girlfriend), so I bought it.  I'm about to quote on a website that makes me laugh and wants to advise the store to hire a normal copier, but for what I've bought, I'm selling it, the scream: Lighting primer instantly improves the tone of the skin, hides imperfections, little wrinkles and signs of fatigue, and creates a fresh, relaxing view. (Written view only gives me vacation, pay, and New Year's holidays with moisturizers in Olivier) Dummy, dehydrated, and tired skin becomes moist, glowing, and filled with ...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2953</th>\n","      <td>274781</td>\n","      <td>If anything could be removed at the legislative level, I would choose November and February. Completely pissing off unnecessary months, November - all dying, February - all died like your nerve cells in 2020. The only thing that saves me this month is handra, anxiety, chtoni and sraco-hobia -- beautiful stuff (homey, because I've been couched mold since March), tasty food, dumb TV shows, and something very familiar with ATMOSPHER, like vintage pubs in 2008. So today I'm gonna make a set of flavoured candles for the house that (a) really smell, not just promise (b) do it, budget (who wants to tell me that the knob isn't a budget, goes to the joman's website and admires the 7K candles).  Opens our top.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3466</th>\n","      <td>275294</td>\n","      <td>She told me a little bit about her attitude towards makeup and bad practice.  Pride says most of the girls in the interview don't treat makeup as a means to please someone, but as a way of expressing themselves.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>640</th>\n","      <td>272468</td>\n","      <td>It's never happened, and again, the sensation! I've been caught in the ads of Sobian Moscow by my bright-eyed follies in the face of a couple of people! All I can say is, don't go in the woods, because love from the fountain's commercials can't tell the difference. About how people keep trying to get into someone else's wallet on the Internet, we'll talk about it separately, and I've got a carousel with auto-tans. I'm a tough man, and I want to go back to 2007 like this, and the napkin marks are still fresh on my feet. Today I have a refreshing (!) gel for sublime bronze auto-tan from the same line as napkins.  In short, if napkins are a violent teenager, they are their older brother, who is calm and mad.  It's smooth, it's very nice, it's very cool or it's refreshing. I didn't notice,...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2703</th>\n","      <td>274531</td>\n","      <td>Abort, girls, don't take</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>424</th>\n","      <td>272252</td>\n","      <td>Hey! It's New Year's Eve coming up, which means it's time to start promising to lose weight from January, buy a ticket to the gym, and that's it. I can't do such miracles for you, I don't go to my gym, but it's easy to help fight for clean and beautiful skin.  So in the gap between the approaches to the Olivier's Olivia, you're gonna be contesting.   Together with an online shop</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2208</th>\n","      <td>274036</td>\n","      <td>The budget beauty queen eats a fo bo soup and is ready to give gifts. We've sorted out your hair, everyone has Nastya's contacts, now the bags. I moved on to my lap bags a long time ago because I don't carry a laptop, a can of beans and 33 pompoons. Ira's girlfriend stitched them up, and first of all, you can choose the color, the size and the lining, and second of all, she makes the cutest embroidery on the ground. I'm a lucky unicorn, pizza and cactus man! There's a phone, keys, powder, passport, lip gloss, and a bottle of wine.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1024</th>\n","      <td>272852</td>\n","      <td>I really want to get you something. Something fashionable and self-tested.  Let's have two sets of three of the colorist's cubes.  Just write me a name.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3532</th>\n","      <td>275360</td>\n","      <td>Back to decorative business like a circus poodle. If you think there's nail polish on the left, you think the Moscows are born with a shell. It's blushing. Yes, liquid lumber in the shape of nail polish!!!!! Genius? Yes.  It's like a lacquer, too.  In fact, the liquid lumbers are clearly designed by God to give us, crooked-mindedly, all the chances of success: they are very easy to smash when they pass, they look better than evil sisters' beets in Russian fairy tales.  The boots are good. We should get them. It's also desirable to paint yourself in an electric car so that everyone can turn their heads when you start rubbing nail polish on their cheeks. I put more on my hand so I could see the maximum shade in the FRIDAY. You need two times less on the cheek. Well, me. You don't know.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2528</th>\n","      <td>274356</td>\n","      <td>Even water is more expert than you are at anything.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>653</th>\n","      <td>272481</td>\n","      <td>In Moscow, this morning is as gray as your Sundays and dark as prospects for the future! My alter ego Vadik is on air, so it's not a good day. I can't see the world's imperfections, I closed my eyes, turned on my paperwork, and I went to work.   Exactly a month I've been testing a box from</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>271867</td>\n","      <td>I'm sure I'm not the only one here who likes to get a good cry out of running out of milk in the fridge, from the in vainness of being, the realization that this morning at work, and the fact that adult life isn't great, 16 was much cooler.  I love it. But then you get up in the morning with a face the size of a house, and it looks like you guys from ufc went pretty good in your eyes.  You can save yourself with suicide or patches, the other one is preferable, because suddenly you have a mortgage that no one else will pay.  Patchi is expensive: the gold will be put there, the snail will be wrapped, and the effects will be the same cups, only the view on the other side. That's the way it is!  Run to the organ shop for the Dashman patches!  Plus: - cheap - size on half a face - glued to ...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2213</th>\n","      <td>274041</td>\n","      <td>That I'm all about the bad stuff and the competitions. For example, Lollipop lip balm from lush. And he's awful awesome. There's a awful mountain of balsams of different colors and masks, and I've tried almost everything. The best ones are Lollipop and Lip Service, the rest is money for wind and flavour. It's better to buy a carmex or a Mac lunch for these moneys.  The balsam skull in the canal is because in the spring, avitaminosis rips me like a cat or a domestic twerp.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1300</th>\n","      <td>273128</td>\n","      <td>If I could become an ambassador of one thing, I'd choose between the shade of asphyxia urban decay and the pancake \"marine rich man\" from the teremka for a long time. Both want to fall and enjoy life.  There's a shade in the shadows, pencils, lipstick, and probably some lip gloss, but my advice to you is to take the shadows one day: in them you can climb your eyes, cheekbones, cheekbones, or just smash your face out, or just add the form of the scenery element (lat. Ebanutosti)</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3407</th>\n","      <td>275235</td>\n","      <td>Who's this kid to have someone listen to his opinion about things? Another set that will provide a fart thrust that will be able to get you to the market in Sevastopol so that you can buy a lot of rubber springs.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1437</th>\n","      <td>273265</td>\n","      <td>Monday's morning is the best time to give in to debauchery thoughts, so there's a poor man's messenger on the air again.  Remember last night I promised to tell you about the budgetary analogy of the Stick Glog? And I remember.  1. To me, it's like a bounty wing, considering I'm painting my face two or three times with a decorative.  2. I DON'T WANT the creators to \"why didn't I ever order anything for the ali express\" I mean, I've been going through all the stages: denial, bidding, and \"not living rich, not starting,\" and the other day I found it in nyx. BUDGET ANALOGUE. The baby hides in the category of metalized shadows, by the way, the shades there are all just adorable, the right one called Frostbite.  The baby's desperate to get away from her fans, but it wasn't right, so I took ...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1854</th>\n","      <td>273682</td>\n","      <td>The guys from Natura Syberica are really cool. I wrote a post about a washroom that everyone canonized and I didn't have a foam, they wrote, assumed that marriage and sent a new one. I never doubted they were cool.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>146</th>\n","      <td>271974</td>\n","      <td>By the way, for several years, she's been taking beautiful red-colored browns with a shimmer (the shade between a gentle salmon and the feeling that she was rubbing on a brick) for some funny money like 149. It was the best blush of my life, but what do you think happened? Sleep out of production, like everyone else adorable.  There's nothing good there.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1115</th>\n","      <td>272943</td>\n","      <td>One of the few copyright channels I've found and read lately. All copier-like) - - Yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah, yeah.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>569</th>\n","      <td>272397</td>\n","      <td>Orangerea, cedar oil squeezing and scrubbing. (I've eaten a crucifix, it's blinded, butter and sugar)</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3353</th>\n","      <td>275181</td>\n","      <td>I swear to myself I'll take PATCHA and THANKS with me next time! It's just genius.  I leave it, dear diary, it's like a note here, or it's gonna blow out of the hole's head again.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>502</th>\n","      <td>272330</td>\n","      <td>That's where the marshmallow coach came from. Don't thank me.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1316</th>\n","      <td>273144</td>\n","      <td>In the meantime, it's my friend Natasha's anger.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1994</th>\n","      <td>273822</td>\n","      <td>And now the promised ways to style the crop top, 💯0 and 1 piece:  📌</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3667</th>\n","      <td>275495</td>\n","      <td>A wise man said that the main thing in Russia is to have a good chunk. Not in the eyebrow, in the eye. But in addition to the puff of every self-respecting post-Councilian, there must be a nice coat that hangs in the back of a rack all year and wears it on special occasions or in the days of the pasturous minor.  And here's your coat. And now that the posture's up, you're the dressiest one on the bus, the mood of the sponge, the coat enters the subway car in front of you. During these days, a playlist is formed under a coat made of Stas Costuschina and the Commissioner's team. Days like this, you're one step closer to a 40-year-old accountant who came back in winter night from a corporativian looking in the kitchen far away with a cognac shot in one hand with a spoon of fat olive in th...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>197</th>\n","      <td>272025</td>\n","      <td>Birthday's over, and there's no gift. Estée, Tom, ♪ ♪ ♪ ♪ ♪ ♪ Estee, Tom, Tom ♪</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2048</th>\n","      <td>273876</td>\n","      <td>Be advised: Wash more often</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-330532a0-1e50-410f-9d42-fa40bd1126cf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-330532a0-1e50-410f-9d42-fa40bd1126cf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-330532a0-1e50-410f-9d42-fa40bd1126cf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["df.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jpX2-rIIyYlt","executionInfo":{"status":"ok","timestamp":1666210115553,"user_tz":-180,"elapsed":9,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"9dfe93c9-3ea5-41f4-9f36-6d7789d14b2b"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 3844 entries, 0 to 3843\n","Data columns (total 3 columns):\n"," #   Column    Non-Null Count  Dtype \n","---  ------    --------------  ----- \n"," 0   id        3844 non-null   int64 \n"," 1   message   3844 non-null   object\n"," 2   category  3844 non-null   int64 \n","dtypes: int64(2), object(1)\n","memory usage: 120.1+ KB\n"]}]},{"cell_type":"code","source":["# new_data = pd.read_csv('/content/new_data_fashion.csv')"],"metadata":{"id":"VC0yyKGWxRgT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data"],"metadata":{"id":"7LV4zyvxyxDS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data = new_data.rename(columns={\"Unnamed: 0\": \"id\", \"short_description\": \"message\"})"],"metadata":{"id":"-McIzyCdxoz0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# new_data.info()"],"metadata":{"id":"rKq7rGzuya4B"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1Z-wmSWVyTiT","executionInfo":{"status":"ok","timestamp":1666210118404,"user_tz":-180,"elapsed":3,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"542c6de8-97ee-4f69-d729-867bc56c8733"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 3844 entries, 0 to 3843\n","Data columns (total 3 columns):\n"," #   Column    Non-Null Count  Dtype \n","---  ------    --------------  ----- \n"," 0   id        3844 non-null   int64 \n"," 1   message   3844 non-null   object\n"," 2   category  3844 non-null   int64 \n","dtypes: int64(2), object(1)\n","memory usage: 120.1+ KB\n"]}]},{"cell_type":"code","source":["df.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9q-Wjv9nyCCe","executionInfo":{"status":"ok","timestamp":1666210119444,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"8f4450cc-5e7d-466c-8161-3231b697870e"},"execution_count":14,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3844, 3)"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["# len(new_data) + len(df)"],"metadata":{"id":"Dmz2lzuazfBd","executionInfo":{"status":"ok","timestamp":1666210121174,"user_tz":-180,"elapsed":326,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["# df = pd.concat([df, new_data], axis=0)"],"metadata":{"id":"EDhEKyKwxbep","executionInfo":{"status":"ok","timestamp":1666210121175,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":676},"id":"LKDUyKULyG47","executionInfo":{"status":"ok","timestamp":1666210121496,"user_tz":-180,"elapsed":11,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"65c1e64d-f76f-41fe-93ca-8fb5c7f74631"},"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          message  category\n","0     271828  Over $616 million in Bitcoin was electrocated in September with Wrapped Bitcoin (WBTC) data from CoinDesk. The emissions increased by more than 160 per cent compared to August, when $232 million was currentized.  WBTC's output grew along with the demand for over-the-counter (OTC) market, reported by Grapefruit Trading. It became one of the first OTC platforms to release WBTC via the BitGo service.  The Grapefruit Trading Trader Getty Hill claims that clients' interest in translating bitcoin into WBTC comes from their desire to use the first cryptation in the decentralized finance ecosystem (DeFi).  CEO's FTX Exchange Sam Bankman-Frid acknowledged that the demand for WBTC at the OTC market remained significant, though not as high as it had been in previous months during the rapid rise o...         1\n","1     271829                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Quiz: Thursday or friday?         0\n","2     271830  The Australian Revenue Authority will start collecting taxes from crypto transactions this year. The Authority has developed methods to search for and identify cryptovaly investors.  In March 2018, the Australian Revenue Authority announced that the forthcoming identification process would involve AML and bilateral agreements. The data comparison method will also be used to deonymize buyers of crypthalates. Tax agent Liz Russell notes that most users will soon be identified and their debts will be known.  The authorities believe that, because of Bitcoin's recent strong appreciation to $200,000, investors could have earned profits that were not recorded in their tax obligations. If users have suffered losses, these amounts can be deducted from taxable profits.  The Authority recalls tha...         1\n","3     271831                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Let's continue😉. I present to you my new review          2\n","4     271832                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Here comes your future palette.         2\n","...      ...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ...       ...\n","3839  275667  On the air, the shooter's kms and the man who asked about the favourite subpoena were poking his eyeballs with an elgey style, but instead of the Sionar Booooy, he started talking about the saying about the mistress, the borsch, and the pots. Well, you know, the good mistress of the borsche in any pot tastes good.  Anyway, no matter what!!! Publicly, I refuse my words because today I painted the arrows of SHIT!!!!!! It's some kind of hell, I swear. If there's hell, it's where I talk to people all the time and draw the arrows with a brush.  Anyway, it turns out I had a very limited function: I could draw the brand arrows with a pencil, a liquid substrate with a thin brush, and a marker-shaped liner. That's the secret to success.  Why did I get in the wrong place at all? I don't know wha...         2\n","3840  275668                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  This shit that's off-the-books.         0\n","3841  275669                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Time to go to the sky, tabor.         2\n","3842  275670                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       uraaaaaaaa         0\n","3843  275671                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Albert I only drink VODKA         0\n","\n","[3844 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-5ec9997f-c563-4b66-8b11-6b2f67e63cee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>271828</td>\n","      <td>Over $616 million in Bitcoin was electrocated in September with Wrapped Bitcoin (WBTC) data from CoinDesk. The emissions increased by more than 160 per cent compared to August, when $232 million was currentized.  WBTC's output grew along with the demand for over-the-counter (OTC) market, reported by Grapefruit Trading. It became one of the first OTC platforms to release WBTC via the BitGo service.  The Grapefruit Trading Trader Getty Hill claims that clients' interest in translating bitcoin into WBTC comes from their desire to use the first cryptation in the decentralized finance ecosystem (DeFi).  CEO's FTX Exchange Sam Bankman-Frid acknowledged that the demand for WBTC at the OTC market remained significant, though not as high as it had been in previous months during the rapid rise o...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>271829</td>\n","      <td>Quiz: Thursday or friday?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>271830</td>\n","      <td>The Australian Revenue Authority will start collecting taxes from crypto transactions this year. The Authority has developed methods to search for and identify cryptovaly investors.  In March 2018, the Australian Revenue Authority announced that the forthcoming identification process would involve AML and bilateral agreements. The data comparison method will also be used to deonymize buyers of crypthalates. Tax agent Liz Russell notes that most users will soon be identified and their debts will be known.  The authorities believe that, because of Bitcoin's recent strong appreciation to $200,000, investors could have earned profits that were not recorded in their tax obligations. If users have suffered losses, these amounts can be deducted from taxable profits.  The Authority recalls tha...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>271831</td>\n","      <td>Let's continue😉. I present to you my new review</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>271832</td>\n","      <td>Here comes your future palette.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3839</th>\n","      <td>275667</td>\n","      <td>On the air, the shooter's kms and the man who asked about the favourite subpoena were poking his eyeballs with an elgey style, but instead of the Sionar Booooy, he started talking about the saying about the mistress, the borsch, and the pots. Well, you know, the good mistress of the borsche in any pot tastes good.  Anyway, no matter what!!! Publicly, I refuse my words because today I painted the arrows of SHIT!!!!!! It's some kind of hell, I swear. If there's hell, it's where I talk to people all the time and draw the arrows with a brush.  Anyway, it turns out I had a very limited function: I could draw the brand arrows with a pencil, a liquid substrate with a thin brush, and a marker-shaped liner. That's the secret to success.  Why did I get in the wrong place at all? I don't know wha...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3840</th>\n","      <td>275668</td>\n","      <td>This shit that's off-the-books.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3841</th>\n","      <td>275669</td>\n","      <td>Time to go to the sky, tabor.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3842</th>\n","      <td>275670</td>\n","      <td>uraaaaaaaa</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3843</th>\n","      <td>275671</td>\n","      <td>Albert I only drink VODKA</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3844 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5ec9997f-c563-4b66-8b11-6b2f67e63cee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5ec9997f-c563-4b66-8b11-6b2f67e63cee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5ec9997f-c563-4b66-8b11-6b2f67e63cee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["dubki_chat = pd.read_csv('/content/students_dubki_chat.csv')"],"metadata":{"id":"gmOC_uFz0BPM","executionInfo":{"status":"ok","timestamp":1666210137558,"user_tz":-180,"elapsed":409,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["dubki_chat = dubki_chat[['message', 'category']]"],"metadata":{"id":"nO_mr5wi0M6x","executionInfo":{"status":"ok","timestamp":1666210138038,"user_tz":-180,"elapsed":3,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["nlp_chat = pd.read_csv('/content/nlp_chat.csv')\n","nlp_chat = nlp_chat[['message', 'category']]"],"metadata":{"id":"VMV_nVkT127b","executionInfo":{"status":"ok","timestamp":1666210138400,"user_tz":-180,"elapsed":2,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["df = pd.concat([df, dubki_chat, nlp_chat], axis=0)"],"metadata":{"id":"PdOciMu40pyO","executionInfo":{"status":"ok","timestamp":1666210138812,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","source":["df.drop(['id'],axis=1,inplace=True)"],"metadata":{"id":"NR6ohZw208Nw","executionInfo":{"status":"ok","timestamp":1666210139093,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["df.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ggoOsau8VsQQ","executionInfo":{"status":"ok","timestamp":1666210139412,"user_tz":-180,"elapsed":3,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"868f278d-9dd8-4653-c07f-6af174ce8a23"},"execution_count":25,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(14261, 2)"]},"metadata":{},"execution_count":25}]},{"cell_type":"code","source":["df.sample(50)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"EIq_SjSm0yv8","executionInfo":{"status":"ok","timestamp":1666210140437,"user_tz":-180,"elapsed":374,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"b391462e-f520-4b55-f58f-7cbbb3597c8c"},"execution_count":26,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              message  category\n","5887                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     on October 31, I also had to go to Sheremetyevo, and the Aeroexpress suddenly didn’t go there) I had to urgently take a taxi from Belorussky         0\n","2997  If there is a hell, it looks like my weekend: I moved out the whole apartment one night, worked a job (you've all seen a storis with a totally cool party layer, so we made it), slept about four hours, and I'm leaving tomorrow.  My face is now like a gray edgy, painful, sad rock covered in moss, but it's happened to him a little bit. I had a tonic of the tea tree Lush for a long time, but I didn't use it because THE COUNTRY PACKET was a basement.  But when your whole life is in a box, you don't have to choose, and you put it on two nights.  Anyway, on the fat skin, right wow, freshens up, removes the inflammation and, hard to believe, but the color of the face is better, not so thick.  It's hot, but the smell is still unbearable, and it's found a way to write it on a cotton drive, not j...         2\n","8267                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Chicken Schnitzel with Puree!!         0\n","1276                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    who had a car         0\n","3982                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  from Moscow too         0\n","6001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              taxi from odintsovo         0\n","9182                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 my neighbor came         0\n","8906                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              at least if you rely on the old 086         0\n","1123                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Or maybe someone in oak trees weaves beaded jewelry? I really want a ring!         0\n","1076                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Should it be otherwise? HSE Free - speed limited guest network         0\n","5098                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Are you growing, right?         0\n","5146                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                works well for me         0\n","416                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Well, this is a pretrain)) 0)         0\n","2781                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Welcome to the club         0\n","219                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  there is simply no iron answer (         0\n","8486                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           I’ll ask again about the hand mixer, suddenly someone in oak trees has one with him :(         0\n","4507                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1939 in progress         0\n","154   A minute to fly to the phuket because of the fart's pull.  Yesterday, I wrote a post in Instagram about how annoying it is to try to get to know each other and get to know the streets. I've been expecting everything, but not that in the 21st century, women would start writing Sama Vinovatta to you, and you wouldn't give the Mossians permission to do it, and you wouldn't know how much of an instinct you've given them, and you wouldn't be able to control your speech, attitude and gestures.  Whatever you look like, you don't give anyone a chance to evaluate you, grab any places or anything.  None of your fluids, your self-esteem, your appearance, your sociotype, your design of a person and your form of fingernails give anyone the right to behave vilely towards you.  (I hope you don't have...         2\n","850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       And another record: the daily trading volume of Bitcoin futures on the Chicago Mercantile Exchange for the first time crossed the $ 5 billion mark. The interest in cryptocurrency is huge.         1\n","4775                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              By the way, is there a coach there?         0\n","1256                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              I asked about it yesterday. Mike wrote that he's good and he's out.         0\n","4900                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              They are fine there         0\n","3632                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   To write that I'm a bitch, you can always insinuate so that you know the enemy of your paycheck in the face:           2\n","1221                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Over the last month, we have seen          1\n","5695                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    For Kuzminov*         0\n","2086                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Oaks 2k I will exchange brusko coconut dessert for any other liquid 30 ml of any manufacturer I did not like this flavor I used it only once         0\n","3929                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \"Now You Will Work for Me\"         0\n","2188                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          @lllgaleleyev what a familiar voice )))         0\n","1854                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           The guys from Natura Syberica are really cool. I wrote a post about a washroom that everyone canonized and I didn't have a foam, they wrote, assumed that marriage and sent a new one. I never doubted they were cool.         2\n","1147                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    With this, with some manipulations, Windows itself will cope.         0\n","8314                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        But bootex.log doesn't look like a text file to be honest         0\n","5505                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Who can buy cigs 1k?         0\n","9574                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               I did not say that         0\n","6367                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               understood thanks!         0\n","3549                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        The supply of $ ETH on crypto exchanges fell to 19%. This is at least since December 18. Nobody wants to sell their Ethereum stocks now 😎         1\n","2475                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Who doesn't love them...         0\n","5948                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Private room in a family apartment in Dubki         0\n","3304                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               About the Fedbeck, I'm hs, she said send it to the post office, as I recall talking about the 7th.         0\n","6006                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  For negligence of this kind, a prison measure of restraint is not provided, uncle) Maximum fine         0\n","643                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Revolutionary payment terminal         1\n","7610                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              well this is yesterday's screenshot         0\n","3954                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      In the discussion in VK they are thrown out         0\n","5513                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Without a policy, there are no paid clinics that will do it?         0\n","665                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Is it possible to somehow withdraw money from the trio?         0\n","2445                                                                                                                                                                                                                                                                                                                           The CBDC can work on networks such as Ethereum and Diem, complementing two-tier models where central banks distribute currents through intermediaries. An ex-head of the National Digital Currency Department of the People &apos; s Bank of China (NBC), Yao Qan, wrote CryptoNews with reference to local media.  He worked on a digital renminbi from 2014 to 2019. Yao is currently the head of the Scientific and Technical Supervision Division of the China Securities Regulatory Commission.           1\n","2056                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Bonus smells like chocolate. You don't give doctors and teachers, they'll eat in a lot of gifts.         2\n","262                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             fundamental Particle,         0\n","86                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     until September 13, it was necessary to register through public services, choose a site nearby         0\n","5260                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Gotta go to a woman         0\n","2460                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     The men from the war and Wasa got warmed up by the password.         0"],"text/html":["\n","  <div id=\"df-48c7b0c8-f9eb-44de-9010-78a038068c18\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>5887</th>\n","      <td>on October 31, I also had to go to Sheremetyevo, and the Aeroexpress suddenly didn’t go there) I had to urgently take a taxi from Belorussky</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2997</th>\n","      <td>If there is a hell, it looks like my weekend: I moved out the whole apartment one night, worked a job (you've all seen a storis with a totally cool party layer, so we made it), slept about four hours, and I'm leaving tomorrow.  My face is now like a gray edgy, painful, sad rock covered in moss, but it's happened to him a little bit. I had a tonic of the tea tree Lush for a long time, but I didn't use it because THE COUNTRY PACKET was a basement.  But when your whole life is in a box, you don't have to choose, and you put it on two nights.  Anyway, on the fat skin, right wow, freshens up, removes the inflammation and, hard to believe, but the color of the face is better, not so thick.  It's hot, but the smell is still unbearable, and it's found a way to write it on a cotton drive, not j...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>8267</th>\n","      <td>Chicken Schnitzel with Puree!!</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1276</th>\n","      <td>who had a car</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3982</th>\n","      <td>from Moscow too</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>6001</th>\n","      <td>taxi from odintsovo</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9182</th>\n","      <td>my neighbor came</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>8906</th>\n","      <td>at least if you rely on the old 086</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1123</th>\n","      <td>Or maybe someone in oak trees weaves beaded jewelry? I really want a ring!</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1076</th>\n","      <td>Should it be otherwise? HSE Free - speed limited guest network</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5098</th>\n","      <td>Are you growing, right?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5146</th>\n","      <td>works well for me</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>416</th>\n","      <td>Well, this is a pretrain)) 0)</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2781</th>\n","      <td>Welcome to the club</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>219</th>\n","      <td>there is simply no iron answer (</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>8486</th>\n","      <td>I’ll ask again about the hand mixer, suddenly someone in oak trees has one with him :(</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4507</th>\n","      <td>1939 in progress</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>154</th>\n","      <td>A minute to fly to the phuket because of the fart's pull.  Yesterday, I wrote a post in Instagram about how annoying it is to try to get to know each other and get to know the streets. I've been expecting everything, but not that in the 21st century, women would start writing Sama Vinovatta to you, and you wouldn't give the Mossians permission to do it, and you wouldn't know how much of an instinct you've given them, and you wouldn't be able to control your speech, attitude and gestures.  Whatever you look like, you don't give anyone a chance to evaluate you, grab any places or anything.  None of your fluids, your self-esteem, your appearance, your sociotype, your design of a person and your form of fingernails give anyone the right to behave vilely towards you.  (I hope you don't have...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>850</th>\n","      <td>And another record: the daily trading volume of Bitcoin futures on the Chicago Mercantile Exchange for the first time crossed the $ 5 billion mark. The interest in cryptocurrency is huge.</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4775</th>\n","      <td>By the way, is there a coach there?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1256</th>\n","      <td>I asked about it yesterday. Mike wrote that he's good and he's out.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4900</th>\n","      <td>They are fine there</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3632</th>\n","      <td>To write that I'm a bitch, you can always insinuate so that you know the enemy of your paycheck in the face:</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1221</th>\n","      <td>Over the last month, we have seen</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>5695</th>\n","      <td>For Kuzminov*</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2086</th>\n","      <td>Oaks 2k I will exchange brusko coconut dessert for any other liquid 30 ml of any manufacturer I did not like this flavor I used it only once</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3929</th>\n","      <td>\"Now You Will Work for Me\"</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2188</th>\n","      <td>@lllgaleleyev what a familiar voice )))</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1854</th>\n","      <td>The guys from Natura Syberica are really cool. I wrote a post about a washroom that everyone canonized and I didn't have a foam, they wrote, assumed that marriage and sent a new one. I never doubted they were cool.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1147</th>\n","      <td>With this, with some manipulations, Windows itself will cope.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>8314</th>\n","      <td>But bootex.log doesn't look like a text file to be honest</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5505</th>\n","      <td>Who can buy cigs 1k?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9574</th>\n","      <td>I did not say that</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>6367</th>\n","      <td>understood thanks!</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3549</th>\n","      <td>The supply of $ ETH on crypto exchanges fell to 19%. This is at least since December 18. Nobody wants to sell their Ethereum stocks now 😎</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2475</th>\n","      <td>Who doesn't love them...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5948</th>\n","      <td>Private room in a family apartment in Dubki</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3304</th>\n","      <td>About the Fedbeck, I'm hs, she said send it to the post office, as I recall talking about the 7th.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>6006</th>\n","      <td>For negligence of this kind, a prison measure of restraint is not provided, uncle) Maximum fine</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>643</th>\n","      <td>Revolutionary payment terminal</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>7610</th>\n","      <td>well this is yesterday's screenshot</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3954</th>\n","      <td>In the discussion in VK they are thrown out</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5513</th>\n","      <td>Without a policy, there are no paid clinics that will do it?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>665</th>\n","      <td>Is it possible to somehow withdraw money from the trio?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2445</th>\n","      <td>The CBDC can work on networks such as Ethereum and Diem, complementing two-tier models where central banks distribute currents through intermediaries. An ex-head of the National Digital Currency Department of the People &amp;apos; s Bank of China (NBC), Yao Qan, wrote CryptoNews with reference to local media.  He worked on a digital renminbi from 2014 to 2019. Yao is currently the head of the Scientific and Technical Supervision Division of the China Securities Regulatory Commission.</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2056</th>\n","      <td>Bonus smells like chocolate. You don't give doctors and teachers, they'll eat in a lot of gifts.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>262</th>\n","      <td>fundamental Particle,</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>86</th>\n","      <td>until September 13, it was necessary to register through public services, choose a site nearby</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5260</th>\n","      <td>Gotta go to a woman</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2460</th>\n","      <td>The men from the war and Wasa got warmed up by the password.</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-48c7b0c8-f9eb-44de-9010-78a038068c18')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-48c7b0c8-f9eb-44de-9010-78a038068c18 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-48c7b0c8-f9eb-44de-9010-78a038068c18');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":26}]},{"cell_type":"code","source":["df.category.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MatUUBCm3Wsx","executionInfo":{"status":"ok","timestamp":1666210180271,"user_tz":-180,"elapsed":347,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"81592639-385a-417f-8d41-4dccdb9db417"},"execution_count":29,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    11845\n","2     1217\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","source":["df = df[df['category'] != 1]"],"metadata":{"id":"HhjvTz-5Q3lt","executionInfo":{"status":"ok","timestamp":1666210181718,"user_tz":-180,"elapsed":5,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["df = df.dropna()"],"metadata":{"id":"cA3Z5brcRPFX","executionInfo":{"status":"ok","timestamp":1666210183340,"user_tz":-180,"elapsed":2,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["df.info()"],"metadata":{"id":"j0lfxIdj9WPw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666210183730,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"6f2c02a6-d38c-4870-d81e-8d6afbf485ba"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 13062 entries, 1 to 416\n","Data columns (total 2 columns):\n"," #   Column    Non-Null Count  Dtype \n","---  ------    --------------  ----- \n"," 0   message   13062 non-null  object\n"," 1   category  13062 non-null  int64 \n","dtypes: int64(1), object(1)\n","memory usage: 306.1+ KB\n"]}]},{"cell_type":"code","source":["df.isnull().sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pfisiY-tRFoi","executionInfo":{"status":"ok","timestamp":1666210186003,"user_tz":-180,"elapsed":312,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"a546b040-7fb7-4058-f98a-e7f03365e9d3"},"execution_count":33,"outputs":[{"output_type":"execute_result","data":{"text/plain":["message     0\n","category    0\n","dtype: int64"]},"metadata":{},"execution_count":33}]},{"cell_type":"code","source":["!pip install -q pymorphy2"],"metadata":{"id":"xk0_zD4bGalv","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666210194195,"user_tz":-180,"elapsed":6858,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"f3b3b23e-3d15-4751-f01a-22c693e48695"},"execution_count":34,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[K     |████████████████████████████████| 55 kB 2.2 MB/s \n","\u001b[K     |████████████████████████████████| 8.2 MB 8.0 MB/s \n","\u001b[?25h  Building wheel for docopt (setup.py) ... \u001b[?25l\u001b[?25hdone\n"]}]},{"cell_type":"code","source":["import pymorphy2\n","from functools import lru_cache\n","from multiprocessing import Pool\n","import numpy as np\n","from sklearn.model_selection import train_test_split\n","from tqdm import tqdm_notebook as tqdm\n","import re"],"metadata":{"id":"Wpdyc4hkGa-i","executionInfo":{"status":"ok","timestamp":1666210232445,"user_tz":-180,"elapsed":2,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"U-ih1CELHeaA","executionInfo":{"status":"ok","timestamp":1666210232797,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["m = pymorphy2.MorphAnalyzer()\n","\n","regex = re.compile(\"[А-Яа-я:=!\\)\\()A-z\\_\\%/|]+\")\n","\n","def words_only(text, regex=regex):\n","    try:\n","        return regex.findall(text)\n","    except:\n","        return []\n","\n","def tweeter_only(text, regex=regex):\n","    try:\n","        return tknzr.tokenize(text)\n","    except:\n","        return []\n","def lemmatize(text, pymorphy=m):\n","    try:\n","        return \" \".join([pymorphy.parse(w)[0].normal_form for w in text])\n","    except:\n","        return \" \"    \n","def clean_text(text):\n","    text = re.sub(r'https?://\\S+', ' url ', text)\n","    return lemmatize(words_only(text))"],"metadata":{"id":"t7RBvm-wrc9x","executionInfo":{"status":"ok","timestamp":1666210720243,"user_tz":-180,"elapsed":298,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":62,"outputs":[]},{"cell_type":"code","source":["clean_text('sdsaf https://music.yandex.ru/home dsfsd sdf sdf')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"ShFB8QB83mBt","executionInfo":{"status":"ok","timestamp":1666210720245,"user_tz":-180,"elapsed":18,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"0464e08e-d172-4992-cb50-69c251c4f574"},"execution_count":63,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'sdsaf url dsfsd sdf sdf'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":63}]},{"cell_type":"markdown","source":["### TFIDF"],"metadata":{"id":"Q2S9JcIe9mDk"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","X_train, X_test = train_test_split(df , test_size=0.25, random_state=42, shuffle=True)"],"metadata":{"id":"9f-wU8Qf9pSJ","executionInfo":{"status":"ok","timestamp":1666210500683,"user_tz":-180,"elapsed":335,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":54,"outputs":[]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, X_train['message']), total=len(X_train)))\n","\n","X_train['lemmas'] = lemmas\n","X_train.sample(10)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":528,"referenced_widgets":["b8d69ecc085145daad6d7c892401145b","e7708648946d4f89b153140a1ff008f4","721663bcaedf467f95d662b5aa819c26","ba000201731a42df89c981d96e1caa13","f838515cc12d4a60a29dabe0bdbbbcfd","8046e06a0ca644fbb3c0964aabd07cfe","7144aeb664b94b09bd70f40924dbe55f","4c76405cdf074245b3e6c64239fa3c2f","76fe68a0e8ce4a48804f3dc94a83b607","f2769269d2bf470ba11edfac36db6f78","df045cb62a4145868f8d5f4bfedd255b"]},"id":"ztC6UbkY9t_3","executionInfo":{"status":"ok","timestamp":1666210507186,"user_tz":-180,"elapsed":5174,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"699dfdfb-6664-40b1-a4a3-9460dbb51ff9"},"execution_count":55,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/9796 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b8d69ecc085145daad6d7c892401145b"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["                                                                                                                           message  category                                                                                                                       lemmas\n","1596                         Like a person It's very ugly to write such things in a chat It's possible to formulate it differently         0                        like a person it s very ugly to write such things in a chat it s possible to formulate it differently\n","1101                                                                                                           So we're canceling.         0                                                                                                           so we re canceling\n","975                                                                                                          bake me something plz         0                                                                                                        bake me something plz\n","1834                                                                                                      For rapid communications         0                                                                                                     for rapid communications\n","9865                                                                                                        And what are they for?         0                                                                                                        and what are they for\n","3301                                   They are increasingly trying to bring it to mathematics, but this is a desire for infinity)         0                                   they are increasingly trying to bring it to mathematics but this is a desire for infinity)\n","5034  guys!! question of the century: during quarantine they can let in people who do not live in a hostel, but study at the tower         0  guys!! question of the century: during quarantine they can let in people who do not live in a hostel but study at the tower\n","2398                                                                                                               still relevant?         0                                                                                                               still relevant\n","5371                                                                                                     wait for me dubki edition         0                                                                                                    wait for me dubki edition\n","2249                                       How much time do you spend on thesis for real, and how much do you write in the report?         0                                        how much time do you spend on thesis for real and how much do you write in the report"],"text/html":["\n","  <div id=\"df-724d0722-156f-431a-8050-b1de915b01ee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1596</th>\n","      <td>Like a person It's very ugly to write such things in a chat It's possible to formulate it differently</td>\n","      <td>0</td>\n","      <td>like a person it s very ugly to write such things in a chat it s possible to formulate it differently</td>\n","    </tr>\n","    <tr>\n","      <th>1101</th>\n","      <td>So we're canceling.</td>\n","      <td>0</td>\n","      <td>so we re canceling</td>\n","    </tr>\n","    <tr>\n","      <th>975</th>\n","      <td>bake me something plz</td>\n","      <td>0</td>\n","      <td>bake me something plz</td>\n","    </tr>\n","    <tr>\n","      <th>1834</th>\n","      <td>For rapid communications</td>\n","      <td>0</td>\n","      <td>for rapid communications</td>\n","    </tr>\n","    <tr>\n","      <th>9865</th>\n","      <td>And what are they for?</td>\n","      <td>0</td>\n","      <td>and what are they for</td>\n","    </tr>\n","    <tr>\n","      <th>3301</th>\n","      <td>They are increasingly trying to bring it to mathematics, but this is a desire for infinity)</td>\n","      <td>0</td>\n","      <td>they are increasingly trying to bring it to mathematics but this is a desire for infinity)</td>\n","    </tr>\n","    <tr>\n","      <th>5034</th>\n","      <td>guys!! question of the century: during quarantine they can let in people who do not live in a hostel, but study at the tower</td>\n","      <td>0</td>\n","      <td>guys!! question of the century: during quarantine they can let in people who do not live in a hostel but study at the tower</td>\n","    </tr>\n","    <tr>\n","      <th>2398</th>\n","      <td>still relevant?</td>\n","      <td>0</td>\n","      <td>still relevant</td>\n","    </tr>\n","    <tr>\n","      <th>5371</th>\n","      <td>wait for me dubki edition</td>\n","      <td>0</td>\n","      <td>wait for me dubki edition</td>\n","    </tr>\n","    <tr>\n","      <th>2249</th>\n","      <td>How much time do you spend on thesis for real, and how much do you write in the report?</td>\n","      <td>0</td>\n","      <td>how much time do you spend on thesis for real and how much do you write in the report</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-724d0722-156f-431a-8050-b1de915b01ee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-724d0722-156f-431a-8050-b1de915b01ee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-724d0722-156f-431a-8050-b1de915b01ee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":55}]},{"cell_type":"code","source":["df[df.category == 2].sample(20)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"CNGZHHtP5pKd","executionInfo":{"status":"ok","timestamp":1666210792750,"user_tz":-180,"elapsed":18,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"6b935e71-3c8c-43b0-e667-826c1d1ec913"},"execution_count":66,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              message  category\n","3491  There were a lot of questions about retinol after the leather posts, and what they eat with. So, by pretending to be an accountant from a free window, I'm gonna try to land what it is, what it's for, and whether you really need it.  In short, retinol is one of the forms of vitamin A that has been super popular in cosmetics in recent years. It's proven how cool he is with pimples and wrinkles (and both of you together if you're in the same wonderful category of people as me, who still have pimples but already wrinkles). But I know it's a little hard to step up and get through it.  First of all, retinol is your bro because it regulates cell renewal -- there's every chance that skin will be less like the old paper that was left on the bench in September. The same function helps to remove ...         2\n","2628  If there were any comments and FIDBEC, I'd start by asking you, \"How do you choose a bank where you keep your gold?\" I've got a dumb cliché: there's a creepyly uncomfortable pay card with a crippled Rosbank app, there's a mortgage and a lame pickup and a Rocketbank that started a couple of years ago on the advice of friends. To be honest, more than I use, I hear, or I'm trying to fix the app bugs. I mean, in general, I've come to accept that there's nothing in everything, but the girlfriends are upsetting Tinkoff. It's impossible to resist. But this isn't about girlfriends, it's about the pink card with this map that was released in conjunction with Masha Wei, and I'm pretty cold to her, but who cares when it's on the map? ON THE BLOOD BACK. And there's a thousand of them!  This doesn'...         2\n","191                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            If you don't read my bed-advises, you're always gonna walk around with girls, no one's gonna take you.         2\n","1808                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Every time I read any message on this channel, I want to cry with my knees around. What kind of life is this?         2\n","1415                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       We've got a social media manager job at the isobar.  If you're okay, study the vacancy and come work for our cool team in Moscow City on the 28th floor.           2\n","2900                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Still spit.         2\n","2555  And again with you, \"You asked, we're trying to answer!\" Today's question on the air is, \"What if I drop my skin in the winter?\" Finally, my riddles are solved, my followers are lizards and dragons.  Anyway, if you don't have all this trouble, then Nivea's in a blue bank. He's gonna solve all the shiny stuff, the job and the guy.  And now it's hard, because my case is more serious-- my mom says I'm a snake, it's more about inner qualities, but I'm dropping my skin by spring, specifically. But it's also not a very smart snake: it's burned out in the tanning and scavenger. Imagine? We're treating now.   We're gonna take a soft peel, and we're gonna get rid of a little skin that's already decided to leave you. Don't just rub your face with coffee, rice, scrubs, it's not going to be easy f...         2\n","1038                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      That feeling when Mount Aherba arrived, and you, knowing that your girlfriends are under 30, think you're gonna put in makeup or vitamins.  Like, if you get dizzy when you roll your eyes!         2\n","2718                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               And I also want to show you my sequels of instagram experiments with MOKYA, don't judge them strictly! Or judge:           2\n","1922                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Of course, it's not a dark look, it's just a selfie, looking at the sun -- it's not a good plan from the start, but it's not the same way to show a great glitter (even with a fashon shadow) I don't know.         2\n","579                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Like if gisa         2\n","2477                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               That's actually my answer to any life problems. But let's get back to the carcass.         2\n","2022                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     My diet experiments are continuing. This week became vegetarian and almost without a test (crassans, pizza, mom misses you!). Boca's gone, just like a good mood. But there's a canal coming to your house.          2\n","1962                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Look, why don't you tell me on such a great day, not about makeup, but about camera little copyright channels that deserve more followers than they do now.  I remind you that I don't advertise channels for money, I hardly do VPs, so I want to get these lists sometimes.            2\n","1840                                                                                                                       You know what?  I wouldn't waste my time singing ornaments and diphirambies to an apple that's gold. They noticed me. Seriously, I'm so excited to work with my loved ones, like I've taken Everest. I'm sure all the work (and blogging when you have a job is, you know, hard work, the augie stables from the cosmetics, who's gonna take care of it? You? Nope. I am.)  The only thing left of the cosmetic dream is lush (and yes, I am not shy to share with you my views and the joys of working with the brands).   Anyway, on October 7 and 8, the apple will have an official opening in the poster. They're gonna give you presents, and I'm gonna give you mine right now, pick up the link:           2\n","842                                                                                                                                                                                                                                                                                                                                                                                                 In short, it's a song about a guy who goes to his lover and can't decide which settlement he's going through-- Oberammergau or Unterammergau. Understandable, the best thing is not to go through Bavaria at all, which means the risk of sleeping and not getting anywhere. Although maybe it's the best way out, or you'll get to your lover, and then marriage, children, responsibility, and death. Good morning to you, sir.         2\n","2609  The most difficult texts for me are not cosmetics, not reviews, not stories, not articles for magazines. It's the hardest thing for me to write about homeless pet shelters. Every time I see pictures of other puppies on the Internet, I'm crying and doing everything I can -- giving away money, reposting, fasting, helping with the apparel. But every day, more and more furry people jump out of the virtual corner and waving their tail.  I love sobak the most in the world: more people, food, makeup, clothes, gadgets, travel. I REALLY love dogs, and I want every one of them to have a house and a master.  It's hard for me to write about shelters because I can't make you help. It's either there or it's not. You either respond in the shower or you don't respond; no media can influence it. But th...         2\n","499                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Thank you, as they say, for saving on the consoles.         2\n","1630                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              There are blogs that I've been reading almost since the start of the TV channel. There aren't many of them, but they've been keeping my eye on me for a year. Pauline and I agreed to talk about each other, and I'm doing it with great pleasure. I love reading.          2\n","1548                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   It's nice, you know, to be in the top with the RUSSIAN WOMANs.         2"],"text/html":["\n","  <div id=\"df-607fc2c0-7877-45d2-88c7-f8f53c49d200\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3491</th>\n","      <td>There were a lot of questions about retinol after the leather posts, and what they eat with. So, by pretending to be an accountant from a free window, I'm gonna try to land what it is, what it's for, and whether you really need it.  In short, retinol is one of the forms of vitamin A that has been super popular in cosmetics in recent years. It's proven how cool he is with pimples and wrinkles (and both of you together if you're in the same wonderful category of people as me, who still have pimples but already wrinkles). But I know it's a little hard to step up and get through it.  First of all, retinol is your bro because it regulates cell renewal -- there's every chance that skin will be less like the old paper that was left on the bench in September. The same function helps to remove ...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2628</th>\n","      <td>If there were any comments and FIDBEC, I'd start by asking you, \"How do you choose a bank where you keep your gold?\" I've got a dumb cliché: there's a creepyly uncomfortable pay card with a crippled Rosbank app, there's a mortgage and a lame pickup and a Rocketbank that started a couple of years ago on the advice of friends. To be honest, more than I use, I hear, or I'm trying to fix the app bugs. I mean, in general, I've come to accept that there's nothing in everything, but the girlfriends are upsetting Tinkoff. It's impossible to resist. But this isn't about girlfriends, it's about the pink card with this map that was released in conjunction with Masha Wei, and I'm pretty cold to her, but who cares when it's on the map? ON THE BLOOD BACK. And there's a thousand of them!  This doesn'...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>191</th>\n","      <td>If you don't read my bed-advises, you're always gonna walk around with girls, no one's gonna take you.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1808</th>\n","      <td>Every time I read any message on this channel, I want to cry with my knees around. What kind of life is this?</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1415</th>\n","      <td>We've got a social media manager job at the isobar.  If you're okay, study the vacancy and come work for our cool team in Moscow City on the 28th floor.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2900</th>\n","      <td>Still spit.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2555</th>\n","      <td>And again with you, \"You asked, we're trying to answer!\" Today's question on the air is, \"What if I drop my skin in the winter?\" Finally, my riddles are solved, my followers are lizards and dragons.  Anyway, if you don't have all this trouble, then Nivea's in a blue bank. He's gonna solve all the shiny stuff, the job and the guy.  And now it's hard, because my case is more serious-- my mom says I'm a snake, it's more about inner qualities, but I'm dropping my skin by spring, specifically. But it's also not a very smart snake: it's burned out in the tanning and scavenger. Imagine? We're treating now.   We're gonna take a soft peel, and we're gonna get rid of a little skin that's already decided to leave you. Don't just rub your face with coffee, rice, scrubs, it's not going to be easy f...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1038</th>\n","      <td>That feeling when Mount Aherba arrived, and you, knowing that your girlfriends are under 30, think you're gonna put in makeup or vitamins.  Like, if you get dizzy when you roll your eyes!</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2718</th>\n","      <td>And I also want to show you my sequels of instagram experiments with MOKYA, don't judge them strictly! Or judge:</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1922</th>\n","      <td>Of course, it's not a dark look, it's just a selfie, looking at the sun -- it's not a good plan from the start, but it's not the same way to show a great glitter (even with a fashon shadow) I don't know.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>579</th>\n","      <td>Like if gisa</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2477</th>\n","      <td>That's actually my answer to any life problems. But let's get back to the carcass.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2022</th>\n","      <td>My diet experiments are continuing. This week became vegetarian and almost without a test (crassans, pizza, mom misses you!). Boca's gone, just like a good mood. But there's a canal coming to your house.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1962</th>\n","      <td>Look, why don't you tell me on such a great day, not about makeup, but about camera little copyright channels that deserve more followers than they do now.  I remind you that I don't advertise channels for money, I hardly do VPs, so I want to get these lists sometimes.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1840</th>\n","      <td>You know what?  I wouldn't waste my time singing ornaments and diphirambies to an apple that's gold. They noticed me. Seriously, I'm so excited to work with my loved ones, like I've taken Everest. I'm sure all the work (and blogging when you have a job is, you know, hard work, the augie stables from the cosmetics, who's gonna take care of it? You? Nope. I am.)  The only thing left of the cosmetic dream is lush (and yes, I am not shy to share with you my views and the joys of working with the brands).   Anyway, on October 7 and 8, the apple will have an official opening in the poster. They're gonna give you presents, and I'm gonna give you mine right now, pick up the link:</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>842</th>\n","      <td>In short, it's a song about a guy who goes to his lover and can't decide which settlement he's going through-- Oberammergau or Unterammergau. Understandable, the best thing is not to go through Bavaria at all, which means the risk of sleeping and not getting anywhere. Although maybe it's the best way out, or you'll get to your lover, and then marriage, children, responsibility, and death. Good morning to you, sir.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2609</th>\n","      <td>The most difficult texts for me are not cosmetics, not reviews, not stories, not articles for magazines. It's the hardest thing for me to write about homeless pet shelters. Every time I see pictures of other puppies on the Internet, I'm crying and doing everything I can -- giving away money, reposting, fasting, helping with the apparel. But every day, more and more furry people jump out of the virtual corner and waving their tail.  I love sobak the most in the world: more people, food, makeup, clothes, gadgets, travel. I REALLY love dogs, and I want every one of them to have a house and a master.  It's hard for me to write about shelters because I can't make you help. It's either there or it's not. You either respond in the shower or you don't respond; no media can influence it. But th...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>499</th>\n","      <td>Thank you, as they say, for saving on the consoles.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1630</th>\n","      <td>There are blogs that I've been reading almost since the start of the TV channel. There aren't many of them, but they've been keeping my eye on me for a year. Pauline and I agreed to talk about each other, and I'm doing it with great pleasure. I love reading.</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1548</th>\n","      <td>It's nice, you know, to be in the top with the RUSSIAN WOMANs.</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-607fc2c0-7877-45d2-88c7-f8f53c49d200')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-607fc2c0-7877-45d2-88c7-f8f53c49d200 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-607fc2c0-7877-45d2-88c7-f8f53c49d200');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":66}]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, X_test['message']), total=len(X_test)))\n","\n","X_test['lemmas'] = lemmas\n","X_test.sample(10)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":650,"referenced_widgets":["8e545914642b4596aa9ed03764375c62","1a94ce1675bc400e91c03b835c80cd37","1c366ca351584cbda4801808dc452315","3431b7b96df04c89b0e5d54d59266022","a4dd26bff150486e9550e1e73e8267e2","0c427924690741d6a314f8dd79a1e268","919fdd9f887d49fda89c04f3b72aad56","8d941f5ca487432a848071f35b275f70","d08f99f499f347cc97976393fd9cc8aa","c6e3be3198b14a9993e78c168d05da30","0f74adbb115c4693b2ad79416ab22f7e"]},"id":"ULrvYwrc9yJj","executionInfo":{"status":"ok","timestamp":1666210511080,"user_tz":-180,"elapsed":1596,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"4230adb8-f2a3-4d53-afcc-45d606a9bb88"},"execution_count":56,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/3266 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8e545914642b4596aa9ed03764375c62"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              message  category                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           lemmas\n","6099                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1k, does anyone have anything for heartburn? 🥺         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        k does anyone have anything for heartburn\n","2631  I've been getting worse on my face lately than anything that could get any worse, so it's a little tight with the exit test. I think I'll understand everyone who's got trouble skin, that if you find a care that helps you a little bit, you hold on to him for the last hope, especially when you're a teenager in a pubertate. And when everyone's excited about the heat in the summer, you dream that this mess is over, and you can be more comfortable. So I had a long and hard time testing the exit from the Skinbiotic: testing the line for the fat and problem skin with the lentils.   The problem skin cream serioushly pure is cool and good for the heat: it has a souffle texture (which seems to be the most appropriate name). It narrows down the pores (in a couple of weeks it becomes apparent), re...         2  i ve been getting worse on my face lately than anything that could get any worse so it s a little tight with the exit test i think i ll understand everyone who s got trouble skin that if you find a care that helps you a little bit you hold on to him for the last hope especially when you re a teenager in a pubertate and when everyone s excited about the heat in the summer you dream that this mess is over and you can be more comfortable so i had a long and hard time testing the exit from the skinbiotic: testing the line for the fat and problem skin with the lentils the problem skin cream serioushly pure is cool and good for the heat: it has a souffle texture (which seems to be the most appropriate name) it narrows down the pores (in a couple of weeks it becomes apparent) reduces the prod...\n","1390                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         although it also depends on where you bought the tickets         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         although it also depends on where you bought the tickets\n","8090                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           There will be no fluff         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           there will be no fluff\n","2196                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *aggressive mode*         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aggressive mode\n","2978                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             20-30 to Slavyanka in the afternoon?         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    to slavyanka in the afternoon\n","4165                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Some horses live there, apparently, neighing every day for the whole floor ...         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         some horses live there apparently neighing every day for the whole floor\n","9208                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           and fuck me conditions         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           and fuck me conditions\n","198                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Will there be some kind of normalization or can we not hope for it?) For example, for the first quiz, the best score is 8.57, that is, 12 out of 14 ...         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             will there be some kind of normalization or can we not hope for it ) for example for the first quiz the best score is that is out of\n","7668                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             inside Moscow you can ride trains on social networks         0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             inside moscow you can ride trains on social networks"],"text/html":["\n","  <div id=\"df-36750abe-8eff-41cd-8fdd-a73dc02667ee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>6099</th>\n","      <td>1k, does anyone have anything for heartburn? 🥺</td>\n","      <td>0</td>\n","      <td>k does anyone have anything for heartburn</td>\n","    </tr>\n","    <tr>\n","      <th>2631</th>\n","      <td>I've been getting worse on my face lately than anything that could get any worse, so it's a little tight with the exit test. I think I'll understand everyone who's got trouble skin, that if you find a care that helps you a little bit, you hold on to him for the last hope, especially when you're a teenager in a pubertate. And when everyone's excited about the heat in the summer, you dream that this mess is over, and you can be more comfortable. So I had a long and hard time testing the exit from the Skinbiotic: testing the line for the fat and problem skin with the lentils.   The problem skin cream serioushly pure is cool and good for the heat: it has a souffle texture (which seems to be the most appropriate name). It narrows down the pores (in a couple of weeks it becomes apparent), re...</td>\n","      <td>2</td>\n","      <td>i ve been getting worse on my face lately than anything that could get any worse so it s a little tight with the exit test i think i ll understand everyone who s got trouble skin that if you find a care that helps you a little bit you hold on to him for the last hope especially when you re a teenager in a pubertate and when everyone s excited about the heat in the summer you dream that this mess is over and you can be more comfortable so i had a long and hard time testing the exit from the skinbiotic: testing the line for the fat and problem skin with the lentils the problem skin cream serioushly pure is cool and good for the heat: it has a souffle texture (which seems to be the most appropriate name) it narrows down the pores (in a couple of weeks it becomes apparent) reduces the prod...</td>\n","    </tr>\n","    <tr>\n","      <th>1390</th>\n","      <td>although it also depends on where you bought the tickets</td>\n","      <td>0</td>\n","      <td>although it also depends on where you bought the tickets</td>\n","    </tr>\n","    <tr>\n","      <th>8090</th>\n","      <td>There will be no fluff</td>\n","      <td>0</td>\n","      <td>there will be no fluff</td>\n","    </tr>\n","    <tr>\n","      <th>2196</th>\n","      <td>*aggressive mode*</td>\n","      <td>0</td>\n","      <td>aggressive mode</td>\n","    </tr>\n","    <tr>\n","      <th>2978</th>\n","      <td>20-30 to Slavyanka in the afternoon?</td>\n","      <td>0</td>\n","      <td>to slavyanka in the afternoon</td>\n","    </tr>\n","    <tr>\n","      <th>4165</th>\n","      <td>Some horses live there, apparently, neighing every day for the whole floor ...</td>\n","      <td>0</td>\n","      <td>some horses live there apparently neighing every day for the whole floor</td>\n","    </tr>\n","    <tr>\n","      <th>9208</th>\n","      <td>and fuck me conditions</td>\n","      <td>0</td>\n","      <td>and fuck me conditions</td>\n","    </tr>\n","    <tr>\n","      <th>198</th>\n","      <td>Will there be some kind of normalization or can we not hope for it?) For example, for the first quiz, the best score is 8.57, that is, 12 out of 14 ...</td>\n","      <td>0</td>\n","      <td>will there be some kind of normalization or can we not hope for it ) for example for the first quiz the best score is that is out of</td>\n","    </tr>\n","    <tr>\n","      <th>7668</th>\n","      <td>inside Moscow you can ride trains on social networks</td>\n","      <td>0</td>\n","      <td>inside moscow you can ride trains on social networks</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-36750abe-8eff-41cd-8fdd-a73dc02667ee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-36750abe-8eff-41cd-8fdd-a73dc02667ee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-36750abe-8eff-41cd-8fdd-a73dc02667ee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":56}]},{"cell_type":"code","source":["from sklearn.feature_extraction.text import TfidfVectorizer\n","tfidfconverter = TfidfVectorizer(max_features=4000, min_df=10, max_df=0.8, stop_words=stopwords.words('english'))\n","X = tfidfconverter.fit_transform(X_train.lemmas.to_list()).toarray()"],"metadata":{"id":"1uqtBoHaIKvo","executionInfo":{"status":"ok","timestamp":1666210513056,"user_tz":-180,"elapsed":3,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":57,"outputs":[]},{"cell_type":"code","source":["from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import GridSearchCV\n"],"metadata":{"id":"MYTO8AMQmJol","executionInfo":{"status":"ok","timestamp":1666210514964,"user_tz":-180,"elapsed":250,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":58,"outputs":[]},{"cell_type":"code","source":["from sklearn.ensemble import RandomForestClassifier"],"metadata":{"id":"AL9WBmf4mrh7","executionInfo":{"status":"ok","timestamp":1666210516661,"user_tz":-180,"elapsed":576,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":59,"outputs":[]},{"cell_type":"code","source":["log_reg = LogisticRegression(random_state=0, solver=\"newton-cg\")\n","log_reg.fit(X, X_train['category']) "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FXN7wiMfmLfN","executionInfo":{"status":"ok","timestamp":1666210519211,"user_tz":-180,"elapsed":2303,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"2f2ab0b0-9876-476c-acf2-b60ad46494a3"},"execution_count":60,"outputs":[{"output_type":"execute_result","data":{"text/plain":["LogisticRegression(random_state=0, solver='newton-cg')"]},"metadata":{},"execution_count":60}]},{"cell_type":"code","source":["classifier = RandomForestClassifier(n_estimators=400, random_state=2)\n","classifier.fit(X, X_train['category']) "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EJpttRERmgW4","executionInfo":{"status":"ok","timestamp":1666210709722,"user_tz":-180,"elapsed":188766,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"063ee383-fd37-4b97-9558-33c16ac7550f"},"execution_count":61,"outputs":[{"output_type":"execute_result","data":{"text/plain":["RandomForestClassifier(n_estimators=400, random_state=2)"]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["from sklearn.metrics import classification_report, confusion_matrix, accuracy_score, ConfusionMatrixDisplay"],"metadata":{"id":"6Ivq5uOU-DnN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_test_array = tfidfconverter.transform(X_test.lemmas.to_list()).toarray()\n","y_pred = log_reg.predict(X_test_array)\n","\n","cm = confusion_matrix(X_test['category'],y_pred)\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm,display_labels=log_reg.classes_)\n","disp.plot()\n","\n","plt.show()\n","print(classification_report(X_test['category'],y_pred))\n","print('accuracy_score = ', accuracy_score(X_test['category'], y_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":461},"id":"Bq0B2XQpr7K_","executionInfo":{"status":"ok","timestamp":1666089487322,"user_tz":-180,"elapsed":17,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"1b2351e7-56fa-485f-ec80-0b071eb0d024"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAT8AAAEGCAYAAAAT05LOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAd5UlEQVR4nO3deZgV1b3u8e/bTQMyyNSAjEoUB0IUDcExXsVEkAwmJidqYvQ4HDVBo9HkaHJPNFcfc01MnIdEI1Gj0RiHiAlHVDTHIQ6AQWQQwRGQeZ7p4Xf+2NW4RejeG3r37t71fp6nHqpWraq1qht+rFWrapUiAjOztCkrdgXMzIrBwc/MUsnBz8xSycHPzFLJwc/MUqlVsSuQrbJreezRr6LY1bA8vDW1XbGrYHnYyDo2xybtzDlGHN0+li2vySnv5KmbxkfEyJ0pr1CaVfDbo18Fr47vV+xqWB5G9B5S7CpYHl6JCTt9jmXLa3h1fP+c8pb3ml250wUWSLMKfmbW/AVQS22xq7HTHPzMLC9BUBW5dXubMwc/M8ubW35mljpBUFMCr8U6+JlZ3mpx8DOzlAmgxsHPzNLILT8zS50AqnzPz8zSJoiS6Pb63V4zy09ATY5LfST1k/SspBmSpku6IEn/uaT5kqYky6isY34iaY6kWZJGZKWPTNLmSLo0l8twy8/M8pJ5w6NRVAMXR8RrkjoCkyU9ley7LiJ+nZ1Z0iDgJODTQG/gaUl7J7tvAb4IzAMmShobETPqK9zBz8zyJGrYqbkRAIiIBcCCZH2NpJlAn3oOOR54ICI2Ae9KmgMMS/bNiYh3ACQ9kOStN/i522tmeckMeCinBaiUNClrOXtb55S0B3Ag8EqSdJ6kqZLGSOqSpPUB5mYdNi9J2156vdzyM7O8ZJ7zy7nltzQihtaXQVIH4GHgwohYLek24MqkqCuB3wBn7HiNt83Bz8zyVhs73+0FkFRBJvDdFxGPAETEoqz9dwB/SzbnA9lz3vVN0qgnfbvc7TWzvNS1/HJZ6iNJwJ3AzIi4Niu9V1a2rwPTkvWxwEmS2kgaAAwEXgUmAgMlDZDUmsygyNiGrsMtPzPLSyBqGqfddDjwXeANSVOStJ8CJ0saQibOvgecAxAR0yU9SGYgoxoYHZGZW0vSecB4oBwYExHTGyrcwc/M8tYY3d6IeAG22TwcV88xVwFXbSN9XH3HbYuDn5nlJRCbo7zY1dhpDn5mlpfMQ84tf7jAwc/M8tYYDzkXm4OfmeUlQtSEW35mlkK1bvmZWdpkBjxafuho+VdgZk3KAx5mllo1jfR6WzE5+JlZXhrxDY+icvAzs7zVerTXzNImM7GBg5+ZpUwgqvx6m5mlTQR+yNnM0kh+yNnM0idwy8/MUsoDHmaWOoEa7RsexeTgZ2Z5yXy6suWHjpZ/BWbWxBrno+XF5uBnZnkJ/IaHmaWUW35mljoRcsvPzNInM+Dh19vMLHX8DQ8zS6HMgIfv+ZlZCvkNDzNLHb/hYWap5Q8YmVnqREBVrYOfmaVMptvr4GdmKeQ3PFJq8fwKrrmgPyuXVICCUacs4+tnLQXgsTsrGXtXJWXlwcHHrOasny0A4J0Zbbnxkn6sW1NGWRncNO4tWrcNZk/dhV9f2J9NG8sYNnw137tyPmr5f6+atYuu/YCDv7CGlUtbcc7wfQA49ccLOHTEaiJg5dJW/PrC/ixfVEG7jjVccvMH9Oi9mfJWwUO/7cGTf+5a5CsoLj/qkgNJI4EbgHLg9xFxdSHLayrlrYKzL/uQgftvYP3aMs4buTcHHbmGFUsq+Of4Ttz29CxatwlWLs38eGuq4Vfn786Pb3yfPT+9kdXLyymvCABuvLQvF14zl30PWs9/nfIpJj3bkc8NX1PMyyt5T/65K2P/UMmPb5i7Je2h23pwzzW9ADj+zCWc8sNF3HhpX77670v54K02XH7aADp1rebO59/kmUc6U13V8rt9O640ur0FuwJJ5cAtwHHAIOBkSYMKVV5T6tazmoH7bwCgXYda+u21iaULKvjbPd048bxFtG6TCWydK6sBmPw/HRmw3wb2/PRGAHbtWkN5OSxb1Ir1a8rZ77PrkeAL31zOP5/oVJyLSpFpr3RgzYqP/7+/fu1Hr2u13aWWyPwKiYBd2tcCQdv2NaxZWU5Ndctv9eys2uQ7Hg0tzVkhw/cwYE5EvBMRm4EHgOMLWF5RLJzbmren7cK+B61n/tttmfZKB37wpYH86IS9mDVlFwDmvdMWCX568qcYfezePHhLDwCWLaygslfVlnNV9q5i6cKKolyHwb9fsoB7J81g+Akrueea3QAY+4dK+g/cyJ/+NYPfPfMWt13WhyiBLt/OyIz2lue01EdSP0nPSpohabqkC5L0rpKekjQ7+bNLki5JN0qaI2mqpIOyznVakn+2pNNyuY5CBr8+wNys7XlJ2sdIOlvSJEmTliyrKWB1Gt+GdWVcedYenHvFfNp3rKWmBtasLOeGv83mrJ99yFXn7JH5zF81THu1PZfc/D6/+ets/vlEJ/71fIdiV9+2ctcve3HK0EE880hnvnpG5h7uZ49aw9vTd+HbBw7i+1/cm9FXzaddh5b197Sx1T3knMvSgGrg4ogYBBwCjE56h5cCEyJiIDAh2YZML3JgspwN3AaZYAlcDhxMptF1eV3ArE/RO+4RcXtEDI2Iod27tZyZIqqr4Mqz9mD4CSs4YtQqACp7VXH4qFVIsO+B6ykrg1XLy+neq4rPHLKOTt1qaNsu+Nzw1cx5Yxe67VbF0gUftfSWflhB5W5V2yvSmsgzj3bZ8js99sTlvDiuEyA+fK8NCz9oTb+9NhW3gs1AY3R7I2JBRLyWrK8BZpJpIB0P3J1kuxv4WrJ+PHBPZLwMdJbUCxgBPBURyyNiBfAUMLKhayhk8JsP9Mva7puktXgRcO3F/ek3cBPfOGfJlvTDRq7i9RczLbp5b7eharPo1LWGzx61hvdmtmXjelFTDVNf6kD/vTfRrWc17TrWMHNyOyLg6Ye6cuiIVcW6rFTrPeCjgHboiFXMndMGgCXzWzPk82sB6FxZRd89N7Lgg9ZFqWNzUTfam2PLr7KuZ5csZ2/rnJL2AA4EXgF6RsSCZNdCoGeyvr3eZE69zK0VcrR3IjBQ0gAyQe8k4NsFLK/JTH+1PRMe6sqA/TbwvS9kHpU4/ScfMuKk5Vx7UT/OPnofKiqCH9/wARJ07FzDCecs4fxReyPBsOGrOfgLqwE4///P49cX9mfzxjKGHr3aI71N4NJb32f/Q9fSqWs1906awR9/05Nhw9fQd89N1NbC4vmtufGSvgDcd31PfnT9B/x2wiwkuPOq3qxe7ifE8hjtXRoRQ+vLIKkD8DBwYUSsVtazXhERkmKHK1qPgv0WI6Ja0nnAeDKPuoyJiOmFKq8pDT54HeM/nLLNfZfc/ME204/5xgqO+caKT6TvfcAGbn92VqPWz+p39fd3/0Ta+Pu7bTPv8kUV/PTkPQtdpRYlQlQ30qMukirIBL77IuKRJHmRpF4RsSDp1i5O0rfXm5wPHLVV+j8aKrug9/wiYlxE7B0Re0bEVYUsy8yaTmMMeCjTxLsTmBkR12btGgvUjdieBjyWlX5qMup7CLAq6R6PB46V1CUZ6Dg2SauX2+9mlpdGfMPjcOC7wBuS6rpSPwWuBh6UdCbwPvCtZN84YBQwB1gPnA4QEcslXUnmVhvAFRGxvKHCHfzMLG+NEfwi4gXY7pDwMdvIH8Do7ZxrDDAmn/Id/MwsL57M1MxSq7m/upYLBz8zy0sEVHsyUzNLI3d7zSx1fM/PzFKrFGa2cfAzs7x5wMPMUifC9/zMLJVEjUd7zSyNfM/PzFLHX28zs3QKtnzgqSVz8DOzvHm018xSJzzgYWZp5W6vmaWSR3vNLHUiHPzMLKX8qIuZpZLv+ZlZ6gSi1qO9ZpZGJdDwc/Azszx5wMPMUqsEmn4OfmaWt5Ju+Um6iXrie0T8oCA1MrNmLYDa2hIOfsCkJquFmbUcAZRyyy8i7s7eltQuItYXvkpm1tyVwnN+DT6sI+lQSTOAN5PtAyTdWvCamVnzFTkuzVguTypeD4wAlgFExOvAkYWslJk1ZyIit6U5y2m0NyLmSh+7kJrCVMfMWoRm3qrLRS7Bb66kw4CQVAFcAMwsbLXMrNkKiBIY7c2l23suMBroA3wIDEm2zSy1lOPSfDXY8ouIpcB3mqAuZtZSlEC3N5fR3k9JelzSEkmLJT0m6VNNUTkza6ZSMtr7J+BBoBfQG/gLcH8hK2VmzVjdQ865LA2QNCZpVE3LSvu5pPmSpiTLqKx9P5E0R9IsSSOy0kcmaXMkXZrLZeQS/NpFxB8jojpZ7gXa5nJyMytNEbktObgLGLmN9OsiYkiyjAOQNAg4Cfh0csytksollQO3AMcBg4CTk7z1qu/d3q7J6n8nkfQBMjH/RGBcTpdlZqWpkUZ7I+I5SXvkmP144IGI2AS8K2kOMCzZNyci3gGQ9ECSd0Z9J6tvwGMymWBXd5XnZNcZ+EmOFTazEqPc7+dVSsqeJ+D2iLg9h+POk3QqmTkGLo6IFWSeOHk5K8+8JA1g7lbpBzdUQH3v9g7IoYJmljb5DWYsjYiheZZwG3BlUsqVwG+AM/I8R4NyesND0mAyfekt9/oi4p7GroyZtQS5DWbsqIhYtKUk6Q7gb8nmfKBfVta+SRr1pG9XLo+6XA7clCxHA78CvtrQcWZWwgr4qIukXlmbXwfqRoLHAidJaiNpADAQeBWYCAyUNEBSazKDImMbKieXlt83gQOAf0XE6ZJ6AvfmfilmVnJqG+c0ku4HjiJzb3AecDlwlKQhZMLneyTjDRExXdKDZAYyqoHREVGTnOc8YDxQDoyJiOkNlZ1L8NsQEbWSqiXtCizm401MM0uTRpzMNCJO3kbynfXkvwq4ahvp48jzKZRcgt8kSZ2BO8iMAK8FXsqnEDMrLXmM9jZbubzb+/1k9beSngB2jYipha2WmTVrpRz8JB1U376IeK0wVTIzK7z6Wn6/qWdfAMMbuS7MfrMTXzr4y419WiugX777cLGrYHk45StrG+U8Jd3tjYijm7IiZtZCBI32elsx+aPlZpa/Um75mZltT0l3e83MtqsEgl8ur7dJ0imSLku2+0sa1tBxZlbCUjKT863AoUDdk9hryEwcaGYppMh9ac5y6fYeHBEHSfoXQESsSF4eNrO0Sslob1UyTXQASOpOo73WbGYtUXNv1eUil27vjcCjQA9JVwEvAL8oaK3MrHkrgXt+ubzbe5+kycAxZKa0/1pEzCx4zcyseWoB9/Ny0WDwk9QfWA88np0WER8UsmJm1oylIfgBf+ejDxm1BQYAs8h8Ps7MUkglcNc/l27vZ7K3k9levr+d7GZmLULeb3hExGuSGvwsnJmVsDR0eyVdlLVZBhwEfFiwGplZ85aWAQ+gY9Z6NZl7gJ7EzSzNSj34JQ83d4yIHzVRfcysJSjl4CepVURUSzq8KStkZs2bKP3R3lfJ3N+bImks8BdgXd3OiHikwHUzs+YoRff82gLLyHyzo+55vwAc/MzSqsSDX49kpHcaHwW9OiVw6Wa2w0ogAtQX/MqBDnw86NUpgUs3sx1V6t3eBRFxRZPVxMxajhIPfi1/tkIza3xR+qO9xzRZLcysZSnlll9ELG/KiphZy1Hq9/zMzLbNwc/MUqcFTFGfCwc/M8uLcLfXzFKqFIJfLl9vMzP7uEb6epukMZIWS5qWldZV0lOSZid/dknSJelGSXMkTU1mla875rQk/2xJp+VyCQ5+Zpa/xvt05V3AyK3SLgUmRMRAYEKyDXAcMDBZzgZug0ywBC4HDgaGAZfXBcz6OPiZWX6SWV1yWRo8VcRzwNaP1R0P3J2s3w18LSv9nsh4GegsqRcwAngqIpZHxArgKT4ZUD/B9/zMLH+53/OrlDQpa/v2iLi9gWN6RsSCZH0h0DNZ7wPMzco3L0nbXnq9HPzMLG95vN62NCKG7mg5ERFSYYZX3O01s7w1Vrd3OxYl3VmSPxcn6fOBfln5+iZp20uvl4OfmeUn18GOHQ9+Y4G6EdvTgMey0k9NRn0PAVYl3ePxwLGSuiQDHccmafVyt9fM8tdIHVFJ9wNHkbk3OI/MqO3VwIOSzgTeB76VZB8HjALmAOuB0yEzD4GkK4GJSb4rcpmbwMHPzPLSmG94RMTJ29n1iVmlIiKA0ds5zxhgTD5lO/iZWd5U2/Jf8XDwM7P8eGIDM0urUni318HPzPLn4GdmaeSWn5mlk4OfmaVOCr7eZmb2CZ7J2czSK1p+9HPwM7O8ueVnVLSu4Ze/fYmK1rWUlwcvPtOL++7Ymx/+7HUGH7SM9WsrALjuiv15Z3YnIDjnohkMPWwxmzaWc92VB/D2rE7FvYgUWPlha/588Z6sXVoBCg4+eTFHnL5oy/7n7tiNv/9idy6bPJn2XasBePvljjx+xe7UVIv2Xao5988zt+SvrYGbvjqYXXfbzOl3vtXk11NUfsi5fpL6AfeQmYgwyExieEOhyiuWqs1l/HT0IWzc0Iry8lquuf0lJr3UHYAxN+3Hi8/0+lj+oYctoXe/dfzHN49in8ErGf2f07jozMOLUfVUKWsVfPn/vk+fwevZtLaMG78ymIFHrKbnwA2s/LA1bz3fic69N23Jv2F1OX/92QDOuOtNuvTZzNqlH/+n8sIfdqPHXhvYuLa8qS+lWSiFAY9CTmlVDVwcEYOAQ4DRkgYVsLwiERs3ZP5htGoVlLeqrfd/xUOOXMQz/90HELOmdaF9xyq6dNvYNFVNsV17VNFn8HoA2nSopcdeG1m1MNMqf/zK3Rl16Vykj/JPeawbg0csp0ufzQB0qKzesm/lgta8+WxnPnfikqa7gGZGtbktzVnBgl9ELIiI15L1NcBMcphauiUqKwtu+uPz3PfEU0x5tZJZ0zPfTjn13FncfO9z/MeFM2hVUQNAt+4bWbJoly3HLl3clm7dHfya0vJ5rZk/ox39h6xj+pNd6LTbZnoPWv+xPEvebcuGVa343Un7ceNXBjP54cot+x6/YndGXfoBKiuBvt+OCDIDHrkszViT3POTtAdwIPDKNvadTeZLTLQt79gU1Wl0tbXi/O9+nvYdqvivX01i90+t4a5b92HFsja0qqjl/J+8wb+d+g733zmw2FVNvU3ryrj3e3vz1Z+9T1mr4Nlbe3PmPW9+Il9ttZg3rT1n3zeTqo1l3PKNT9P/wLUsfbctHSqr6PuZ9bz9csv8+9oYPOCRA0kdgIeBCyNi9db7k4+Z3A7QqU3PFv0jXbe2gqmTK/nsoYt55L49AaiuKufpv/XjhO+8A8CyJW3p3nPDlmMqe2xk2ZK2Ralv2tRUiT9+byBDjl/K4JErWPDmLiyf14YbRn0GgFULW3PDVwZz/l+n06nXZtp1WUnrdrW0blfLgGGrWTCzHfOnt2fG012Y9WxnqjaJTWvLeeDCPTnp+reLfHVNrEX/S80oaPCTVEEm8N0XEY8Usqxi2bXzJmqqy1i3toLWbWoYMmwJD92zJ126bWTFsrZAcMj/Wcj7b2daCa8834Mvf/N9/ufJ3uwzeCXr1rZK8lkhRcBDlwygx14bOPKshQD02ncDl016bUueq48Ywvljp9G+azWDvriCxy7fg5pqqKkqY+6UDnz+jIXs/6XlHPefmQ+Fvf1yR567o1fqAp8fcm6AJAF3AjMj4tpClVNsXSs3cdFlr1NWFqgseGFCbya+2JNf3PIynTpvBgXvvrUrN/8y07qY+GIPhh62hN8//I/kUZf9i3wF6fDepA689mh3dttnPdePGgzAyB/PZd+jV20zf8+9NrLPkau4/rj9UVnwuROXsNs+G7aZN3UiSmIyU0WBbkpKOgJ4HngDqBv3+WlEjNveMZ3a9IzDdvt2QepjhXHVcw8XuwqWh1O+spAZUzer4Zzb17Fz3zjwyAtyyvv84/85eWc+XVlIBWv5RcQLZFrIZlZi3O01s/QJoAS6vQ5+Zpa/lh/7HPzMLH/u9ppZKpXCaK+Dn5nlx7O6mFkaZR5ybvnRz8HPzPLXzGdsyYWDn5nlzS0/M0sf3/Mzs3QqjXd7HfzMLH/u9ppZ6vij5WaWWm75mVkqtfzYV9Cvt5lZiVJtbU5Lg+eR3pP0hqQpkiYlaV0lPSVpdvJnlyRdkm6UNEfSVEkH7cw1OPiZWX6CzEPOuSy5OToihmRNenopMCEiBgITkm2A44CByXI2cNvOXIaDn5nlRQSK3JYddDxwd7J+N/C1rPR7IuNloLOkXjtaiIOfmeWv8b7bG8CTkiYnn7EF6BkRC5L1hUDPZL0PMDfr2HnsxLfAPeBhZvnLvVVXWXcvL3F78rnaOkdExHxJPYCnJH3sI8oREVJhZg908DOz/NTd88vN0vo+YBQR85M/F0t6FBgGLJLUKyIWJN3axUn2+UC/rMP7Jmk7xN1eM8tbY4z2SmovqWPdOnAsMA0YC5yWZDsNeCxZHwucmoz6HgKsyuoe580tPzPLU8738xrSE3g084lvWgF/iognJE0EHpR0JvA+8K0k/zhgFDAHWA+cvjOFO/iZWX6CRgl+EfEOcMA20pcBx2wjPYDRO11wwsHPzPLnd3vNLI08mamZpZODn5mlTgTUtPx+r4OfmeXPLT8zSyUHPzNLnQD8DQ8zS5+A8D0/M0ubwAMeZpZSvudnZqnk4Gdm6dNoExsUlYOfmeUngBw+TtTcOfiZWf7c8jOz9PHrbWaWRgHh5/zMLJX8hoeZpZLv+ZlZ6kR4tNfMUsotPzNLnyBqaopdiZ3m4Gdm+fGUVmaWWn7UxczSJoBwy8/MUic8mamZpVQpDHgomtGQtaQlwPvFrkcBVAJLi10Jy0up/s52j4juO3MCSU+Q+fnkYmlEjNyZ8gqlWQW/UiVpUkQMLXY9LHf+nZW+smJXwMysGBz8zCyVHPyaxu3FroDlzb+zEud7fmaWSm75mVkqOfiZWSo5+BWQpJGSZkmaI+nSYtfH6iepn6RnJc2QNF3SBcWukxWO7/kViKRy4C3gi8A8YCJwckTMKGrFbLsk9QJ6RcRrkjoCk4Gv+XdWmtzyK5xhwJyIeCciNgMPAMcXuU5Wj4hYEBGvJetrgJlAn+LWygrFwa9w+gBzs7bn4X9ILYakPYADgVeKWxMrFAc/s61I6gA8DFwYEauLXR8rDAe/wpkP9Mva7pukWTMmqYJM4LsvIh4pdn2scBz8CmciMFDSAEmtgZOAsUWuk9VDkoA7gZkRcW2x62OF5eBXIBFRDZwHjCdz4/zBiJhe3FpZAw4HvgsMlzQlWUYVu1JWGH7UxcxSyS0/M0slBz8zSyUHPzNLJQc/M0slBz8zSyUHvxZEUk3y+MU0SX+R1G4nznWXpG8m67+XNKievEdJOmwHynhP0ie+8rW99K3yrM2zrJ9L+lG+dbT0cvBrWTZExJCIGAxsBs7N3ilph77DHBFnNTBzyVFA3sHPrDlz8Gu5ngf2Slplz0saC8yQVC7pGkkTJU2VdA5k3l6QdHMyv+DTQI+6E0n6h6ShyfpISa9Jel3ShOQF/3OBHyatzs9L6i7p4aSMiZIOT47tJunJZC683wNq6CIk/VXS5OSYs7fad12SPkFS9yRtT0lPJMc8L2nfxvhhWvrsUEvBiitp4R0HPJEkHQQMjoh3kwCyKiI+J6kN8KKkJ8nMULIPMAjoCcwAxmx13u7AHcCRybm6RsRySb8F1kbEr5N8fwKui4gXJPUn8xbLfsDlwAsRcYWkLwFn5nA5ZyRl7AJMlPRwRCwD2gOTIuKHki5Lzn0emQ8LnRsRsyUdDNwKDN+BH6OlnINfy7KLpCnJ+vNk3kM9DHg1It5N0o8F9q+7nwd0AgYCRwL3R0QN8KGkZ7Zx/kOA5+rOFRHLt1OPLwCDMq/CArBrMhPKkcAJybF/l7Qih2v6gaSvJ+v9krouA2qBPyfp9wKPJGUcBvwlq+w2OZRh9gkOfi3LhogYkp2QBIF12UnA+RExfqt8jfmOahlwSERs3EZdcibpKDKB9NCIWC/pH0Db7WSPpNyVW/8MzHaE7/mVnvHA95KpmZC0t6T2wHPAick9wV7A0ds49mXgSEkDkmO7JulrgI5Z+Z4Ezq/bkFQXjJ4Dvp2kHQd0aaCunYAVSeDbl0zLs04ZUNd6/TaZ7vRq4F1J/5aUIUkHNFCG2TY5+JWe35O5n/eapGnA78i08B8FZif77gFe2vrAiFgCnE2mi/k6H3U7Hwe+XjfgAfwAGJoMqMzgo1Hn/0cmeE4n0/39oIG6PgG0kjQTuJpM8K2zDhiWXMNw4Iok/TvAmUn9puNPA9gO8qwuZpZKbvmZWSo5+JlZKjn4mVkqOfiZWSo5+JlZKjn4mVkqOfiZWSr9L2KTVBx42NCxAAAAAElFTkSuQmCC\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.88      0.95      0.92      2798\n","           2       0.95      0.88      0.91      2814\n","\n","    accuracy                           0.91      5612\n","   macro avg       0.92      0.91      0.91      5612\n","weighted avg       0.92      0.91      0.91      5612\n","\n","accuracy_score =  0.9130434782608695\n"]}]},{"cell_type":"markdown","source":["# Submition for double model"],"metadata":{"id":"4UATnrjk73nO"}},{"cell_type":"code","source":["!cp '/content/drive/MyDrive/4 курс/NLP/ДЗ1/RandomForestClassifier.joblib' .\n","!cp '/content/drive/MyDrive/4 курс/NLP/ДЗ1/TfidfVectorizer.joblib' . "],"metadata":{"id":"X4Z88ZtiSPpT","executionInfo":{"status":"ok","timestamp":1666210813509,"user_tz":-180,"elapsed":3062,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":67,"outputs":[]},{"cell_type":"code","source":["from joblib import dump, load"],"metadata":{"id":"3E1PQRz7SqQF","executionInfo":{"status":"ok","timestamp":1666210813511,"user_tz":-180,"elapsed":13,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":68,"outputs":[]},{"cell_type":"code","source":["model_bitcoin_classifier = load('RandomForestClassifier.joblib')\n","model_bitcoin_tfidfconverter = load('TfidfVectorizer.joblib')"],"metadata":{"id":"QkgqbC0gShEe","executionInfo":{"status":"ok","timestamp":1666210817367,"user_tz":-180,"elapsed":3867,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":69,"outputs":[]},{"cell_type":"code","source":["submition = pd.read_csv('test_data.csv')"],"metadata":{"id":"h0LtataD-MDQ","executionInfo":{"status":"ok","timestamp":1666210817746,"user_tz":-180,"elapsed":388,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":70,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1666210817749,"user_tz":-180,"elapsed":7,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"a7a9166b-4161-4940-fee0-14854341c3ad","id":"EUrO8_te-MDQ"},"execution_count":71,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ... \n","2      275674                                                                                                                               Vladimir, when will we have seminar?\n","3      275675                                                                                                                                              A couple at 111, too?\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:\n","...       ...                                                                                                                                                                ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc: \n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.\n","\n","[5927 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-1d18d150-3e0f-42be-b189-049a24e401b9\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1d18d150-3e0f-42be-b189-049a24e401b9')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1d18d150-3e0f-42be-b189-049a24e401b9 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1d18d150-3e0f-42be-b189-049a24e401b9');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":71}]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, submition['message']), total=len(submition)))\n","submition['lemmas'] = lemmas\n","submition.sample(10)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":719,"referenced_widgets":["d411a81a06a94b8298f5e90192bb25b9","ca83eff8b5a244529d20a71b1f8cacfd","3bc159a2a0c54951bf21f6a5b368c835","3c130c85123543de80b59aa8d02e88f9","86ed57aca8a8495690dcf4d9d993337c","39e954100aa84b85b394bb6b713f7155","40c5cad1d93a4d02bebe6a83d1a724d3","c9a02c63b4b64fc29437b0717c201ea8","158565d2b4814faaac29f8141427dd5f","820badd400c24ea6b13b9ec763dc1543","add79652b5da4a26b40ddd1e90a3e3e4"]},"executionInfo":{"status":"ok","timestamp":1666210827284,"user_tz":-180,"elapsed":8622,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"9b8d8a4b-08f8-4cca-ae97-5129746bf274","id":"p7IERlgG73nR"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/5927 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d411a81a06a94b8298f5e90192bb25b9"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          message                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                lemmas\n","4363  3142191                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Children &apos; s mat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   children apos s mat\n","2338   278011                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 I'm still answering your questions by reference.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       i m still answering your questions by reference\n","445    276117                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            😍CompTIA CySA+ (CS0-002)  Complete Course & Practice Exam😍  Pass CompTIA Cybersecurity Analyst+ (CS0-002) exam on your 1st attempt, includes a full practice exam !  SIZE : 14 GB +  Download link :                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            comptia cysa (cs ) complete course practice exam pass comptia cybersecurity analyst (cs ) exam on your st attempt includes a full practice exam ! size : gb download link :\n","1475   277147                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Every time I see something like this, there's a little fluffy puppy of corgi being born somewhere in the world. Thank you.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               every time i see something like this there s a little fluffy puppy of corgi being born somewhere in the world thank you\n","4452  3142280  Civic Vini Lingham, Director-General of Start-up, believes that we are on the verge of a new Bitcoin race. The result of another rally would be $15,000, wrote Lingham on Twitter.  However, by exceeding this psychological mark, the BTC will retreat below $14,000, then begin the long consolidation phase. It could last a few weeks. Lingham doesn't think we're gonna see a backslide below $12,000.  But even if the BTC weakens below this level, there will be more support in the $10,000 area, and investors will not allow Bitcoin to fall further. The Bears are giving up, and the market is clearly becoming \"big.\"  In the long run, CEO Civil has repeatedly predicted that the biggest cryptist will maintain a rising movement.  As early as May last year, when Bitcoin traded at $6,200, Winnie Lingha...  civic vini lingham director general of start up believes that we are on the verge of a new bitcoin race the result of another rally would be wrote lingham on twitter however by exceeding this psychological mark the btc will retreat below then begin the long consolidation phase it could last a few weeks lingham doesn t think we re gonna see a backslide below but even if the btc weakens below this level there will be more support in the area and investors will not allow bitcoin to fall further the bears are giving up and the market is clearly becoming big in the long run ceo civil has repeatedly predicted that the biggest cryptist will maintain a rising movement as early as may last year when bitcoin traded at winnie lingham admitted that in the btc would be able to make a run to\n","4724  3142552                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Visualist and blogger Ushosh. Writes more effective posts and knows better about cosmetics than most bloggers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          visualist and blogger ushosh writes more effective posts and knows better about cosmetics than most bloggers\n","3733   279410                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               And these shoes are gonna make a pretty accent in the image. However, their color is quite universal, as it is easily combined with many others —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           and these shoes are gonna make a pretty accent in the image however their color is quite universal as it is easily combined with many others\n","1678   277351                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Beautiful jeans.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       beautiful jeans\n","263    275935                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               She's not looking.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     she s not looking\n","1288   276960                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               The guy's just a math, no jackass?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      the guy s just a math no jackass"],"text/html":["\n","  <div id=\"df-7248d93b-acbe-41f2-9075-3369dca2b56d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4363</th>\n","      <td>3142191</td>\n","      <td>Children &amp;apos; s mat</td>\n","      <td>children apos s mat</td>\n","    </tr>\n","    <tr>\n","      <th>2338</th>\n","      <td>278011</td>\n","      <td>I'm still answering your questions by reference.</td>\n","      <td>i m still answering your questions by reference</td>\n","    </tr>\n","    <tr>\n","      <th>445</th>\n","      <td>276117</td>\n","      <td>😍CompTIA CySA+ (CS0-002)  Complete Course &amp; Practice Exam😍  Pass CompTIA Cybersecurity Analyst+ (CS0-002) exam on your 1st attempt, includes a full practice exam !  SIZE : 14 GB +  Download link :</td>\n","      <td>comptia cysa (cs ) complete course practice exam pass comptia cybersecurity analyst (cs ) exam on your st attempt includes a full practice exam ! size : gb download link :</td>\n","    </tr>\n","    <tr>\n","      <th>1475</th>\n","      <td>277147</td>\n","      <td>Every time I see something like this, there's a little fluffy puppy of corgi being born somewhere in the world. Thank you.</td>\n","      <td>every time i see something like this there s a little fluffy puppy of corgi being born somewhere in the world thank you</td>\n","    </tr>\n","    <tr>\n","      <th>4452</th>\n","      <td>3142280</td>\n","      <td>Civic Vini Lingham, Director-General of Start-up, believes that we are on the verge of a new Bitcoin race. The result of another rally would be $15,000, wrote Lingham on Twitter.  However, by exceeding this psychological mark, the BTC will retreat below $14,000, then begin the long consolidation phase. It could last a few weeks. Lingham doesn't think we're gonna see a backslide below $12,000.  But even if the BTC weakens below this level, there will be more support in the $10,000 area, and investors will not allow Bitcoin to fall further. The Bears are giving up, and the market is clearly becoming \"big.\"  In the long run, CEO Civil has repeatedly predicted that the biggest cryptist will maintain a rising movement.  As early as May last year, when Bitcoin traded at $6,200, Winnie Lingha...</td>\n","      <td>civic vini lingham director general of start up believes that we are on the verge of a new bitcoin race the result of another rally would be wrote lingham on twitter however by exceeding this psychological mark the btc will retreat below then begin the long consolidation phase it could last a few weeks lingham doesn t think we re gonna see a backslide below but even if the btc weakens below this level there will be more support in the area and investors will not allow bitcoin to fall further the bears are giving up and the market is clearly becoming big in the long run ceo civil has repeatedly predicted that the biggest cryptist will maintain a rising movement as early as may last year when bitcoin traded at winnie lingham admitted that in the btc would be able to make a run to</td>\n","    </tr>\n","    <tr>\n","      <th>4724</th>\n","      <td>3142552</td>\n","      <td>Visualist and blogger Ushosh. Writes more effective posts and knows better about cosmetics than most bloggers.</td>\n","      <td>visualist and blogger ushosh writes more effective posts and knows better about cosmetics than most bloggers</td>\n","    </tr>\n","    <tr>\n","      <th>3733</th>\n","      <td>279410</td>\n","      <td>And these shoes are gonna make a pretty accent in the image. However, their color is quite universal, as it is easily combined with many others —</td>\n","      <td>and these shoes are gonna make a pretty accent in the image however their color is quite universal as it is easily combined with many others</td>\n","    </tr>\n","    <tr>\n","      <th>1678</th>\n","      <td>277351</td>\n","      <td>Beautiful jeans.</td>\n","      <td>beautiful jeans</td>\n","    </tr>\n","    <tr>\n","      <th>263</th>\n","      <td>275935</td>\n","      <td>She's not looking.</td>\n","      <td>she s not looking</td>\n","    </tr>\n","    <tr>\n","      <th>1288</th>\n","      <td>276960</td>\n","      <td>The guy's just a math, no jackass?</td>\n","      <td>the guy s just a math no jackass</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7248d93b-acbe-41f2-9075-3369dca2b56d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7248d93b-acbe-41f2-9075-3369dca2b56d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7248d93b-acbe-41f2-9075-3369dca2b56d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":72}]},{"cell_type":"code","source":["X_test_array = model_bitcoin_tfidfconverter.transform(submition.lemmas.to_list()).toarray()\n","y_pred = model_bitcoin_classifier.predict(X_test_array)"],"metadata":{"id":"nqQo_2n-S0q7","executionInfo":{"status":"ok","timestamp":1666210856177,"user_tz":-180,"elapsed":28933,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":73,"outputs":[]},{"cell_type":"code","source":["pd.Series(y_pred).value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fq75ViALTRwS","executionInfo":{"status":"ok","timestamp":1666210856179,"user_tz":-180,"elapsed":60,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"ad7a9c64-da4a-4ff0-afa6-bf5d861b3663"},"execution_count":74,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    5014\n","1     913\n","dtype: int64"]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["submition['category_is_bitcoin'] = y_pred"],"metadata":{"id":"V9lUjbBI73nT","executionInfo":{"status":"ok","timestamp":1666210878242,"user_tz":-180,"elapsed":345,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":75,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":502},"executionInfo":{"status":"ok","timestamp":1666210878553,"user_tz":-180,"elapsed":5,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"32f433cc-845c-4f67-ed88-13c3936ba68b","id":"fG0raqH-73nT"},"execution_count":76,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message                                                                                                                                                         lemmas  category_is_bitcoin\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.                                                                                                                    but a lot of people have a job fair tonight                    0\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ...                                                                                                                      also i got only answers on the google form                    0\n","2      275674                                                                                                                               Vladimir, when will we have seminar?                                                                                                                             vladimir when will we have seminar                    0\n","3      275675                                                                                                                                              A couple at 111, too?                                                                                                                                                a couple at too                    0\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:                                                                                                                            it s on anti buying and again zara:                    0\n","...       ...                                                                                                                                                                ...                                                                                                                                                            ...                  ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc:                                                                                 the second thing write all questions and thoughts about statistics in this doc:                    0\n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?                                                                                          can grayscale actually sell bitcoin (btc) after unlock of gbtc shares                    1\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.                                                                it s not a very operational dude putting them on the schedule wednesday is the first two online                    0\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.  inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa                    0\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.                                                                                                                             okay you don t have to worry i did                    0\n","\n","[5927 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-55d30dbe-3855-4241-ae05-92b30df91d24\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>lemmas</th>\n","      <th>category_is_bitcoin</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>but a lot of people have a job fair tonight</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>also i got only answers on the google form</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>vladimir when will we have seminar</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>a couple at too</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>it s on anti buying and again zara:</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","      <td>the second thing write all questions and thoughts about statistics in this doc:</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","      <td>can grayscale actually sell bitcoin (btc) after unlock of gbtc shares</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","      <td>it s not a very operational dude putting them on the schedule wednesday is the first two online</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","      <td>inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","      <td>okay you don t have to worry i did</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-55d30dbe-3855-4241-ae05-92b30df91d24')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-55d30dbe-3855-4241-ae05-92b30df91d24 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-55d30dbe-3855-4241-ae05-92b30df91d24');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":76}]},{"cell_type":"code","source":["X_ans = tfidfconverter.transform(submition.lemmas.to_list())\n","ans = log_reg.predict(X_ans)\n"],"metadata":{"id":"yTcBRhzbUoMM","executionInfo":{"status":"ok","timestamp":1666210881212,"user_tz":-180,"elapsed":355,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":77,"outputs":[]},{"cell_type":"code","source":["submition['class_0_or_class_2'] = ans"],"metadata":{"id":"RBM0jCwoUsW9","executionInfo":{"status":"ok","timestamp":1666210881454,"user_tz":-180,"elapsed":6,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":78,"outputs":[]},{"cell_type":"code","source":["submition.class_0_or_class_2.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1mB3xRhMU2KS","executionInfo":{"status":"ok","timestamp":1666210883479,"user_tz":-180,"elapsed":7,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"10e43973-4390-451e-d296-ead2de0f49ab"},"execution_count":79,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    5519\n","2     408\n","Name: class_0_or_class_2, dtype: int64"]},"metadata":{},"execution_count":79}]},{"cell_type":"code","source":["submition.sample(3)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":361},"id":"QFJo3V-hV1XV","executionInfo":{"status":"ok","timestamp":1666210883479,"user_tz":-180,"elapsed":5,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"354cee00-6861-4f46-f046-dd82966df3c8"},"execution_count":80,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   message                                                                                                                                                                                                                                                                                                                                                                                                                                                                    lemmas  category_is_bitcoin  class_0_or_class_2\n","5124  3142952  Every morning, there are a few problems: what kind of highlighter is today, what to wear and what to listen to on the way to work.  First and second okay, clearly. But I'm in big trouble with music, because I'm too old to monitor the public, and my playlist is depressing melancholy Fon Trier.  There's a channel with music novels, but it needs to be monitored, because it's not the same style, it's the whole new music that's coming out.  But the tracks are easy to find.  every morning there are a few problems: what kind of highlighter is today what to wear and what to listen to on the way to work first and second okay clearly but i m in big trouble with music because i m too old to monitor the public and my playlist is depressing melancholy fon trier there s a channel with music novels but it needs to be monitored because it s not the same style it s the whole new music that s coming out but the tracks are easy to find                    0                   0\n","3449   279126                                                                                                                                                                                                                                                                                                                                                                                                                                                                   For the class is it OK?                                                                                                                                                                                                                                                                                                                                                                                                                                                    for the class is it ok                    0                   0\n","502    276174                                                                                                                                                                                                  These guys are making a lot of waves in town. Ryoshi Aka ShibFather is been on the market less than 2 weeks and has already managed to build a strong United community. They’re the real deal bringing fresh content on the daily. This token has lots of potential & could be 100x coin                                                                                                                                                                                            these guys are making a lot of waves in town ryoshi aka shibfather is been on the market less than weeks and has already managed to build a strong united community they re the real deal bringing fresh content on the daily this token has lots of potential could be x coin                    1                   0"],"text/html":["\n","  <div id=\"df-177b4921-6887-4634-a170-9879ebf4ceb5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>lemmas</th>\n","      <th>category_is_bitcoin</th>\n","      <th>class_0_or_class_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>5124</th>\n","      <td>3142952</td>\n","      <td>Every morning, there are a few problems: what kind of highlighter is today, what to wear and what to listen to on the way to work.  First and second okay, clearly. But I'm in big trouble with music, because I'm too old to monitor the public, and my playlist is depressing melancholy Fon Trier.  There's a channel with music novels, but it needs to be monitored, because it's not the same style, it's the whole new music that's coming out.  But the tracks are easy to find.</td>\n","      <td>every morning there are a few problems: what kind of highlighter is today what to wear and what to listen to on the way to work first and second okay clearly but i m in big trouble with music because i m too old to monitor the public and my playlist is depressing melancholy fon trier there s a channel with music novels but it needs to be monitored because it s not the same style it s the whole new music that s coming out but the tracks are easy to find</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3449</th>\n","      <td>279126</td>\n","      <td>For the class is it OK?</td>\n","      <td>for the class is it ok</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>502</th>\n","      <td>276174</td>\n","      <td>These guys are making a lot of waves in town. Ryoshi Aka ShibFather is been on the market less than 2 weeks and has already managed to build a strong United community. They’re the real deal bringing fresh content on the daily. This token has lots of potential &amp; could be 100x coin</td>\n","      <td>these guys are making a lot of waves in town ryoshi aka shibfather is been on the market less than weeks and has already managed to build a strong united community they re the real deal bringing fresh content on the daily this token has lots of potential could be x coin</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-177b4921-6887-4634-a170-9879ebf4ceb5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-177b4921-6887-4634-a170-9879ebf4ceb5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-177b4921-6887-4634-a170-9879ebf4ceb5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":80}]},{"cell_type":"code","source":["ans = []\n","for index, row in submition.iterrows():\n","    if row['category_is_bitcoin'] == 1:\n","        ans.append(1)\n","    else:\n","        ans.append(row['class_0_or_class_2'])"],"metadata":{"id":"TaiOUy0eVAL-","executionInfo":{"status":"ok","timestamp":1666210889695,"user_tz":-180,"elapsed":653,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":81,"outputs":[]},{"cell_type":"code","source":["submition['category'] = pd.Series(ans)"],"metadata":{"id":"z5SPYXNfWIyh","executionInfo":{"status":"ok","timestamp":1666210889699,"user_tz":-180,"elapsed":11,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":82,"outputs":[]},{"cell_type":"code","source":["answer_for_only_1_class = submition[['id', 'category']]"],"metadata":{"id":"TRLf_XE5-MDT","executionInfo":{"status":"ok","timestamp":1666210891253,"user_tz":-180,"elapsed":322,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":83,"outputs":[]},{"cell_type":"code","source":["answer_for_only_1_class.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1666210891526,"user_tz":-180,"elapsed":6,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"e2eae9d8-b802-4eaf-e072-e6e38576a093","id":"kvyz-unu-MDT"},"execution_count":84,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       id  category\n","0  275672         0\n","1  275673         0\n","2  275674         0\n","3  275675         0\n","4  275676         0"],"text/html":["\n","  <div id=\"df-017b19cc-fdf5-4fa6-8c90-afbc2169b4ca\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-017b19cc-fdf5-4fa6-8c90-afbc2169b4ca')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-017b19cc-fdf5-4fa6-8c90-afbc2169b4ca button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-017b19cc-fdf5-4fa6-8c90-afbc2169b4ca');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":["answer_for_only_1_class['category'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666210892496,"user_tz":-180,"elapsed":16,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"ffd3957b-b787-40e4-92a4-6b92d1392a39","id":"1hG4WYgp-MDT"},"execution_count":85,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    4620\n","1     913\n","2     394\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":85}]},{"cell_type":"code","source":["answer_for_only_1_class.to_csv(\"ans.csv\", index = False)"],"metadata":{"id":"WNCnTrgw-MDU","executionInfo":{"status":"ok","timestamp":1666210892885,"user_tz":-180,"elapsed":5,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}}},"execution_count":86,"outputs":[]},{"cell_type":"markdown","source":["### CNN"],"metadata":{"id":"92UhQ5RW9pvc"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","X_train, X_test = train_test_split(df , test_size=0.25, random_state=42, shuffle=True)"],"metadata":{"id":"9wImUGz6HfTi"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, df['message']), total=len(df)))\n","\n","df['lemmas'] = lemmas\n","df.sample(10)"],"metadata":{"id":"aCgZ_vlSHLbT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.to_csv(\"data.csv\", index=False)"],"metadata":{"id":"FlAOvruaeq_s"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["root = \"/content/\"\n","filename = \"data.csv\"\n","data = pd.read_csv(root+filename).sample(\n","    frac = 1, random_state = 202)\n","data.head()"],"metadata":{"id":"S9n3md6X8wyU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import spacy\n","import string"],"metadata":{"id":"jIx-iwNE9wvq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#tokenization\n","tok = spacy.load(\"en_core_web_sm\")\n","def tokenize (text):\n","    text = re.sub(r\"[^\\x00-\\x7F]+\", \" \", text)\n","    regex = re.compile('[' + re.escape(string.punctuation) + '0-9\\\\r\\\\t\\\\n]') # remove punctuation and numbers\n","    nopunct = regex.sub(\" \", text.lower())\n","    return [token.text for token in tok.tokenizer(nopunct)]"],"metadata":{"id":"6isxM68u9AQ4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#tokenization\n","def tokenize (text):\n","    try:\n","        return text.split()\n","    except:\n","        return []"],"metadata":{"id":"BUZOVAY97CYP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data.loc[1084]"],"metadata":{"id":"G4vs5ik2UtHo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from collections  import Counter"],"metadata":{"id":"UyIRHzMd-IfV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["counts = Counter()\n","for index, row in data.iterrows():\n","    try:\n","        counts.update(tokenize(row['lemmas']))\n","    except:\n","        pass"],"metadata":{"id":"t34tKVrL9p94"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#deleting infrequent words\n","print(\"num_words before:\",len(counts.keys()))\n","for word in list(counts):\n","    if counts[word] < 2:\n","        del counts[word]\n","print(\"num_words after:\",len(counts.keys()))"],"metadata":{"id":"1VC3ZGwG-ZDF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#creating vocabulary\n","vocab2index = {\"\":0, \"UNK\":1}\n","words = [\"\", \"UNK\"]\n","for word in counts:\n","    vocab2index[word] = len(words)\n","    words.append(word)"],"metadata":{"id":"AZVF9Xyk-guY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def encode_sentence(text, vocab2index, N=40):\n","    tokenized = tokenize(text)\n","    encoded = np.zeros(N, dtype=int)\n","    enc1 = np.array([vocab2index.get(word, vocab2index[\"UNK\"]) for word in tokenized])\n","    length = min(N, len(enc1))\n","    encoded[:length] = enc1[:length]\n","    return encoded, length"],"metadata":{"id":"HTvH7p6l-kgt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data['encoded'] = data['lemmas'].apply(lambda x: np.array(encode_sentence(x,vocab2index)))\n","data.head()"],"metadata":{"id":"HQCV3Evr-n6c"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from torch.utils.data import Dataset\n","import torch"],"metadata":{"id":"cEIJfWIu-5dU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class ReviewsDataset(Dataset):\n","    def __init__(self, X, Y):\n","        self.X = X\n","        self.y = Y\n","        \n","    def __len__(self):\n","        return len(self.X)\n","\n","    def get_labels(self):\n","        return self.y\n","\n","    def __getitem__(self, idx):\n","        if self.y is None:\n","            return torch.from_numpy(self.X[idx][0].astype(np.int32)), 1, self.X[idx][1]\n","        return torch.from_numpy(self.X[idx][0].astype(np.int32)), self.y[idx], self.X[idx][1]"],"metadata":{"id":"Rn87Ro2W-rc3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split"],"metadata":{"id":"YzsIMThs_jxT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import torch\n","import torch.nn as nn\n","import pandas as pd\n","import numpy as np\n","import re\n","import spacy\n","from collections import Counter\n","from torch.utils.data import Dataset, DataLoader\n","import torch.nn.functional as F\n","import string\n","from torch.nn.utils.rnn import pack_padded_sequence, pad_packed_sequence\n","from sklearn.metrics import mean_squared_error"],"metadata":{"id":"6TnPYmm8_1Xb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X = list(data['encoded'])\n","y = list(data['category'])\n","from sklearn.model_selection import train_test_split\n","X_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size=0.2)"],"metadata":{"id":"6F1tVZwwDYDe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_ds = ReviewsDataset(X_train, y_train)\n","valid_ds = ReviewsDataset(X_valid, y_valid)"],"metadata":{"id":"cja8bVZ--36f"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["next(iter(train_ds))"],"metadata":{"id":"wJB72f1VBiSr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def train_model(model, epochs=10, lr=0.001):\n","    parameters = filter(lambda p: p.requires_grad, model.parameters())\n","    optimizer = torch.optim.Adam(parameters, lr=lr)\n","    for i in range(epochs):\n","        model.train()\n","        sum_loss = 0.0\n","        total = 0\n","        for x, y, l in train_dl:\n","            x = x.long()\n","            y = y.long()\n","            y_pred = model(x, l)\n","            optimizer.zero_grad()\n","            loss = F.cross_entropy(y_pred, y)\n","            loss.backward()\n","            optimizer.step()\n","            sum_loss += loss.item()*y.shape[0]\n","            total += y.shape[0]\n","        val_loss, val_acc, val_rmse = validation_metrics(model, val_dl)\n","        if i % 5 == 1:\n","            print(\"train loss %.3f, val loss %.3f, val accuracy %.3f, and val rmse %.3f\" % (sum_loss/total, val_loss, val_acc, val_rmse))\n","\n","def validation_metrics (model, valid_dl):\n","    model.eval()\n","    correct = 0\n","    total = 0\n","    sum_loss = 0.0\n","    sum_rmse = 0.0\n","    for x, y, l in valid_dl:\n","        x = x.long()\n","        y = y.long()\n","        y_hat = model(x, l)\n","        loss = F.cross_entropy(y_hat, y)\n","        pred = torch.max(y_hat, 1)[1]\n","        correct += (pred == y).float().sum()\n","        total += y.shape[0]\n","        sum_loss += loss.item()*y.shape[0]\n","        sum_rmse += np.sqrt(mean_squared_error(pred, y.unsqueeze(-1)))*y.shape[0]\n","    return sum_loss/total, correct/total, sum_rmse/total"],"metadata":{"id":"3lQNueY3_KAx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class LSTM_fixed_len(torch.nn.Module) :\n","    def __init__(self, vocab_size, embedding_dim, hidden_dim) :\n","        super().__init__()\n","        self.embeddings = nn.Embedding(vocab_size, embedding_dim, padding_idx=0)\n","        self.lstm = nn.LSTM(embedding_dim, hidden_dim, batch_first=True)\n","        self.linear = nn.Linear(hidden_dim, 3)\n","        self.dropout = nn.Dropout(0.2)\n","        \n","    def forward(self, x, l):\n","        x = self.embeddings(x)\n","        x = self.dropout(x)\n","        lstm_out, (ht, ct) = self.lstm(x)\n","        return self.linear(ht[-1])"],"metadata":{"id":"MCt9nC8H_nxe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!pip install torchsampler"],"metadata":{"id":"ujhLwjpBGovp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from torchsampler import ImbalancedDatasetSampler\n"],"metadata":{"id":"wjs83i-RG_xJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["batch_size = 1000\n","vocab_size = len(words)\n","train_dl = DataLoader(train_ds, batch_size=batch_size,\n","                      sampler=ImbalancedDatasetSampler(train_ds),)\n","val_dl = DataLoader(valid_ds, batch_size=batch_size)"],"metadata":{"id":"lGkNM_aVBYTw"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# next(iter(train_dl))"],"metadata":{"id":"SRLgW20M-el4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# model_fixed =  LSTM_fixed_len(vocab_size, 50, 100)\n"],"metadata":{"id":"K5aRTlyiBazC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train_model(model_fixed, epochs=30, lr=0.005)\n"],"metadata":{"id":"QD6l6zEj_vH8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Lyduyn4rZjWR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"5Zw2oKl9ZjTy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class CNN(nn.Module):\n","    def __init__(self, vocab_size, embedding_dim, n_filters, filter_sizes, output_dim, dropout_proba):\n","        super().__init__()\n","        \n","        self.embeddings = nn.Embedding(vocab_size, embedding_dim, padding_idx=0)\n","        self.dropout_1 = nn.Dropout(dropout_proba / 2)          \n","        self.conv_0 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[0], embedding_dim))\n","        self.conv_1 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[1], embedding_dim))\n","        self.conv_2 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[2], embedding_dim))\n","        self.fc = nn.Linear(len(filter_sizes) * n_filters, output_dim)\n","        self.dropout_2 = nn.Dropout(dropout_proba)        \n","    def forward(self, x):\n","        #x = [sent len, batch size]\n","        # x = x.permute(1, 0)\n","                \n","        #x = [batch size, sent len]\n","        embedded = self.embeddings(x)\n","                \n","        #embedded = [batch size, sent len, emb dim]\n","        embedded = embedded.unsqueeze(1)\n","        embedded = self.dropout_1(embedded)\n","        \n","        #embedded = [batch size, 1, sent len, emb dim]\n","        conved_0 = F.relu(self.conv_0(embedded).squeeze(3))\n","        conved_1 = F.relu(self.conv_1(embedded).squeeze(3))\n","        conved_2 = F.relu(self.conv_2(embedded).squeeze(3))\n","            \n","        #conv_n = [batch size, n_filters, sent len - filter_sizes[n]]\n","        pooled_0 = F.max_pool1d(conved_0, conved_0.shape[2]).squeeze(2)\n","        pooled_1 = F.max_pool1d(conved_1, conved_1.shape[2]).squeeze(2)\n","        pooled_2 = F.max_pool1d(conved_2, conved_2.shape[2]).squeeze(2)\n","        \n","        #pooled_n = [batch size, n_filters]\n","        cat = self.dropout_2(torch.cat((pooled_0, pooled_1, pooled_2), dim=1))\n","\n","        #cat = [batch size, n_filters * len(filter_sizes)]\n","        return self.fc(cat)"],"metadata":{"id":"gRtjJegTZjRc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["INPUT_DIM = len(words)\n","EMBEDDING_DIM = 100\n","N_FILTERS = 100\n","FILTER_SIZES = [3,4,5]\n","OUTPUT_DIM = 3\n","DROPOUT_PROBA = 0.4"],"metadata":{"id":"hdvAJ15HabqU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def train_model(model, epochs=10, lr=0.001):\n","    parameters = filter(lambda p: p.requires_grad, model.parameters())\n","    optimizer = torch.optim.Adam(parameters, lr=lr, weight_decay=1e-3)\n","    for i in range(epochs):\n","        model.train()\n","        sum_loss = 0.0\n","        total = 0\n","        for x, y, l in train_dl:\n","            x = x.long()\n","            y = y.long()\n","            optimizer.zero_grad()\n","            y_pred = model(x).squeeze(1)[:y.shape[0]]\n","            loss = F.cross_entropy(y_pred, y)\n","            loss.backward()\n","            optimizer.step()\n","            sum_loss += loss.item()*y.shape[0]\n","            total += y.shape[0]\n","        val_loss, val_acc = validation_metrics(model, val_dl)\n","        if i % 5 == 1:\n","            print(\"train loss %.3f, val loss %.3f, val accuracy %.3f\" % (sum_loss/total, val_loss, val_acc))\n","\n","def validation_metrics (model, valid_dl):\n","    model.eval()\n","    sum_loss = 0.0\n","    correct = 0\n","    total = 0\n","    with torch.no_grad():\n","        for x, y, l in valid_dl:\n","            x = x.long()\n","            y = y.long()\n","            y_hat = model(x).squeeze(1)[:y.shape[0]]\n","            loss = F.cross_entropy(y_hat, y)\n","            pred = torch.max(y_hat, 1)[1]\n","            correct += (pred == y).float().sum()\n","            total += y.shape[0]\n","            sum_loss += loss.item()*y.shape[0]\n","    return sum_loss/total, correct/total, \n","\n"],"metadata":{"id":"NMyWUx55Z8hk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = CNN(INPUT_DIM, EMBEDDING_DIM, N_FILTERS, FILTER_SIZES, OUTPUT_DIM, DROPOUT_PROBA)"],"metadata":{"id":"SYSkqGaE_QTp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_model(model, epochs=60, lr=0.005)"],"metadata":{"id":"nl6RzVDLau0j"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["embedded"],"metadata":{"id":"0fMl3KY39-km"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# 1"],"metadata":{"id":"tK443_qGEePA"}},{"cell_type":"code","source":[],"metadata":{"id":"oR8wZA2vCxrg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition = pd.read_csv('test_data.csv')"],"metadata":{"id":"zKjARS7373nQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1666009896617,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"4bf849bf-5e29-4794-d2ec-869463719826","id":"hBNtwHKX73nQ"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ... \n","2      275674                                                                                                                               Vladimir, when will we have seminar?\n","3      275675                                                                                                                                              A couple at 111, too?\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:\n","...       ...                                                                                                                                                                ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc: \n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.\n","\n","[5927 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-85461078-4596-45e8-bc63-cf4636dc9848\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-85461078-4596-45e8-bc63-cf4636dc9848')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-85461078-4596-45e8-bc63-cf4636dc9848 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-85461078-4596-45e8-bc63-cf4636dc9848');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":85}]},{"cell_type":"code","source":["submition['encoded'] = submition['message'].apply(lambda x: np.array(encode_sentence(x,vocab2index )))\n","submition.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":263},"id":"tDbN-PV6EgC6","executionInfo":{"status":"ok","timestamp":1666009898583,"user_tz":-180,"elapsed":7,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"4d4e4122-6fe1-4c5e-e3aa-d64ccd95d7c8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n","  \"\"\"Entry point for launching an IPython kernel.\n"]},{"output_type":"execute_result","data":{"text/plain":["       id                                             message                                                                                                                                        encoded\n","0  275672        But a lot of people have a job fair tonight.   [[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]\n","1  275673  Also, I got only 4 answers on the google form ...   [[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]\n","2  275674                Vladimir, when will we have seminar?          [[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]\n","3  275675                               A couple at 111, too?              [[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]\n","4  275676               It's on Anti-buying. And again, Zara:                 [[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]"],"text/html":["\n","  <div id=\"df-a87c37b8-19e3-44a4-aaf1-e50a71c542aa\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a87c37b8-19e3-44a4-aaf1-e50a71c542aa')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a87c37b8-19e3-44a4-aaf1-e50a71c542aa button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a87c37b8-19e3-44a4-aaf1-e50a71c542aa');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":86}]},{"cell_type":"code","source":["len(submition)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vIy3Q3HXIsZJ","executionInfo":{"status":"ok","timestamp":1666009900194,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"3e00e8ae-6194-4fe9-fc05-215007beff8d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["5927"]},"metadata":{},"execution_count":87}]},{"cell_type":"code","source":["submition.loc[0]['encoded'][1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1XmYvrpdE4sX","executionInfo":{"status":"ok","timestamp":1666009900684,"user_tz":-180,"elapsed":1,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"a543750e-01ac-42f7-cdba-0e109b7bd814"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["10"]},"metadata":{},"execution_count":88}]},{"cell_type":"code","source":["X_ = list(submition['encoded'])\n","y_ = None"],"metadata":{"id":"MmvnYvsmFbDj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_ds = ReviewsDataset(X_, y_)"],"metadata":{"id":"pihh7qiNE5pg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_dl = DataLoader(test_ds, batch_size=batch_size)"],"metadata":{"id":"84nmn5wqHAS1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["next(iter(test_ds))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uIbCCNyEFj1H","executionInfo":{"status":"ok","timestamp":1666009905016,"user_tz":-180,"elapsed":3,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"9a676bc8-2905-451d-b722-40f07d1a1b16"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(tensor([   1,   33,  456,    5,  286,  365,   33, 2070, 2084,    1,    0,    0,\n","            0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,\n","            0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,\n","            0,    0,    0,    0], dtype=torch.int32), 1, 10)"]},"metadata":{},"execution_count":92}]},{"cell_type":"code","source":["model.eval()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8lsdGP2kG6wz","executionInfo":{"status":"ok","timestamp":1666009907206,"user_tz":-180,"elapsed":2,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"5b0f89d7-4969-4f26-b938-bdb776474269"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["CNN(\n","  (embeddings): Embedding(16042, 100, padding_idx=0)\n","  (dropout_1): Dropout(p=0.2, inplace=False)\n","  (conv_0): Conv2d(1, 100, kernel_size=(3, 100), stride=(1, 1))\n","  (conv_1): Conv2d(1, 100, kernel_size=(4, 100), stride=(1, 1))\n","  (conv_2): Conv2d(1, 100, kernel_size=(5, 100), stride=(1, 1))\n","  (fc): Linear(in_features=300, out_features=3, bias=True)\n","  (dropout_2): Dropout(p=0.4, inplace=False)\n",")"]},"metadata":{},"execution_count":93}]},{"cell_type":"code","source":["ans = pd.Series()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mFyC_r4HH4Pf","executionInfo":{"status":"ok","timestamp":1666009909134,"user_tz":-180,"elapsed":576,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"1e601562-4c79-4d43-9cdf-53cee998624f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.\n","  \"\"\"Entry point for launching an IPython kernel.\n"]}]},{"cell_type":"code","source":["for x, _, l in test_dl:\n","    x = x.long()\n","    y_pred = model(x)\n","    pred = torch.max(y_pred, 1)[1]\n","    ans = pd.concat([ans, pd.Series(pred)])"],"metadata":{"id":"9kB-7v5jGBf_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred = torch.max(y_pred, 1)[1]"],"metadata":{"id":"UQu0mtudHH4i"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["ans"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oFGB02W5Jr_H","executionInfo":{"status":"ok","timestamp":1666009915329,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"8de5e531-319d-47eb-89f3-bc1f0dd2aab0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0      2\n","1      0\n","2      0\n","3      0\n","4      0\n","      ..\n","922    0\n","923    0\n","924    0\n","925    2\n","926    0\n","Length: 5927, dtype: int64"]},"metadata":{},"execution_count":97}]},{"cell_type":"code","source":["submition"],"metadata":{"id":"1gtxiq4RLQ9n","colab":{"base_uri":"https://localhost:8080/","height":641},"executionInfo":{"status":"ok","timestamp":1666009916558,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"144f0cf9-0753-4cc7-a5c6-6cb84454cd1c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message                                                                                                                                                          encoded\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.                     [[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ...                     [[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]\n","2      275674                                                                                                                               Vladimir, when will we have seminar?                            [[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]\n","3      275675                                                                                                                                              A couple at 111, too?                                [[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:                                   [[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]\n","...       ...                                                                                                                                                                ...                                                                                                                                                              ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc:               [[1, 1213, 1, 566, 316, 4141, 56, 2956, 321, 4312, 41, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]\n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?                                   [[1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.                [[1, 23, 33, 479, 10675, 1491, 32, 78, 14, 6, 1, 1, 73, 6, 231, 282, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.  [[1, 152, 1, 1, 2732, 56, 200, 33, 2450, 5, 33, 1, 1, 73, 33, 4445, 1493, 1, 1, 1, 23, 4133, 1, 28, 1, 4449, 544, 45, 1, 56, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.                                [[1, 17, 1, 365, 24, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]\n","\n","[5927 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-b06ef589-1c27-4bbf-954f-1f0b6fd7d176\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","      <td>[[1, 1213, 1, 566, 316, 4141, 56, 2956, 321, 4312, 41, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","      <td>[[1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","      <td>[[1, 23, 33, 479, 10675, 1491, 32, 78, 14, 6, 1, 1, 73, 6, 231, 282, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","      <td>[[1, 152, 1, 1, 2732, 56, 200, 33, 2450, 5, 33, 1, 1, 73, 33, 4445, 1493, 1, 1, 1, 23, 4133, 1, 28, 1, 4449, 544, 45, 1, 56, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","      <td>[[1, 17, 1, 365, 24, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b06ef589-1c27-4bbf-954f-1f0b6fd7d176')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b06ef589-1c27-4bbf-954f-1f0b6fd7d176 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b06ef589-1c27-4bbf-954f-1f0b6fd7d176');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":98}]},{"cell_type":"code","source":["submition['category'] = ans.to_list()"],"metadata":{"id":"7JCLHYQ_KKwI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":641},"id":"W7-EqEIhLOnO","executionInfo":{"status":"ok","timestamp":1666009918791,"user_tz":-180,"elapsed":7,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"b7a610c3-8563-4c8d-b747-24b4ca587d79"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message                                                                                                                                                          encoded  category\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.                     [[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]         2\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ...                     [[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]         0\n","2      275674                                                                                                                               Vladimir, when will we have seminar?                            [[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]         0\n","3      275675                                                                                                                                              A couple at 111, too?                                [[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]         0\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:                                   [[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]         0\n","...       ...                                                                                                                                                                ...                                                                                                                                                              ...       ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc:               [[1, 1213, 1, 566, 316, 4141, 56, 2956, 321, 4312, 41, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]         0\n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?                                   [[1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]         0\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.                [[1, 23, 33, 479, 10675, 1491, 32, 78, 14, 6, 1, 1, 73, 6, 231, 282, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]         0\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.  [[1, 152, 1, 1, 2732, 56, 200, 33, 2450, 5, 33, 1, 1, 73, 33, 4445, 1493, 1, 1, 1, 23, 4133, 1, 28, 1, 4449, 544, 45, 1, 56, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]         2\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.                                [[1, 17, 1, 365, 24, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]         0\n","\n","[5927 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-dea3ca87-634d-49f0-a51f-72f686bb906d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 33, 456, 5, 286, 365, 33, 2070, 2084, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 1063, 338, 1, 2827, 14, 6, 1245, 1997, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 322, 137, 249, 365, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1056, 37, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 14, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","      <td>[[1, 1213, 1, 566, 316, 4141, 56, 2956, 321, 4312, 41, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","      <td>[[1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","      <td>[[1, 23, 33, 479, 10675, 1491, 32, 78, 14, 6, 1, 1, 73, 6, 231, 282, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","      <td>[[1, 152, 1, 1, 2732, 56, 200, 33, 2450, 5, 33, 1, 1, 73, 33, 4445, 1493, 1, 1, 1, 23, 4133, 1, 28, 1, 4449, 544, 45, 1, 56, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","      <td>[[1, 17, 1, 365, 24, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dea3ca87-634d-49f0-a51f-72f686bb906d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dea3ca87-634d-49f0-a51f-72f686bb906d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dea3ca87-634d-49f0-a51f-72f686bb906d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":100}]},{"cell_type":"code","source":[],"metadata":{"id":"sT0TQPzzLcmy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["answer = submition[['id', 'category']]"],"metadata":{"id":"Jp5kFONX73nU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["answer.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1666009921294,"user_tz":-180,"elapsed":9,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"29b76a7f-d362-4c61-c86e-25e852d40085","id":"QQ2jScKb73nU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       id  category\n","0  275672         2\n","1  275673         0\n","2  275674         0\n","3  275675         0\n","4  275676         0"],"text/html":["\n","  <div id=\"df-6ec89632-77f6-44b7-b9bb-cf8bbe257718\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6ec89632-77f6-44b7-b9bb-cf8bbe257718')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6ec89632-77f6-44b7-b9bb-cf8bbe257718 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6ec89632-77f6-44b7-b9bb-cf8bbe257718');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":102}]},{"cell_type":"code","source":["answer['category'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Pg19HitF7gDt","executionInfo":{"status":"ok","timestamp":1666009927552,"user_tz":-180,"elapsed":6,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"24cedff1-57e7-44e5-c647-be6d5718051e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    4080\n","2    1327\n","1     520\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":103}]},{"cell_type":"code","source":["answer['category'].value_counts()"],"metadata":{"id":"ecHiG4WBbcnH","executionInfo":{"status":"ok","timestamp":1665951191349,"user_tz":-180,"elapsed":260,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"cdb71839-0300-4f03-caa5-feb89594c85c","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    3838\n","2    1448\n","1     641\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":160}]},{"cell_type":"code","source":["answer['category'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665941688843,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"901df430-3098-44c5-f13b-753dc6cb86ec","id":"IGKAsrrS73nU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    2789\n","2    2648\n","1     490\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":210}]},{"cell_type":"code","source":["answer.to_csv(\"submission.csv\", index = False)"],"metadata":{"id":"mOoR2vAc73nU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"QCj1_ad5Lqf3"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["https://jovian.ai/aakanksha-ns/lstm-multiclass-text-classification/v/5?utm_source=embed"],"metadata":{"id":"fmdH4VldL-pw"}},{"cell_type":"code","source":["answer[answer['id'] == 275901]"],"metadata":{"id":"gsW4fPfRL-5F","colab":{"base_uri":"https://localhost:8080/","height":81},"executionInfo":{"status":"ok","timestamp":1665915077739,"user_tz":-180,"elapsed":7,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"f8e4be07-5b0e-4310-a0e4-94961f1ff43f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         id  category\n","229  275901         0"],"text/html":["\n","  <div id=\"df-e58d20a1-6a81-4ed3-b1ac-555abaae68fc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>229</th>\n","      <td>275901</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e58d20a1-6a81-4ed3-b1ac-555abaae68fc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e58d20a1-6a81-4ed3-b1ac-555abaae68fc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e58d20a1-6a81-4ed3-b1ac-555abaae68fc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":294}]},{"cell_type":"code","source":[],"metadata":{"id":"1qA8cfX_OlXy"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# NEW_data"],"metadata":{"id":"Nt2jpc7Tsads"}},{"cell_type":"code","source":["import pandas as pd"],"metadata":{"id":"y7KwNOSoFX_i"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df = pd.read_json('/content/News_Category_Dataset_v3.json', lines=True)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"eyKeWkGtscw-","executionInfo":{"status":"ok","timestamp":1666007770966,"user_tz":-180,"elapsed":1957,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"cf83435b-9d66-49ed-e542-d82d0071adbc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                link  \\\n","0  https://www.huffpost.com/entry/covid-boosters-...   \n","1  https://www.huffpost.com/entry/american-airlin...   \n","2  https://www.huffpost.com/entry/funniest-tweets...   \n","3  https://www.huffpost.com/entry/funniest-parent...   \n","4  https://www.huffpost.com/entry/amy-cooper-lose...   \n","\n","                                            headline   category  \\\n","0  Over 4 Million Americans Roll Up Sleeves For O...  U.S. NEWS   \n","1  American Airlines Flyer Charged, Banned For Li...  U.S. NEWS   \n","2  23 Of The Funniest Tweets About Cats And Dogs ...     COMEDY   \n","3  The Funniest Tweets From Parents This Week (Se...  PARENTING   \n","4  Woman Who Called Cops On Black Bird-Watcher Lo...  U.S. NEWS   \n","\n","                                   short_description               authors  \\\n","0  Health experts said it is too early to predict...  Carla K. Johnson, AP   \n","1  He was subdued by passengers and crew when he ...        Mary Papenfuss   \n","2  \"Until you have a dog you don't understand wha...         Elyse Wanshel   \n","3  \"Accidentally put grown-up toothpaste on my to...      Caroline Bologna   \n","4  Amy Cooper accused investment firm Franklin Te...        Nina Golgowski   \n","\n","        date  \n","0 2022-09-23  \n","1 2022-09-23  \n","2 2022-09-23  \n","3 2022-09-23  \n","4 2022-09-22  "],"text/html":["\n","  <div id=\"df-0743d6c6-b810-4e11-8041-61d4bc153966\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>link</th>\n","      <th>headline</th>\n","      <th>category</th>\n","      <th>short_description</th>\n","      <th>authors</th>\n","      <th>date</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>https://www.huffpost.com/entry/covid-boosters-...</td>\n","      <td>Over 4 Million Americans Roll Up Sleeves For O...</td>\n","      <td>U.S. NEWS</td>\n","      <td>Health experts said it is too early to predict...</td>\n","      <td>Carla K. Johnson, AP</td>\n","      <td>2022-09-23</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>https://www.huffpost.com/entry/american-airlin...</td>\n","      <td>American Airlines Flyer Charged, Banned For Li...</td>\n","      <td>U.S. NEWS</td>\n","      <td>He was subdued by passengers and crew when he ...</td>\n","      <td>Mary Papenfuss</td>\n","      <td>2022-09-23</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>https://www.huffpost.com/entry/funniest-tweets...</td>\n","      <td>23 Of The Funniest Tweets About Cats And Dogs ...</td>\n","      <td>COMEDY</td>\n","      <td>\"Until you have a dog you don't understand wha...</td>\n","      <td>Elyse Wanshel</td>\n","      <td>2022-09-23</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>https://www.huffpost.com/entry/funniest-parent...</td>\n","      <td>The Funniest Tweets From Parents This Week (Se...</td>\n","      <td>PARENTING</td>\n","      <td>\"Accidentally put grown-up toothpaste on my to...</td>\n","      <td>Caroline Bologna</td>\n","      <td>2022-09-23</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>https://www.huffpost.com/entry/amy-cooper-lose...</td>\n","      <td>Woman Who Called Cops On Black Bird-Watcher Lo...</td>\n","      <td>U.S. NEWS</td>\n","      <td>Amy Cooper accused investment firm Franklin Te...</td>\n","      <td>Nina Golgowski</td>\n","      <td>2022-09-22</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0743d6c6-b810-4e11-8041-61d4bc153966')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0743d6c6-b810-4e11-8041-61d4bc153966 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0743d6c6-b810-4e11-8041-61d4bc153966');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["df.category.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9DJ9CIM5tfPj","executionInfo":{"status":"ok","timestamp":1666007773373,"user_tz":-180,"elapsed":311,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"b7db6167-d5cc-45dc-ed45-515cfded9646"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["POLITICS          35602\n","WELLNESS          17945\n","ENTERTAINMENT     17362\n","TRAVEL             9900\n","STYLE & BEAUTY     9814\n","PARENTING          8791\n","HEALTHY LIVING     6694\n","QUEER VOICES       6347\n","FOOD & DRINK       6340\n","BUSINESS           5992\n","COMEDY             5400\n","SPORTS             5077\n","BLACK VOICES       4583\n","HOME & LIVING      4320\n","PARENTS            3955\n","THE WORLDPOST      3664\n","WEDDINGS           3653\n","WOMEN              3572\n","CRIME              3562\n","IMPACT             3484\n","DIVORCE            3426\n","WORLD NEWS         3299\n","MEDIA              2944\n","WEIRD NEWS         2777\n","GREEN              2622\n","WORLDPOST          2579\n","RELIGION           2577\n","STYLE              2254\n","SCIENCE            2206\n","TECH               2104\n","TASTE              2096\n","MONEY              1756\n","ARTS               1509\n","ENVIRONMENT        1444\n","FIFTY              1401\n","GOOD NEWS          1398\n","U.S. NEWS          1377\n","ARTS & CULTURE     1339\n","COLLEGE            1144\n","LATINO VOICES      1130\n","CULTURE & ARTS     1074\n","EDUCATION          1014\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["new_data = df[df['category'] == 'STYLE & BEAUTY'].short_description\n","categoty = pd.Series([2 for i in range(len(new_data))])"],"metadata":{"id":"VwtA1Gnztk8d"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["new_data = pd.DataFrame(new_data).reset_index()"],"metadata":{"id":"4PxmC7cWtxsM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["new_data['category'] = pd.Series([2 for i in range(len(new_data))])"],"metadata":{"id":"bfh3ZuT3uGNL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["new_data =new_data.drop('index', axis=1)"],"metadata":{"id":"xjvALW_1uoWl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(new_data)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2aPV9i5nup6m","executionInfo":{"status":"ok","timestamp":1666007775672,"user_tz":-180,"elapsed":5,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"3dab4d09-f7d7-4290-b0f1-2525ea25fed3"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["9814"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["new_data"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"p5AZinEAusPn","executionInfo":{"status":"ok","timestamp":1666007777460,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"1b0dbdf8-724b-4751-c3eb-4b2412412392"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                      short_description  category\n","0     Quick solutions to fix your farmer’s tan, from...         2\n","1     Jell-O is bouncy, jiggly and always snaps back...         2\n","2     Here's what to order now so you'll be itch-fre...         2\n","3     Ditch the discomfort down there with these der...         2\n","4     Experts explain the signs of melanoma to look ...         2\n","...                                                 ...       ...\n","9809  Camila Alves' style is proof that you don't ha...         2\n","9810  From De Lune: Another beautiful day here in NY...         2\n","9811  From Refinery29: When we tell you Lily Kwong i...         2\n","9812  WHAT: Two of the fashion industry's most styli...         2\n","9813  \"A Look Back\" is a daily column that highlight...         2\n","\n","[9814 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-29a692e7-892e-4829-9146-d3d35bf74c20\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>short_description</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Quick solutions to fix your farmer’s tan, from...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Jell-O is bouncy, jiggly and always snaps back...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Here's what to order now so you'll be itch-fre...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Ditch the discomfort down there with these der...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Experts explain the signs of melanoma to look ...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9809</th>\n","      <td>Camila Alves' style is proof that you don't ha...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9810</th>\n","      <td>From De Lune: Another beautiful day here in NY...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9811</th>\n","      <td>From Refinery29: When we tell you Lily Kwong i...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9812</th>\n","      <td>WHAT: Two of the fashion industry's most styli...</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9813</th>\n","      <td>\"A Look Back\" is a daily column that highlight...</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9814 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-29a692e7-892e-4829-9146-d3d35bf74c20')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-29a692e7-892e-4829-9146-d3d35bf74c20 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-29a692e7-892e-4829-9146-d3d35bf74c20');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["new_data.to_csv('new_data_fashion.csv')"],"metadata":{"id":"uDdGXSGAvlnV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"hr5303cTw6ds"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":[],"metadata":{"id":"fRh3Wn8URs1D"}},{"cell_type":"markdown","source":["# CNN"],"metadata":{"id":"KWPQJcfwRtR4"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","X_train, X_test = train_test_split(df , test_size=0.25, random_state=42, shuffle=True)"],"metadata":{"id":"Xl5eCb9RRtR5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, df['message']), total=len(df)))\n","\n","df['lemmas'] = lemmas\n","df.sample(10)"],"metadata":{"id":"5xfkmMZ9RtR5","colab":{"base_uri":"https://localhost:8080/","height":598,"referenced_widgets":["9fc90fab9c6441bea258f357842baaed","3c99466fdd1f4a188339a87f2520536c","a5f8b4db9ba647d0b03be473c568371c","f61715b79bfb4d709203793dc05ca358","71e1f08201f846aaa9ebf61ccdcc5930","9a167157f6284724921ad90710b7910d","1e867ba54bed4b9b801d9fbc6cdd84d9","47c99e3e4a4b4e8e826a44f38c0660e4","6d9c73019cdd45f28e9f8f09b2d69183","1edeab21663b449d86c4a5f6757d5d69","0a8ed0cc33244d13b67b9c7c0331ea55"]},"executionInfo":{"status":"ok","timestamp":1666089508205,"user_tz":-180,"elapsed":20897,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"9ef58b1d-1da3-4043-9152-fea968afb6a9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/22447 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9fc90fab9c6441bea258f357842baaed"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                                       message  category                                                                                                                                                                                                                              lemmas\n","2641                                                                                                                                                      And what's stopping you from chatting with your friends at the level of a cabal too?         0                                                                                                                                                 and what s stopping you from chatting with your friends at the level of a cabal too\n","4307                                                                                                                                                                                                 Testing in big4, even something like this         0                                                                                                                                                                                             testing in big even something like this\n","3140                                                                                                                                                                                           how many kidneys for a knife, you have to give?         0                                                                                                                                                                                       how many kidneys for a knife you have to give\n","4759  When considering bunionplasty, it is important to not only consider how the foot will look but also how it will function.   Take the time to learn about the methods available to fix your bunion, and you will be that much better off.         2  when considering bunionplasty it is important to not only consider how the foot will look but also how it will function take the time to learn about the methods available to fix your bunion and you will be that much better off\n","7585                                                                                                                 Boden Polo, American Apparel Skirt, Cole Haan Wristlet, Hue Knee Socks, Marc by Marc Jacobs Loafers Want more? Be sure to         2                                                                                                                boden polo american apparel skirt cole haan wristlet hue knee socks marc by marc jacobs loafers want more be sure to\n","4944                                                                                                                                                                                                                     This model thinks so.         2                                                                                                                                                                                                                this model thinks so\n","1008                                                                                                                 See the rest of the red carpet glam: Jennifer Lawrence is the darling of Hollywood, the cool girl guys want to date (even         2                                                                                                            see the rest of the red carpet glam: jennifer lawrence is the darling of hollywood the cool girl guys want to date (even\n","330                                                                                                                  I'm sitting here rubbing my hands, waiting for the loreal to give me a percentage of the sales, because I'm worthy of it.         2                                                                                                              i m sitting here rubbing my hands waiting for the loreal to give me a percentage of the sales because i m worthy of it\n","7845                                                                                                                 Check out Kanye's fashion rants below to see what else got the official style thumbs-down from the A-list rapper. When we         2                                                                                                            check out kanye s fashion rants below to see what else got the official style thumbs down from the a list rapper when we\n","5036                                                                                                                                                                                                I found a full chapman in my jacket pocket         0                                                                                                                                                                                          i found a full chapman in my jacket pocket"],"text/html":["\n","  <div id=\"df-c75a572e-ab78-4561-8f70-7b9450394ed1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2641</th>\n","      <td>And what's stopping you from chatting with your friends at the level of a cabal too?</td>\n","      <td>0</td>\n","      <td>and what s stopping you from chatting with your friends at the level of a cabal too</td>\n","    </tr>\n","    <tr>\n","      <th>4307</th>\n","      <td>Testing in big4, even something like this</td>\n","      <td>0</td>\n","      <td>testing in big even something like this</td>\n","    </tr>\n","    <tr>\n","      <th>3140</th>\n","      <td>how many kidneys for a knife, you have to give?</td>\n","      <td>0</td>\n","      <td>how many kidneys for a knife you have to give</td>\n","    </tr>\n","    <tr>\n","      <th>4759</th>\n","      <td>When considering bunionplasty, it is important to not only consider how the foot will look but also how it will function.   Take the time to learn about the methods available to fix your bunion, and you will be that much better off.</td>\n","      <td>2</td>\n","      <td>when considering bunionplasty it is important to not only consider how the foot will look but also how it will function take the time to learn about the methods available to fix your bunion and you will be that much better off</td>\n","    </tr>\n","    <tr>\n","      <th>7585</th>\n","      <td>Boden Polo, American Apparel Skirt, Cole Haan Wristlet, Hue Knee Socks, Marc by Marc Jacobs Loafers Want more? Be sure to</td>\n","      <td>2</td>\n","      <td>boden polo american apparel skirt cole haan wristlet hue knee socks marc by marc jacobs loafers want more be sure to</td>\n","    </tr>\n","    <tr>\n","      <th>4944</th>\n","      <td>This model thinks so.</td>\n","      <td>2</td>\n","      <td>this model thinks so</td>\n","    </tr>\n","    <tr>\n","      <th>1008</th>\n","      <td>See the rest of the red carpet glam: Jennifer Lawrence is the darling of Hollywood, the cool girl guys want to date (even</td>\n","      <td>2</td>\n","      <td>see the rest of the red carpet glam: jennifer lawrence is the darling of hollywood the cool girl guys want to date (even</td>\n","    </tr>\n","    <tr>\n","      <th>330</th>\n","      <td>I'm sitting here rubbing my hands, waiting for the loreal to give me a percentage of the sales, because I'm worthy of it.</td>\n","      <td>2</td>\n","      <td>i m sitting here rubbing my hands waiting for the loreal to give me a percentage of the sales because i m worthy of it</td>\n","    </tr>\n","    <tr>\n","      <th>7845</th>\n","      <td>Check out Kanye's fashion rants below to see what else got the official style thumbs-down from the A-list rapper. When we</td>\n","      <td>2</td>\n","      <td>check out kanye s fashion rants below to see what else got the official style thumbs down from the a list rapper when we</td>\n","    </tr>\n","    <tr>\n","      <th>5036</th>\n","      <td>I found a full chapman in my jacket pocket</td>\n","      <td>0</td>\n","      <td>i found a full chapman in my jacket pocket</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c75a572e-ab78-4561-8f70-7b9450394ed1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c75a572e-ab78-4561-8f70-7b9450394ed1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c75a572e-ab78-4561-8f70-7b9450394ed1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":197}]},{"cell_type":"code","source":["df['category'] = df['category'].apply(lambda x: 1 if x == 2 else 0)"],"metadata":{"id":"7mYeqsJKp0xr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.to_csv(\"data.csv\", index=False)"],"metadata":{"id":"WXoc_j_BRtR6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["root = \"/content/\"\n","filename = \"data.csv\"\n","data = pd.read_csv(root+filename).sample(\n","    frac = 1, random_state = 202)\n","data.head()"],"metadata":{"id":"BiDZRKSnRtR7","colab":{"base_uri":"https://localhost:8080/","height":372},"executionInfo":{"status":"ok","timestamp":1666089548126,"user_tz":-180,"elapsed":14,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"4308ac00-984e-4b4d-a327-22f3854a126c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                            message  category                                                                                                                                                                                                             lemmas\n","4980                  Let me say at the beginning of this article that I like my face, but that I do intend to get a facelift some day in the future. The older I get the more I'm thinking about it; it's on the list so to speak.         1          let me say at the beginning of this article that i like my face but that i do intend to get a facelift some day in the future the older i get the more i m thinking about it it s on the list so to speak\n","12365                                                                                                We were envious when we first saw the images of Gwyneth Paltrow in the February issue of Harper's Bazaar. The blonde bombshell         1                                                                                      we were envious when we first saw the images of gwyneth paltrow in the february issue of harper s bazaar the blonde bombshell\n","4249                                                                                                   Joan Rivers can dish it, but she sure can't take it. Following Jennifer Lawrence's derogatory comments about \"Fashion Police         1                                                                                          joan rivers can dish it but she sure can t take it following jennifer lawrence s derogatory comments about fashion police\n","9417                                                                                                       See Heidi Klum's Style Evolution here. WHO: German supermogul Heidi Klum Fame Flynet Photo Shop a similar look below and         1                                                                                            see heidi klum s style evolution here who: german supermogul heidi klum fame flynet photo shop a similar look below and\n","5744   She would find the one leather craftsman in Florence making a copy of a $2,000 French purse, and she would carry that Florentine bag, tucked away lovingly into its fabric-carrying sack at night, for the rest of her life.         1  she would find the one leather craftsman in florence making a copy of a french purse and she would carry that florentine bag tucked away lovingly into its fabric carrying sack at night for the rest of her life"],"text/html":["\n","  <div id=\"df-a23be00e-2377-4653-8749-07234d154ab8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4980</th>\n","      <td>Let me say at the beginning of this article that I like my face, but that I do intend to get a facelift some day in the future. The older I get the more I'm thinking about it; it's on the list so to speak.</td>\n","      <td>1</td>\n","      <td>let me say at the beginning of this article that i like my face but that i do intend to get a facelift some day in the future the older i get the more i m thinking about it it s on the list so to speak</td>\n","    </tr>\n","    <tr>\n","      <th>12365</th>\n","      <td>We were envious when we first saw the images of Gwyneth Paltrow in the February issue of Harper's Bazaar. The blonde bombshell</td>\n","      <td>1</td>\n","      <td>we were envious when we first saw the images of gwyneth paltrow in the february issue of harper s bazaar the blonde bombshell</td>\n","    </tr>\n","    <tr>\n","      <th>4249</th>\n","      <td>Joan Rivers can dish it, but she sure can't take it. Following Jennifer Lawrence's derogatory comments about \"Fashion Police</td>\n","      <td>1</td>\n","      <td>joan rivers can dish it but she sure can t take it following jennifer lawrence s derogatory comments about fashion police</td>\n","    </tr>\n","    <tr>\n","      <th>9417</th>\n","      <td>See Heidi Klum's Style Evolution here. WHO: German supermogul Heidi Klum Fame Flynet Photo Shop a similar look below and</td>\n","      <td>1</td>\n","      <td>see heidi klum s style evolution here who: german supermogul heidi klum fame flynet photo shop a similar look below and</td>\n","    </tr>\n","    <tr>\n","      <th>5744</th>\n","      <td>She would find the one leather craftsman in Florence making a copy of a $2,000 French purse, and she would carry that Florentine bag, tucked away lovingly into its fabric-carrying sack at night, for the rest of her life.</td>\n","      <td>1</td>\n","      <td>she would find the one leather craftsman in florence making a copy of a french purse and she would carry that florentine bag tucked away lovingly into its fabric carrying sack at night for the rest of her life</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a23be00e-2377-4653-8749-07234d154ab8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a23be00e-2377-4653-8749-07234d154ab8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a23be00e-2377-4653-8749-07234d154ab8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":200}]},{"cell_type":"code","source":["import spacy\n","import string"],"metadata":{"id":"hjK-DInKRtR7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#tokenization\n","tok = spacy.load(\"en_core_web_sm\")\n","def tokenize (text):\n","    text = re.sub(r\"[^\\x00-\\x7F]+\", \" \", text)\n","    regex = re.compile('[' + re.escape(string.punctuation) + '0-9\\\\r\\\\t\\\\n]') # remove punctuation and numbers\n","    nopunct = regex.sub(\" \", text.lower())\n","    return [token.text for token in tok.tokenizer(nopunct)]"],"metadata":{"id":"Vb1HAzm8RtR8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#tokenization\n","def tokenize (text):\n","    try:\n","        return text.split()\n","    except:\n","        return []"],"metadata":{"id":"NzpMJnYJRtR9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data.loc[1084]"],"metadata":{"id":"C1O8LFduRtR9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666089567461,"user_tz":-180,"elapsed":4,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"4f8404e0-8afb-4a40-cb46-f9ba9c1c0a15"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["message     Assistant\n","category            1\n","lemmas      assistant\n","Name: 1084, dtype: object"]},"metadata":{},"execution_count":205}]},{"cell_type":"code","source":["from collections  import Counter"],"metadata":{"id":"8EfWirCKRtR-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["counts = Counter()\n","for index, row in data.iterrows():\n","    try:\n","        counts.update(tokenize(row['lemmas']))\n","    except:\n","        pass"],"metadata":{"id":"ChRARckZRtR_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#deleting infrequent words\n","print(\"num_words before:\",len(counts.keys()))\n","for word in list(counts):\n","    if counts[word] < 2:\n","        del counts[word]\n","print(\"num_words after:\",len(counts.keys()))"],"metadata":{"id":"JriWkCxJRtR_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666089583833,"user_tz":-180,"elapsed":471,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"9dbaf0cf-09d8-48cf-e72b-59b3e08efccc"},"execution_count":null,"outputs":[{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["num_words before: 26398\n","num_words after: 13192\n"]}]},{"cell_type":"code","source":["#creating vocabulary\n","vocab2index = {\"\":0, \"UNK\":1}\n","words = [\"\", \"UNK\"]\n","for word in counts:\n","    vocab2index[word] = len(words)\n","    words.append(word)"],"metadata":{"id":"Pc0Tqz7BRtSA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def encode_sentence(text, vocab2index, N=40):\n","    tokenized = tokenize(text)\n","    encoded = np.zeros(N, dtype=int)\n","    enc1 = np.array([vocab2index.get(word, vocab2index[\"UNK\"]) for word in tokenized])\n","    length = min(N, len(enc1))\n","    encoded[:length] = enc1[:length]\n","    return encoded, length"],"metadata":{"id":"-ixeoQDnRtSB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data['encoded'] = data['lemmas'].apply(lambda x: np.array(encode_sentence(x,vocab2index)))\n","data.head()"],"metadata":{"id":"CikrbMj6RtSB","colab":{"base_uri":"https://localhost:8080/","height":497},"executionInfo":{"status":"ok","timestamp":1666089635971,"user_tz":-180,"elapsed":1072,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"47d58f84-8b59-48d3-c809-362a99e95ed0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n","  \"\"\"Entry point for launching an IPython kernel.\n"]},{"output_type":"execute_result","data":{"text/plain":["                                                                                                                                                                                                                            message  category                                                                                                                                                                                                             lemmas                                                                                                                                                               encoded\n","4980                  Let me say at the beginning of this article that I like my face, but that I do intend to get a facelift some day in the future. The older I get the more I'm thinking about it; it's on the list so to speak.         1          let me say at the beginning of this article that i like my face but that i do intend to get a facelift some day in the future the older i get the more i m thinking about it it s on the list so to speak            [[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 11, 12, 17, 1, 18, 19, 20, 21, 22, 23, 24, 6, 25, 6, 26, 12, 19, 6, 27, 12, 28, 29, 30, 31, 31], 40]\n","12365                                                                                                We were envious when we first saw the images of Gwyneth Paltrow in the February issue of Harper's Bazaar. The blonde bombshell         1                                                                                      we were envious when we first saw the images of gwyneth paltrow in the february issue of harper s bazaar the blonde bombshell                      [[37, 38, 39, 40, 37, 41, 42, 6, 43, 8, 44, 45, 24, 6, 46, 47, 8, 48, 32, 49, 6, 50, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 23]\n","4249                                                                                                   Joan Rivers can dish it, but she sure can't take it. Following Jennifer Lawrence's derogatory comments about \"Fashion Police         1                                                                                          joan rivers can dish it but she sure can t take it following jennifer lawrence s derogatory comments about fashion police                    [[52, 53, 54, 55, 31, 16, 56, 57, 54, 58, 59, 31, 60, 61, 62, 32, 1, 63, 30, 64, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 21]\n","9417                                                                                                       See Heidi Klum's Style Evolution here. WHO: German supermogul Heidi Klum Fame Flynet Photo Shop a similar look below and         1                                                                                            see heidi klum s style evolution here who: german supermogul heidi klum fame flynet photo shop a similar look below and                    [[66, 67, 68, 32, 69, 70, 71, 72, 73, 1, 67, 68, 74, 75, 76, 77, 20, 78, 79, 80, 81, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 21]\n","5744   She would find the one leather craftsman in Florence making a copy of a $2,000 French purse, and she would carry that Florentine bag, tucked away lovingly into its fabric-carrying sack at night, for the rest of her life.         1  she would find the one leather craftsman in florence making a copy of a french purse and she would carry that florentine bag tucked away lovingly into its fabric carrying sack at night for the rest of her life  [[56, 82, 83, 6, 84, 85, 86, 24, 87, 88, 20, 89, 8, 20, 90, 91, 81, 56, 82, 92, 11, 1, 93, 94, 95, 96, 97, 98, 99, 100, 1, 5, 101, 102, 6, 103, 8, 104, 105, 0], 39]"],"text/html":["\n","  <div id=\"df-8d6b9816-c231-4393-8316-2ab8b99ef029\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>message</th>\n","      <th>category</th>\n","      <th>lemmas</th>\n","      <th>encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4980</th>\n","      <td>Let me say at the beginning of this article that I like my face, but that I do intend to get a facelift some day in the future. The older I get the more I'm thinking about it; it's on the list so to speak.</td>\n","      <td>1</td>\n","      <td>let me say at the beginning of this article that i like my face but that i do intend to get a facelift some day in the future the older i get the more i m thinking about it it s on the list so to speak</td>\n","      <td>[[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 11, 12, 17, 1, 18, 19, 20, 21, 22, 23, 24, 6, 25, 6, 26, 12, 19, 6, 27, 12, 28, 29, 30, 31, 31], 40]</td>\n","    </tr>\n","    <tr>\n","      <th>12365</th>\n","      <td>We were envious when we first saw the images of Gwyneth Paltrow in the February issue of Harper's Bazaar. The blonde bombshell</td>\n","      <td>1</td>\n","      <td>we were envious when we first saw the images of gwyneth paltrow in the february issue of harper s bazaar the blonde bombshell</td>\n","      <td>[[37, 38, 39, 40, 37, 41, 42, 6, 43, 8, 44, 45, 24, 6, 46, 47, 8, 48, 32, 49, 6, 50, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 23]</td>\n","    </tr>\n","    <tr>\n","      <th>4249</th>\n","      <td>Joan Rivers can dish it, but she sure can't take it. Following Jennifer Lawrence's derogatory comments about \"Fashion Police</td>\n","      <td>1</td>\n","      <td>joan rivers can dish it but she sure can t take it following jennifer lawrence s derogatory comments about fashion police</td>\n","      <td>[[52, 53, 54, 55, 31, 16, 56, 57, 54, 58, 59, 31, 60, 61, 62, 32, 1, 63, 30, 64, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 21]</td>\n","    </tr>\n","    <tr>\n","      <th>9417</th>\n","      <td>See Heidi Klum's Style Evolution here. WHO: German supermogul Heidi Klum Fame Flynet Photo Shop a similar look below and</td>\n","      <td>1</td>\n","      <td>see heidi klum s style evolution here who: german supermogul heidi klum fame flynet photo shop a similar look below and</td>\n","      <td>[[66, 67, 68, 32, 69, 70, 71, 72, 73, 1, 67, 68, 74, 75, 76, 77, 20, 78, 79, 80, 81, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 21]</td>\n","    </tr>\n","    <tr>\n","      <th>5744</th>\n","      <td>She would find the one leather craftsman in Florence making a copy of a $2,000 French purse, and she would carry that Florentine bag, tucked away lovingly into its fabric-carrying sack at night, for the rest of her life.</td>\n","      <td>1</td>\n","      <td>she would find the one leather craftsman in florence making a copy of a french purse and she would carry that florentine bag tucked away lovingly into its fabric carrying sack at night for the rest of her life</td>\n","      <td>[[56, 82, 83, 6, 84, 85, 86, 24, 87, 88, 20, 89, 8, 20, 90, 91, 81, 56, 82, 92, 11, 1, 93, 94, 95, 96, 97, 98, 99, 100, 1, 5, 101, 102, 6, 103, 8, 104, 105, 0], 39]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8d6b9816-c231-4393-8316-2ab8b99ef029')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8d6b9816-c231-4393-8316-2ab8b99ef029 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8d6b9816-c231-4393-8316-2ab8b99ef029');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":211}]},{"cell_type":"code","source":["from torch.utils.data import Dataset\n","import torch"],"metadata":{"id":"SdL9zsh0RtSC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class ReviewsDataset(Dataset):\n","    def __init__(self, X, Y):\n","        self.X = X\n","        self.y = Y\n","        \n","    def __len__(self):\n","        return len(self.X)\n","\n","    def get_labels(self):\n","        return self.y\n","\n","    def __getitem__(self, idx):\n","        if self.y is None:\n","            return torch.from_numpy(self.X[idx][0].astype(np.int32)), 1, self.X[idx][1]\n","        return torch.from_numpy(self.X[idx][0].astype(np.int32)), self.y[idx], self.X[idx][1]"],"metadata":{"id":"oQEZ7cpvRtSC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split"],"metadata":{"id":"cxlVKVqoRtSD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import torch\n","import torch.nn as nn\n","import pandas as pd\n","import numpy as np\n","import re\n","import spacy\n","from collections import Counter\n","from torch.utils.data import Dataset, DataLoader\n","import torch.nn.functional as F\n","import string\n","from torch.nn.utils.rnn import pack_padded_sequence, pad_packed_sequence\n","from sklearn.metrics import mean_squared_error"],"metadata":{"id":"qdWaQsZbRtSE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X = list(data['encoded'])\n","y = list(data['category'])\n","from sklearn.model_selection import train_test_split\n","X_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size=0.2)"],"metadata":{"id":"eBJGp0gMRtSF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_ds = ReviewsDataset(X_train, y_train)\n","valid_ds = ReviewsDataset(X_valid, y_valid)"],"metadata":{"id":"Zd8hdmxHRtSF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["next(iter(train_ds))"],"metadata":{"id":"pZWcYLz4RtSG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666089645729,"user_tz":-180,"elapsed":6,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"150ec759-e8b6-4294-a580-661cf4289036"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(tensor([   1,   84,    8,   14,  828, 6917,  125,   18, 7527,   64,   32,    1,\n","         7528,   81, 7529,  176,    1,  247,  125,  173,  916,    6, 1832,   11,\n","         7530, 7531,  304, 1329, 1768,   81, 7532,   31, 6592,  324,   81, 1406,\n","           81, 3408,  987,  228], dtype=torch.int32), 1, 40)"]},"metadata":{},"execution_count":218}]},{"cell_type":"code","source":["def train_model(model, epochs=10, lr=0.001):\n","    parameters = filter(lambda p: p.requires_grad, model.parameters())\n","    optimizer = torch.optim.Adam(parameters, lr=lr)\n","    for i in range(epochs):\n","        model.train()\n","        sum_loss = 0.0\n","        total = 0\n","        for x, y, l in train_dl:\n","            x = x.long()\n","            y = y.long()\n","            y_pred = model(x, l)\n","            optimizer.zero_grad()\n","            loss = F.cross_entropy(y_pred, y)\n","            loss.backward()\n","            optimizer.step()\n","            sum_loss += loss.item()*y.shape[0]\n","            total += y.shape[0]\n","        val_loss, val_acc, val_rmse = validation_metrics(model, val_dl)\n","        if i % 5 == 1:\n","            print(\"train loss %.3f, val loss %.3f, val accuracy %.3f, and val rmse %.3f\" % (sum_loss/total, val_loss, val_acc, val_rmse))\n","\n","def validation_metrics (model, valid_dl):\n","    model.eval()\n","    correct = 0\n","    total = 0\n","    sum_loss = 0.0\n","    sum_rmse = 0.0\n","    for x, y, l in valid_dl:\n","        x = x.long()\n","        y = y.long()\n","        y_hat = model(x, l)\n","        loss = F.cross_entropy(y_hat, y)\n","        pred = torch.max(y_hat, 1)[1]\n","        correct += (pred == y).float().sum()\n","        total += y.shape[0]\n","        sum_loss += loss.item()*y.shape[0]\n","        sum_rmse += np.sqrt(mean_squared_error(pred, y.unsqueeze(-1)))*y.shape[0]\n","    return sum_loss/total, correct/total, sum_rmse/total"],"metadata":{"id":"NvJh5DYjRtSG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class LSTM_fixed_len(torch.nn.Module) :\n","    def __init__(self, vocab_size, embedding_dim, hidden_dim) :\n","        super().__init__()\n","        self.embeddings = nn.Embedding(vocab_size, embedding_dim, padding_idx=0)\n","        self.lstm = nn.LSTM(embedding_dim, hidden_dim, batch_first=True)\n","        self.linear = nn.Linear(hidden_dim, 2)\n","        self.dropout = nn.Dropout(0.2)\n","        \n","    def forward(self, x, l):\n","        x = self.embeddings(x)\n","        x = self.dropout(x)\n","        lstm_out, (ht, ct) = self.lstm(x)\n","        return self.linear(ht[-1])"],"metadata":{"id":"gYKrcLVGRtSI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# !pip install torchsampler"],"metadata":{"id":"QzgEY1RuRtSJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from torchsampler import ImbalancedDatasetSampler\n"],"metadata":{"id":"xmjEErXIRtSK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["batch_size = 1000\n","vocab_size = len(words)\n","# train_dl = DataLoader(train_ds, batch_size=batch_size,\n","#                       sampler=ImbalancedDatasetSampler(train_ds),)\n","train_dl = DataLoader(train_ds, batch_size=batch_size, shuffle=True, pin_memory=True)\n","val_dl = DataLoader(valid_ds, batch_size=batch_size)"],"metadata":{"id":"ZqQ97Ok9RtSK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# next(iter(train_dl))"],"metadata":{"id":"GFhHfMiORtSM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# model_fixed =  LSTM_fixed_len(vocab_size, 50, 100)\n"],"metadata":{"id":"CJWmJktRRtSM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train_model(model_fixed, epochs=30, lr=0.005)\n"],"metadata":{"id":"1l7SpUWIRtSN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"BxBfeNqwRtSO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Z_bqhc2lRtSP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class CNN(nn.Module):\n","    def __init__(self, vocab_size, embedding_dim, n_filters, filter_sizes, output_dim, dropout_proba):\n","        super().__init__()\n","        \n","        self.embeddings = nn.Embedding(vocab_size, embedding_dim, padding_idx=0)\n","        # self.dropout_1 = nn.Dropout(dropout_proba / 2)          \n","        self.conv_0 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[0], embedding_dim))\n","        self.conv_1 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[1], embedding_dim))\n","        self.conv_2 = nn.Conv2d(in_channels=1, out_channels=n_filters, kernel_size=(filter_sizes[2], embedding_dim))\n","        self.fc = nn.Linear(len(filter_sizes) * n_filters, output_dim)\n","        self.dropout_2 = nn.Dropout(dropout_proba)        \n","    def forward(self, x):\n","        #x = [sent len, batch size]\n","        # x = x.permute(1, 0)\n","                \n","        #x = [batch size, sent len]\n","        embedded = self.embeddings(x)\n","                \n","        #embedded = [batch size, sent len, emb dim]\n","        embedded = embedded.unsqueeze(1)\n","        # embedded = self.dropout_1(embedded)\n","        \n","        #embedded = [batch size, 1, sent len, emb dim]\n","        conved_0 = F.relu(self.conv_0(embedded).squeeze(3))\n","        conved_1 = F.relu(self.conv_1(embedded).squeeze(3))\n","        conved_2 = F.relu(self.conv_2(embedded).squeeze(3))\n","            \n","        #conv_n = [batch size, n_filters, sent len - filter_sizes[n]]\n","        pooled_0 = F.max_pool1d(conved_0, conved_0.shape[2]).squeeze(2)\n","        pooled_1 = F.max_pool1d(conved_1, conved_1.shape[2]).squeeze(2)\n","        pooled_2 = F.max_pool1d(conved_2, conved_2.shape[2]).squeeze(2)\n","        \n","        #pooled_n = [batch size, n_filters]\n","        cat = self.dropout_2(torch.cat((pooled_0, pooled_1, pooled_2), dim=1))\n","\n","        #cat = [batch size, n_filters * len(filter_sizes)]\n","        return self.fc(cat)"],"metadata":{"id":"traOi2iNRtSP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["INPUT_DIM = len(words)\n","EMBEDDING_DIM = 100\n","N_FILTERS = 100\n","FILTER_SIZES = [3,4,5]\n","OUTPUT_DIM = 2\n","DROPOUT_PROBA = 0.4"],"metadata":{"id":"YmLwVPg2RtSR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def train_model(model, epochs=10, lr=0.001):\n","    parameters = filter(lambda p: p.requires_grad, model.parameters())\n","    optimizer = torch.optim.Adam(parameters, lr=lr, weight_decay=1e-3)\n","    for i in range(epochs):\n","        model.train()\n","        sum_loss = 0.0\n","        total = 0\n","        for x, y, l in train_dl:\n","            x = x.long()\n","            y = y.long()\n","            optimizer.zero_grad()\n","            y_pred = model(x).squeeze(1)[:y.shape[0]]\n","            loss = F.cross_entropy(y_pred, y)\n","            loss.backward()\n","            optimizer.step()\n","            sum_loss += loss.item()*y.shape[0]\n","            total += y.shape[0]\n","        val_loss, val_acc = validation_metrics(model, val_dl)\n","        if i % 5 == 1:\n","            print(\"train loss %.3f, val loss %.3f, val accuracy %.3f\" % (sum_loss/total, val_loss, val_acc))\n","\n","def validation_metrics (model, valid_dl):\n","    model.eval()\n","    sum_loss = 0.0\n","    correct = 0\n","    total = 0\n","    with torch.no_grad():\n","        for x, y, l in valid_dl:\n","            x = x.long()\n","            y = y.long()\n","            y_hat = model(x).squeeze(1)[:y.shape[0]]\n","            loss = F.cross_entropy(y_hat, y)\n","            pred = torch.max(y_hat, 1)[1]\n","            correct += (pred == y).float().sum()\n","            total += y.shape[0]\n","            sum_loss += loss.item()*y.shape[0]\n","    return sum_loss/total, correct/total, \n","\n"],"metadata":{"id":"Ljqam_iVRtSR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = CNN(INPUT_DIM, EMBEDDING_DIM, N_FILTERS, FILTER_SIZES, OUTPUT_DIM, DROPOUT_PROBA)"],"metadata":{"id":"CTp9f8wYRtSS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_model(model, epochs=60, lr=0.005)"],"metadata":{"id":"qjKHaJTwRtSS","colab":{"base_uri":"https://localhost:8080/","height":432},"executionInfo":{"status":"error","timestamp":1666090421560,"user_tz":-180,"elapsed":745589,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"aea06805-3c37-48f1-86a1-7b3b3b8f2dec"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["train loss 0.329, val loss 0.279, val accuracy 0.899\n","train loss 0.203, val loss 0.221, val accuracy 0.921\n","train loss 0.173, val loss 0.209, val accuracy 0.925\n","train loss 0.151, val loss 0.217, val accuracy 0.921\n","train loss 0.141, val loss 0.194, val accuracy 0.932\n","train loss 0.128, val loss 0.193, val accuracy 0.933\n"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-229-6e6efb5d9fbf>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mtrain_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepochs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m60\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlr\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0.005\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m<ipython-input-227-c809a447bef6>\u001b[0m in \u001b[0;36mtrain_model\u001b[0;34m(model, epochs, lr)\u001b[0m\n\u001b[1;32m     12\u001b[0m             \u001b[0my_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msqueeze\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m             \u001b[0mloss\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mF\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcross_entropy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_pred\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 14\u001b[0;31m             \u001b[0mloss\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbackward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     15\u001b[0m             \u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     16\u001b[0m             \u001b[0msum_loss\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0mloss\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/torch/_tensor.py\u001b[0m in \u001b[0;36mbackward\u001b[0;34m(self, gradient, retain_graph, create_graph, inputs)\u001b[0m\n\u001b[1;32m    394\u001b[0m                 \u001b[0mcreate_graph\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcreate_graph\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    395\u001b[0m                 inputs=inputs)\n\u001b[0;32m--> 396\u001b[0;31m         \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mautograd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbackward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgradient\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mretain_graph\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcreate_graph\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minputs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    397\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    398\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mregister_hook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/torch/autograd/__init__.py\u001b[0m in \u001b[0;36mbackward\u001b[0;34m(tensors, grad_tensors, retain_graph, create_graph, grad_variables, inputs)\u001b[0m\n\u001b[1;32m    173\u001b[0m     Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass\n\u001b[1;32m    174\u001b[0m         \u001b[0mtensors\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgrad_tensors_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mretain_graph\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcreate_graph\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minputs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 175\u001b[0;31m         allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass\n\u001b[0m\u001b[1;32m    176\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    177\u001b[0m def grad(\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","source":[],"metadata":{"id":"s7HYbHy5RtST"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Combine 2 methods"],"metadata":{"id":"CAlzF_RKt8lc"}},{"cell_type":"code","source":[],"metadata":{"id":"0rOFJWWWt7cN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition = pd.read_csv('test_data.csv')"],"metadata":{"id":"ccWn5yLGuHdd"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1666090431068,"user_tz":-180,"elapsed":17,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"06286728-f0e6-4d73-b90e-74c324bed400","id":"HZ6nT0QSuHde"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ... \n","2      275674                                                                                                                               Vladimir, when will we have seminar?\n","3      275675                                                                                                                                              A couple at 111, too?\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:\n","...       ...                                                                                                                                                                ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc: \n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.\n","\n","[5927 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-d9137cf2-e12b-4cd8-9f68-9f715e53bbea\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d9137cf2-e12b-4cd8-9f68-9f715e53bbea')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d9137cf2-e12b-4cd8-9f68-9f715e53bbea button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d9137cf2-e12b-4cd8-9f68-9f715e53bbea');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":231}]},{"cell_type":"code","source":["submition['encoded'] = submition['message'].apply(lambda x: np.array(encode_sentence(x,vocab2index )))\n","submition.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":263},"executionInfo":{"status":"ok","timestamp":1666090434338,"user_tz":-180,"elapsed":959,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"81b8dace-b21b-495e-cc0a-3afce6f7f249","id":"w8AQho9fuHdf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n","  \"\"\"Entry point for launching an IPython kernel.\n"]},{"output_type":"execute_result","data":{"text/plain":["       id                                             message                                                                                                                                       encoded\n","0  275672        But a lot of people have a job fair tonight.  [[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]\n","1  275673  Also, I got only 4 answers on the google form ...    [[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]\n","2  275674                Vladimir, when will we have seminar?           [[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]\n","3  275675                               A couple at 111, too?              [[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]\n","4  275676               It's on Anti-buying. And again, Zara:                [[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]"],"text/html":["\n","  <div id=\"df-3d9aa226-2188-4222-b5a5-75da790be42f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3d9aa226-2188-4222-b5a5-75da790be42f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3d9aa226-2188-4222-b5a5-75da790be42f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3d9aa226-2188-4222-b5a5-75da790be42f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":232}]},{"cell_type":"code","source":["len(submition)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090437981,"user_tz":-180,"elapsed":660,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"cb411bed-7a27-4d15-af11-01d6bcc39e95","id":"rW_pxbAPuHdf"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["5927"]},"metadata":{},"execution_count":233}]},{"cell_type":"code","source":["submition.loc[0]['encoded'][1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090438652,"user_tz":-180,"elapsed":8,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"aa5db000-e0b9-4b3d-be98-d510d56cd2fe","id":"mdvo9zRpuHdg"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["10"]},"metadata":{},"execution_count":234}]},{"cell_type":"code","source":["X_ = list(submition['encoded'])\n","y_ = None"],"metadata":{"id":"IIcsdlnwuHdg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_ds = ReviewsDataset(X_, y_)"],"metadata":{"id":"xRUKe4XVuHdg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_dl = DataLoader(test_ds, batch_size=batch_size)"],"metadata":{"id":"4_PEJmuXuHdh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["next(iter(test_ds))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090442114,"user_tz":-180,"elapsed":10,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"a889bf76-8c4d-488b-d797-4f2632f3ad28","id":"6-3J8qAAuHdi"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(tensor([   1,   20, 1016,    8,  123,  263,   20,  187, 3003,    1,    0,    0,\n","            0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,\n","            0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,\n","            0,    0,    0,    0], dtype=torch.int32), 1, 10)"]},"metadata":{},"execution_count":238}]},{"cell_type":"code","source":["model.eval()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090444526,"user_tz":-180,"elapsed":11,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"cd05354c-b349-4ac9-aa3d-cf0c246ed95d","id":"NwsDa4VxuHdj"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["CNN(\n","  (embeddings): Embedding(13194, 100, padding_idx=0)\n","  (dropout_1): Dropout(p=0.2, inplace=False)\n","  (conv_0): Conv2d(1, 100, kernel_size=(3, 100), stride=(1, 1))\n","  (conv_1): Conv2d(1, 100, kernel_size=(4, 100), stride=(1, 1))\n","  (conv_2): Conv2d(1, 100, kernel_size=(5, 100), stride=(1, 1))\n","  (fc): Linear(in_features=300, out_features=2, bias=True)\n","  (dropout_2): Dropout(p=0.4, inplace=False)\n",")"]},"metadata":{},"execution_count":239}]},{"cell_type":"code","source":["ans = pd.Series()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090447132,"user_tz":-180,"elapsed":6,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"0d6751d3-679a-4f99-cbb3-f5291da6a024","id":"8rE8RQdYuHdk"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.\n","  \"\"\"Entry point for launching an IPython kernel.\n"]}]},{"cell_type":"code","source":["for x, _, l in test_dl:\n","    x = x.long()\n","    y_pred = model(x)\n","    pred = torch.max(y_pred, 1)[1]\n","    ans = pd.concat([ans, pd.Series(pred)])"],"metadata":{"id":"z4RlKB7puHdl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred = torch.max(y_pred, 1)[1]"],"metadata":{"id":"HPPQhJ5JuHdm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["reslults_cnn = ans.apply(lambda x: 2 if x == 1 else 0)"],"metadata":{"id":"ZCeR3CsNuHdm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["reslults_cnn.loc[:1000]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":487},"id":"gqIwbg6VurN7","executionInfo":{"status":"error","timestamp":1666090546092,"user_tz":-180,"elapsed":957,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"3229d098-1056-4e84-bcf3-6d77bce2e2a8"},"execution_count":null,"outputs":[{"output_type":"error","ename":"KeyError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3360\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3361\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcasted_key\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3362\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine._get_loc_duplicates\u001b[0;34m()\u001b[0m\n","\u001b[0;32mpandas/_libs/index_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.index.Int64Engine._maybe_get_bool_indexer\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine._unpack_bool_indexer\u001b[0;34m()\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 1000","\nThe above exception was the direct cause of the following exception:\n","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-248-df1ffb42fec7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mreslults_cnn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m1000\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m    929\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    930\u001b[0m             \u001b[0mmaybe_callable\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply_if_callable\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 931\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_getitem_axis\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmaybe_callable\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    932\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    933\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_is_scalar_access\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkey\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mtuple\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_getitem_axis\u001b[0;34m(self, key, axis)\u001b[0m\n\u001b[1;32m   1140\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mslice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1141\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_validate_key\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1142\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_slice_axis\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1143\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mcom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mis_bool_indexer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1144\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_getbool_axis\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_get_slice_axis\u001b[0;34m(self, slice_obj, axis)\u001b[0m\n\u001b[1;32m   1174\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1175\u001b[0m         \u001b[0mlabels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mobj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_axis\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1176\u001b[0;31m         \u001b[0mindexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlabels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mslice_indexer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mslice_obj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstart\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mslice_obj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstop\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mslice_obj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1177\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1178\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mslice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mslice_indexer\u001b[0;34m(self, start, end, step, kind)\u001b[0m\n\u001b[1;32m   5683\u001b[0m         \u001b[0mslice\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5684\u001b[0m         \"\"\"\n\u001b[0;32m-> 5685\u001b[0;31m         \u001b[0mstart_slice\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mend_slice\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mslice_locs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstart\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstep\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5686\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5687\u001b[0m         \u001b[0;31m# return a slice\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mslice_locs\u001b[0;34m(self, start, end, step, kind)\u001b[0m\n\u001b[1;32m   5891\u001b[0m         \u001b[0mend_slice\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5892\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mend\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5893\u001b[0;31m             \u001b[0mend_slice\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_slice_bound\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"right\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5894\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mend_slice\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5895\u001b[0m             \u001b[0mend_slice\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_slice_bound\u001b[0;34m(self, label, side, kind)\u001b[0m\n\u001b[1;32m   5805\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5806\u001b[0m                 \u001b[0;31m# raise the original KeyError\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5807\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5808\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5809\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mslc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mndarray\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_slice_bound\u001b[0;34m(self, label, side, kind)\u001b[0m\n\u001b[1;32m   5799\u001b[0m         \u001b[0;31m# we need to look up the label\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5800\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5801\u001b[0;31m             \u001b[0mslc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlabel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5802\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5803\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3361\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcasted_key\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3362\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3363\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3364\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3365\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mis_scalar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0misna\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhasnans\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 1000"]}]},{"cell_type":"code","source":["reslults_cnn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qFRcAPdLu-kS","executionInfo":{"status":"ok","timestamp":1666090563613,"user_tz":-180,"elapsed":592,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"276d87a9-5530-4603-ac34-a5a32780e2b5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0      0\n","1      0\n","2      0\n","3      0\n","4      0\n","      ..\n","922    2\n","923    0\n","924    0\n","925    2\n","926    0\n","Length: 5927, dtype: int64"]},"metadata":{},"execution_count":250}]},{"cell_type":"code","source":[],"metadata":{"id":"kxqsD8HIvLur"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"JtaMBUwevZve"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"pMf_suU5vZsv"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!cp '/content/drive/MyDrive/4 курс/NLP/ДЗ1/RandomForestClassifier.joblib' .\n","!cp '/content/drive/MyDrive/4 курс/NLP/ДЗ1/TfidfVectorizer.joblib' . "],"metadata":{"id":"LIbnCProvaVU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from joblib import dump, load"],"metadata":{"id":"Cyi9aVErvaVV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model_bitcoin_classifier = load('RandomForestClassifier.joblib')\n","model_bitcoin_tfidfconverter = load('TfidfVectorizer.joblib')"],"metadata":{"id":"vljtdvCcvaVW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"V31Qq9ohvpFs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["with Pool(8) as p:\n","    lemmas = list(tqdm(p.imap(clean_text, submition['message']), total=len(submition)))\n","submition['lemmas'] = lemmas\n","submition.sample(10)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["1d019713062f4011990ce5c394427544","d940f7e2e13841ab827fda75757c94b1","27002a5f648944f091742847ed3dc4c1","82d31061ad4743049a029212e733517a","fee28fdca6c44454b1ea50d5be5b8776","4ca35c9611a24906b821e98371338d3e","837c06e80e2e4cb18bb269191d929e15","326bd7d27a7e4905a03a33e601933eae","e01c71ee9b5340eaa41d4141a721fbc4","cf9ce952e4e44b859ee41f3e7682c20e","64b06965a892438b93509052319931a9"]},"id":"CQ4Rya3ovzpX","executionInfo":{"status":"ok","timestamp":1666090801666,"user_tz":-180,"elapsed":8929,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"d4bb1905-c736-4f20-969c-091a531e1c8c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/5927 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1d019713062f4011990ce5c394427544"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          message                                                                                                                                                                            encoded                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           lemmas\n","3883  3141711   The U.S. stock market is cryptic of Coinbase, recording a sharp increase of $1,200 in deposits. This week, the U.S. authorities also began sending out checks to citizens on which they are entitled.  CO Coinbase Brian Armstrong shared the statistics on his Twitter, but he refused to comment.  According to the submitted schedule, deposits of $1,200 usually account for about 0.08 per cent of the platform's total revenue. This week &apos; s deviation of up to 0.375 per cent is statistically significant in order to reasonably link it to the latest American government support measures.  There are 80 million adults in the United States who earn less than $75,000 a year. According to Finance Minister Stephen Mnuchin, they were to receive direct transfers to their bank accounts by 15 April.  N...  [[1, 1, 2220, 2956, 125, 1, 8, 1, 3691, 20, 250, 2540, 8, 1, 24, 1, 1, 1, 6, 1, 3565, 180, 2830, 5347, 189, 9539, 18, 4966, 33, 267, 335, 172, 1, 1, 1, 1, 1, 1477, 6, 5372], 40]  the u s stock market is cryptic of coinbase recording a sharp increase of in deposits this week the u s authorities also began sending out checks to citizens on which they are entitled co coinbase brian armstrong shared the statistics on his twitter but he refused to comment according to the submitted schedule deposits of usually account for about per cent of the platform s total revenue this week apos s deviation of up to per cent is statistically significant in order to reasonably link it to the latest american government support measures there are million adults in the united states who earn less than a year according to finance minister stephen mnuchin they were to receive direct transfers to their bank accounts by april netspend which processed about billion in aid benefits stated...\n","1944   277617                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Cause those who didn't vote are default for no.                                         [[1, 735, 332, 1, 578, 172, 6436, 102, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cause those who didn t vote are default for no\n","5384  3143212                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Okay, so the news is two, and both of them are like one. In the early hours of the year, the cost-effective hats for autumn 2. I got a new head.                      [[1, 35, 6, 301, 125, 1, 81, 396, 8, 441, 172, 13, 1, 1, 6, 306, 1331, 8, 6, 1, 6, 1, 3395, 102, 2333, 1, 1, 548, 20, 223, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         okay so the news is two and both of them are like one in the early hours of the year the cost effective hats for autumn i got a new head\n","2325   277998                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Nikita recommended a good book. See communication No. List of contents Understanding Machine Learning: From Theory to Algorithms                                        [[1, 7990, 20, 670, 1, 1, 351, 1, 1, 8, 10589, 1, 1, 1, 1, 1, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 18]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   nikita recommended a good book see communication no list of contents understanding machine learning: from theory to algorithms\n","3943  3141771                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Original investors received emails from the Telegram core team.  Key items:  1. Following a successful initial testing period, TON is planned to be launched in late October. 2. Investors are provided with the TON Key Generation Software:         [[1, 7803, 3370, 8250, 234, 6, 1, 2525, 1, 1, 1, 1, 1, 20, 2725, 2825, 4464, 1, 1, 125, 600, 18, 158, 2687, 24, 296, 1, 1, 1, 172, 10229, 186, 6, 1, 1, 1, 1, 0, 0, 0], 37]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               original investors received emails from the telegram core team key items: following a successful initial testing period ton is planned to be launched in late october investors are provided with the ton key generation software:\n","5892  3143720                                                                                                                                                                                                                                                                                                                                                                                                      Hey, girls, I've got a quarantine for you (a Quarantine in New Russian - any news in these troubled times): since 20 March, the Aiherb has stopped importing more than 2,000 positions into heaven, including the anti-structural tea and the CIPSE BLA with the KUSSOM (well, let's take the untasteful in the Fixprice). God be with them, but tea and chips!!!! It's a blow below the belt. Detailed list by reference:            [[1, 1, 1, 548, 20, 1303, 102, 113, 1721, 1, 24, 1, 1, 1, 564, 301, 24, 634, 4756, 1, 321, 1, 1, 6, 1, 525, 3436, 1, 27, 471, 1, 1, 97, 1, 2370, 6, 1, 2233, 81, 6], 40]                                                                                                                                                                                                                                                                                                                                                                                                                          hey girls i ve got a quarantine for you (a quarantine in new russian any news in these troubled times): since march the aiherb has stopped importing more than positions into heaven including the anti structural tea and the cipse bla with the kussom (well let s take the untasteful in the fixprice) god be with them but tea and chips!!!! it s a blow below the belt detailed list by reference:\n","2404   278077                                                                                                                                                                                                                                                                                                                                      💰💰💰 Everyone's a winner with Altcoin Fantasy's Free Crypto Trading Contest this week!  💰💰💰  All new users to Bithoven who register through Altcoin Fantasy will get 100 FREE Doge :raised_hands:! On top of that, Bithoven is also sponsoring $500 USD in prizes!!!:fire::fire::fire:  Top 100 players will win prizes! 🥰🥰🥰  🤑🤑🤑Top trader/1st place - $150 in BTC or USDT 🤑🤑🤑2nd place - $100 in BTC or USDT 🤑🤑🤑3rd place - $50 in BTC or USDT 🤑🤑🤑4th to 100th place - $2 in BTC or USDT                         [[1, 1, 20, 1210, 186, 1, 1, 1, 1, 1, 1, 9, 5486, 1, 1, 223, 4787, 18, 1, 332, 175, 304, 1, 1, 215, 19, 1, 1, 1, 1, 1, 248, 8, 1, 1, 125, 180, 1, 1, 1], 40]                                                                                                                                                                                                                                                                                                                                                                                                                 everyone s a winner with altcoin fantasy s free crypto trading contest this week! all new users to bithoven who register through altcoin fantasy will get free doge :raised_hands:! on top of that bithoven is also sponsoring usd in prizes!!!:fire::fire::fire: top players will win prizes! top trader/ st place in btc or usdt nd place in btc or usdt rd place in btc or usdt th to th place in btc or usdt\n","4062  3141890  The last adjustment on Saturday, July 17, was still worth ~ 5% for the fourth consecutive time. The previous adjustment resulted in the largest drop in percentage terms, 28 per cent two weeks ago. With the last fall, the complexity of the Bitcoin has reached a new minimum since January 2020.  This fall was due to the fact that many Chinese engineers have left the Bitcoin network in the last few weeks. The smaller number of people mining BTC units means that fewer units will be added to the BTC block chain. According to the data, the current time interval is 10 minutes.  Interestingly, reducing the complexity of engineering also means that the Bitcoin engineers who stay online will have much more money. Speaking to CNBC during the last difficulty adjustment, Bitcoin mining engineer Bran...   [[1, 568, 1841, 33, 1, 1, 1, 193, 422, 1024, 1, 1, 102, 6, 6374, 11225, 1, 1, 2042, 1841, 1, 24, 6, 4209, 767, 24, 2337, 1, 1, 3617, 3618, 318, 554, 1, 1, 6, 568, 1, 6, 1], 40]  the last adjustment on saturday july was still worth % for the fourth consecutive time the previous adjustment resulted in the largest drop in percentage terms per cent two weeks ago with the last fall the complexity of the bitcoin has reached a new minimum since january this fall was due to the fact that many chinese engineers have left the bitcoin network in the last few weeks the smaller number of people mining btc units means that fewer units will be added to the btc block chain according to the data the current time interval is minutes interestingly reducing the complexity of engineering also means that the bitcoin engineers who stay online will have much more money speaking to cnbc during the last difficulty adjustment bitcoin mining engineer brandon arwanaga reported to the publ...\n","1826   277499                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Examples. Don't look at stylization (especially shoes with bare feet). It wasn't us at the office that Zara was going to collect, it was going to sell. And don't forget that the minimum growth of models is 175 centimetres. ♪ Oh, my God ♪          [[1, 1, 79, 5, 1, 6200, 1808, 186, 2735, 1, 1, 1, 987, 5, 6, 1582, 11, 1, 193, 837, 18, 1, 31, 193, 837, 18, 1, 1, 1, 1555, 11, 6, 3579, 638, 8, 2129, 125, 1, 1, 1], 40]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  examples don t look at stylization (especially shoes with bare feet) it wasn t us at the office that zara was going to collect it was going to sell and don t forget that the minimum growth of models is centimetres oh my god\n","5871  3143699  Good Saturday morning, cosmic forwards!  There are a lot of things you can do in the morning of the weekend -- go down with a warm pussy, read a book, clean up at last. But a couple of days ago, I was swallowed by a fluke monster, I was in hell's anabiosis, and I was a little delusional. As a result of this delusion, a turkey was born, which we discussed and approved on the Great Kathy Council, which I plan to spend this Saturday morning and perhaps a day on.  Katerina Lubereczka and I want to hear your voice and learn about your personal tops. Objectively, we can't know anything cool, but we have a valuable and cool audience, it's you! Each one of you, through long-term selections, shopping, joy and disappointments, has a means in his makeup that eclipses everything else, and no matte...           [[1, 1, 1, 1, 1, 1, 172, 20, 1016, 8, 256, 113, 54, 17, 24, 6, 617, 8, 6, 1394, 1, 207, 669, 186, 20, 497, 1, 464, 20, 1, 2289, 247, 5, 1, 1, 20, 1068, 8, 1768, 1], 40]  good saturday morning cosmic forwards! there are a lot of things you can do in the morning of the weekend go down with a warm pussy read a book clean up at last but a couple of days ago i was swallowed by a fluke monster i was in hell s anabiosis and i was a little delusional as a result of this delusion a turkey was born which we discussed and approved on the great kathy council which i plan to spend this saturday morning and perhaps a day on katerina lubereczka and i want to hear your voice and learn about your personal tops objectively we can t know anything cool but we have a valuable and cool audience it s you! each one of you through long term selections shopping joy and disappointments has a means in his makeup that eclipses everything else and no matter what it is it s or it co..."],"text/html":["\n","  <div id=\"df-49377b24-850e-448a-9820-52e1cde4e8b2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","      <th>lemmas</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3883</th>\n","      <td>3141711</td>\n","      <td>The U.S. stock market is cryptic of Coinbase, recording a sharp increase of $1,200 in deposits. This week, the U.S. authorities also began sending out checks to citizens on which they are entitled.  CO Coinbase Brian Armstrong shared the statistics on his Twitter, but he refused to comment.  According to the submitted schedule, deposits of $1,200 usually account for about 0.08 per cent of the platform's total revenue. This week &amp;apos; s deviation of up to 0.375 per cent is statistically significant in order to reasonably link it to the latest American government support measures.  There are 80 million adults in the United States who earn less than $75,000 a year. According to Finance Minister Stephen Mnuchin, they were to receive direct transfers to their bank accounts by 15 April.  N...</td>\n","      <td>[[1, 1, 2220, 2956, 125, 1, 8, 1, 3691, 20, 250, 2540, 8, 1, 24, 1, 1, 1, 6, 1, 3565, 180, 2830, 5347, 189, 9539, 18, 4966, 33, 267, 335, 172, 1, 1, 1, 1, 1, 1477, 6, 5372], 40]</td>\n","      <td>the u s stock market is cryptic of coinbase recording a sharp increase of in deposits this week the u s authorities also began sending out checks to citizens on which they are entitled co coinbase brian armstrong shared the statistics on his twitter but he refused to comment according to the submitted schedule deposits of usually account for about per cent of the platform s total revenue this week apos s deviation of up to per cent is statistically significant in order to reasonably link it to the latest american government support measures there are million adults in the united states who earn less than a year according to finance minister stephen mnuchin they were to receive direct transfers to their bank accounts by april netspend which processed about billion in aid benefits stated...</td>\n","    </tr>\n","    <tr>\n","      <th>1944</th>\n","      <td>277617</td>\n","      <td>Cause those who didn't vote are default for no.</td>\n","      <td>[[1, 735, 332, 1, 578, 172, 6436, 102, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 9]</td>\n","      <td>cause those who didn t vote are default for no</td>\n","    </tr>\n","    <tr>\n","      <th>5384</th>\n","      <td>3143212</td>\n","      <td>Okay, so the news is two, and both of them are like one. In the early hours of the year, the cost-effective hats for autumn 2. I got a new head.</td>\n","      <td>[[1, 35, 6, 301, 125, 1, 81, 396, 8, 441, 172, 13, 1, 1, 6, 306, 1331, 8, 6, 1, 6, 1, 3395, 102, 2333, 1, 1, 548, 20, 223, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]</td>\n","      <td>okay so the news is two and both of them are like one in the early hours of the year the cost effective hats for autumn i got a new head</td>\n","    </tr>\n","    <tr>\n","      <th>2325</th>\n","      <td>277998</td>\n","      <td>Nikita recommended a good book. See communication No. List of contents Understanding Machine Learning: From Theory to Algorithms</td>\n","      <td>[[1, 7990, 20, 670, 1, 1, 351, 1, 1, 8, 10589, 1, 1, 1, 1, 1, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 18]</td>\n","      <td>nikita recommended a good book see communication no list of contents understanding machine learning: from theory to algorithms</td>\n","    </tr>\n","    <tr>\n","      <th>3943</th>\n","      <td>3141771</td>\n","      <td>Original investors received emails from the Telegram core team.  Key items:  1. Following a successful initial testing period, TON is planned to be launched in late October. 2. Investors are provided with the TON Key Generation Software:</td>\n","      <td>[[1, 7803, 3370, 8250, 234, 6, 1, 2525, 1, 1, 1, 1, 1, 20, 2725, 2825, 4464, 1, 1, 125, 600, 18, 158, 2687, 24, 296, 1, 1, 1, 172, 10229, 186, 6, 1, 1, 1, 1, 0, 0, 0], 37]</td>\n","      <td>original investors received emails from the telegram core team key items: following a successful initial testing period ton is planned to be launched in late october investors are provided with the ton key generation software:</td>\n","    </tr>\n","    <tr>\n","      <th>5892</th>\n","      <td>3143720</td>\n","      <td>Hey, girls, I've got a quarantine for you (a Quarantine in New Russian - any news in these troubled times): since 20 March, the Aiherb has stopped importing more than 2,000 positions into heaven, including the anti-structural tea and the CIPSE BLA with the KUSSOM (well, let's take the untasteful in the Fixprice). God be with them, but tea and chips!!!! It's a blow below the belt. Detailed list by reference:</td>\n","      <td>[[1, 1, 1, 548, 20, 1303, 102, 113, 1721, 1, 24, 1, 1, 1, 564, 301, 24, 634, 4756, 1, 321, 1, 1, 6, 1, 525, 3436, 1, 27, 471, 1, 1, 97, 1, 2370, 6, 1, 2233, 81, 6], 40]</td>\n","      <td>hey girls i ve got a quarantine for you (a quarantine in new russian any news in these troubled times): since march the aiherb has stopped importing more than positions into heaven including the anti structural tea and the cipse bla with the kussom (well let s take the untasteful in the fixprice) god be with them but tea and chips!!!! it s a blow below the belt detailed list by reference:</td>\n","    </tr>\n","    <tr>\n","      <th>2404</th>\n","      <td>278077</td>\n","      <td>💰💰💰 Everyone's a winner with Altcoin Fantasy's Free Crypto Trading Contest this week!  💰💰💰  All new users to Bithoven who register through Altcoin Fantasy will get 100 FREE Doge :raised_hands:! On top of that, Bithoven is also sponsoring $500 USD in prizes!!!:fire::fire::fire:  Top 100 players will win prizes! 🥰🥰🥰  🤑🤑🤑Top trader/1st place - $150 in BTC or USDT 🤑🤑🤑2nd place - $100 in BTC or USDT 🤑🤑🤑3rd place - $50 in BTC or USDT 🤑🤑🤑4th to 100th place - $2 in BTC or USDT</td>\n","      <td>[[1, 1, 20, 1210, 186, 1, 1, 1, 1, 1, 1, 9, 5486, 1, 1, 223, 4787, 18, 1, 332, 175, 304, 1, 1, 215, 19, 1, 1, 1, 1, 1, 248, 8, 1, 1, 125, 180, 1, 1, 1], 40]</td>\n","      <td>everyone s a winner with altcoin fantasy s free crypto trading contest this week! all new users to bithoven who register through altcoin fantasy will get free doge :raised_hands:! on top of that bithoven is also sponsoring usd in prizes!!!:fire::fire::fire: top players will win prizes! top trader/ st place in btc or usdt nd place in btc or usdt rd place in btc or usdt th to th place in btc or usdt</td>\n","    </tr>\n","    <tr>\n","      <th>4062</th>\n","      <td>3141890</td>\n","      <td>The last adjustment on Saturday, July 17, was still worth ~ 5% for the fourth consecutive time. The previous adjustment resulted in the largest drop in percentage terms, 28 per cent two weeks ago. With the last fall, the complexity of the Bitcoin has reached a new minimum since January 2020.  This fall was due to the fact that many Chinese engineers have left the Bitcoin network in the last few weeks. The smaller number of people mining BTC units means that fewer units will be added to the BTC block chain. According to the data, the current time interval is 10 minutes.  Interestingly, reducing the complexity of engineering also means that the Bitcoin engineers who stay online will have much more money. Speaking to CNBC during the last difficulty adjustment, Bitcoin mining engineer Bran...</td>\n","      <td>[[1, 568, 1841, 33, 1, 1, 1, 193, 422, 1024, 1, 1, 102, 6, 6374, 11225, 1, 1, 2042, 1841, 1, 24, 6, 4209, 767, 24, 2337, 1, 1, 3617, 3618, 318, 554, 1, 1, 6, 568, 1, 6, 1], 40]</td>\n","      <td>the last adjustment on saturday july was still worth % for the fourth consecutive time the previous adjustment resulted in the largest drop in percentage terms per cent two weeks ago with the last fall the complexity of the bitcoin has reached a new minimum since january this fall was due to the fact that many chinese engineers have left the bitcoin network in the last few weeks the smaller number of people mining btc units means that fewer units will be added to the btc block chain according to the data the current time interval is minutes interestingly reducing the complexity of engineering also means that the bitcoin engineers who stay online will have much more money speaking to cnbc during the last difficulty adjustment bitcoin mining engineer brandon arwanaga reported to the publ...</td>\n","    </tr>\n","    <tr>\n","      <th>1826</th>\n","      <td>277499</td>\n","      <td>Examples. Don't look at stylization (especially shoes with bare feet). It wasn't us at the office that Zara was going to collect, it was going to sell. And don't forget that the minimum growth of models is 175 centimetres. ♪ Oh, my God ♪</td>\n","      <td>[[1, 1, 79, 5, 1, 6200, 1808, 186, 2735, 1, 1, 1, 987, 5, 6, 1582, 11, 1, 193, 837, 18, 1, 31, 193, 837, 18, 1, 1, 1, 1555, 11, 6, 3579, 638, 8, 2129, 125, 1, 1, 1], 40]</td>\n","      <td>examples don t look at stylization (especially shoes with bare feet) it wasn t us at the office that zara was going to collect it was going to sell and don t forget that the minimum growth of models is centimetres oh my god</td>\n","    </tr>\n","    <tr>\n","      <th>5871</th>\n","      <td>3143699</td>\n","      <td>Good Saturday morning, cosmic forwards!  There are a lot of things you can do in the morning of the weekend -- go down with a warm pussy, read a book, clean up at last. But a couple of days ago, I was swallowed by a fluke monster, I was in hell's anabiosis, and I was a little delusional. As a result of this delusion, a turkey was born, which we discussed and approved on the Great Kathy Council, which I plan to spend this Saturday morning and perhaps a day on.  Katerina Lubereczka and I want to hear your voice and learn about your personal tops. Objectively, we can't know anything cool, but we have a valuable and cool audience, it's you! Each one of you, through long-term selections, shopping, joy and disappointments, has a means in his makeup that eclipses everything else, and no matte...</td>\n","      <td>[[1, 1, 1, 1, 1, 1, 172, 20, 1016, 8, 256, 113, 54, 17, 24, 6, 617, 8, 6, 1394, 1, 207, 669, 186, 20, 497, 1, 464, 20, 1, 2289, 247, 5, 1, 1, 20, 1068, 8, 1768, 1], 40]</td>\n","      <td>good saturday morning cosmic forwards! there are a lot of things you can do in the morning of the weekend go down with a warm pussy read a book clean up at last but a couple of days ago i was swallowed by a fluke monster i was in hell s anabiosis and i was a little delusional as a result of this delusion a turkey was born which we discussed and approved on the great kathy council which i plan to spend this saturday morning and perhaps a day on katerina lubereczka and i want to hear your voice and learn about your personal tops objectively we can t know anything cool but we have a valuable and cool audience it s you! each one of you through long term selections shopping joy and disappointments has a means in his makeup that eclipses everything else and no matter what it is it s or it co...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-49377b24-850e-448a-9820-52e1cde4e8b2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-49377b24-850e-448a-9820-52e1cde4e8b2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-49377b24-850e-448a-9820-52e1cde4e8b2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":259}]},{"cell_type":"code","source":[],"metadata":{"id":"OgtVoBRAvzm1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_test_array = model_bitcoin_tfidfconverter.transform(submition.lemmas.to_list()).toarray()\n","y_pred = model_bitcoin_classifier.predict(X_test_array)"],"metadata":{"id":"sLXkiTdivz__"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pd.Series(y_pred).value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090841084,"user_tz":-180,"elapsed":280,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"dc2c2619-524e-435e-e2cf-5f95280c4603","id":"Mb7R5gMOv0AA"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    5014\n","1     913\n","dtype: int64"]},"metadata":{},"execution_count":261}]},{"cell_type":"code","source":["submition['category_is_bitcoin'] = y_pred"],"metadata":{"id":"yFiDswa0v0AB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":832},"executionInfo":{"status":"ok","timestamp":1666090847739,"user_tz":-180,"elapsed":536,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"f821a385-b6ab-40d8-ddaa-b0f398f8ebd6","id":"nFHDCCvWv0AB"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message                                                                                                                                                             encoded                                                                                                                                                         lemmas  category_is_bitcoin\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.                        [[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]                                                                                                                    but a lot of people have a job fair tonight                    0\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ...                          [[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]                                                                                                                     also i got only answers on the google form                    0\n","2      275674                                                                                                                               Vladimir, when will we have seminar?                                 [[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]                                                                                                                             vladimir when will we have seminar                    0\n","3      275675                                                                                                                                              A couple at 111, too?                                    [[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]                                                                                                                                                a couple at too                    0\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:                                      [[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]                                                                                                                            it s on anti buying and again zara:                    0\n","...       ...                                                                                                                                                                ...                                                                                                                                                                 ...                                                                                                                                                            ...                  ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc:                     [[1, 567, 1, 402, 116, 3532, 81, 1983, 30, 5372, 24, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]                                                                                the second thing write all questions and thoughts about statistics in this doc:                    0\n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?                                      [[1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]                                                                                          can grayscale actually sell bitcoin (btc) after unlock of gbtc shares                    1\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.                   [[1, 173, 20, 269, 1, 7926, 2715, 441, 33, 6, 1, 1, 125, 6, 41, 318, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]                                                                it s not a very operational dude putting them on the schedule wednesday is the first two online                    0\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.  [[1, 243, 1, 1, 4540, 81, 308, 20, 1337, 8, 20, 1, 1, 125, 20, 437, 1780, 1, 1, 1, 173, 1034, 1, 16, 1, 4911, 1226, 102, 1, 81, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]  inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa                    0\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.                                  [[1, 113, 1, 263, 18, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]                                                                                                                             okay you don t have to worry i did                    0\n","\n","[5927 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-9cd37a8d-4ce9-4e7b-bc66-187989a1fb4c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","      <th>lemmas</th>\n","      <th>category_is_bitcoin</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","      <td>but a lot of people have a job fair tonight</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>also i got only answers on the google form</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>vladimir when will we have seminar</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","      <td>a couple at too</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>it s on anti buying and again zara:</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","      <td>[[1, 567, 1, 402, 116, 3532, 81, 1983, 30, 5372, 24, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]</td>\n","      <td>the second thing write all questions and thoughts about statistics in this doc:</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","      <td>[[1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>can grayscale actually sell bitcoin (btc) after unlock of gbtc shares</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","      <td>[[1, 173, 20, 269, 1, 7926, 2715, 441, 33, 6, 1, 1, 125, 6, 41, 318, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]</td>\n","      <td>it s not a very operational dude putting them on the schedule wednesday is the first two online</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","      <td>[[1, 243, 1, 1, 4540, 81, 308, 20, 1337, 8, 20, 1, 1, 125, 20, 437, 1780, 1, 1, 1, 173, 1034, 1, 16, 1, 4911, 1226, 102, 1, 81, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]</td>\n","      <td>inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","      <td>[[1, 113, 1, 263, 18, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]</td>\n","      <td>okay you don t have to worry i did</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9cd37a8d-4ce9-4e7b-bc66-187989a1fb4c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9cd37a8d-4ce9-4e7b-bc66-187989a1fb4c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9cd37a8d-4ce9-4e7b-bc66-187989a1fb4c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":263}]},{"cell_type":"code","source":["reslults_cnn = reslults_cnn.reset_index()"],"metadata":{"id":"eISARMP5wSgS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition['class_0_or_class_2'] = reslults_cnn[0]"],"metadata":{"id":"c-SuK2snv0AC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition.class_0_or_class_2.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090926407,"user_tz":-180,"elapsed":534,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"f1ad7308-46b7-4c3b-f984-b1bcb005a68f","id":"H4QE4LkDv0AD"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    3955\n","2    1972\n","Name: class_0_or_class_2, dtype: int64"]},"metadata":{},"execution_count":271}]},{"cell_type":"code","source":["submition"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":884},"id":"TwiIoGVswfzz","executionInfo":{"status":"ok","timestamp":1666090931210,"user_tz":-180,"elapsed":387,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"f1ab973e-1758-4354-a6b5-2589e5c145a9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           id                                                                                                                                                            message                                                                                                                                                             encoded                                                                                                                                                         lemmas  category_is_bitcoin  class_0_or_class_2\n","0      275672                                                                                                                       But a lot of people have a job fair tonight.                        [[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]                                                                                                                    but a lot of people have a job fair tonight                    0                   0\n","1      275673                                                                                                                 Also, I got only 4 answers on the google form ...                          [[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]                                                                                                                     also i got only answers on the google form                    0                   0\n","2      275674                                                                                                                               Vladimir, when will we have seminar?                                 [[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]                                                                                                                             vladimir when will we have seminar                    0                   0\n","3      275675                                                                                                                                              A couple at 111, too?                                    [[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]                                                                                                                                                a couple at too                    0                   0\n","4      275676                                                                                                                              It's on Anti-buying. And again, Zara:                                      [[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]                                                                                                                            it s on anti buying and again zara:                    0                   0\n","...       ...                                                                                                                                                                ...                                                                                                                                                                 ...                                                                                                                                                            ...                  ...                 ...\n","5922  3143750                                                                                  The second thing, write all questions and thoughts about statistics in this doc:                     [[1, 567, 1, 402, 116, 3532, 81, 1983, 30, 5372, 24, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]                                                                                the second thing write all questions and thoughts about statistics in this doc:                    0                   2\n","5923  3143751                                                                                             Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?                                      [[1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]                                                                                          can grayscale actually sell bitcoin (btc) after unlock of gbtc shares                    1                   0\n","5924  3143752                                                                  It's not a very operational dude putting them on the schedule. Wednesday is the first two online.                   [[1, 173, 20, 269, 1, 7926, 2715, 441, 33, 6, 1, 1, 125, 6, 41, 318, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]                                                                it s not a very operational dude putting them on the schedule wednesday is the first two online                    0                   0\n","5925  3143753  Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.  [[1, 243, 1, 1, 4540, 81, 308, 20, 1337, 8, 20, 1, 1, 125, 20, 437, 1780, 1, 1, 1, 173, 1034, 1, 16, 1, 4911, 1226, 102, 1, 81, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]  inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa                    0                   2\n","5926  3143754                                                                                                                              Okay, you don't have to worry, I did.                                  [[1, 113, 1, 263, 18, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]                                                                                                                             okay you don t have to worry i did                    0                   0\n","\n","[5927 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-c3793124-4ce9-483a-9f8b-6399be78ceb1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>encoded</th>\n","      <th>lemmas</th>\n","      <th>category_is_bitcoin</th>\n","      <th>class_0_or_class_2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>But a lot of people have a job fair tonight.</td>\n","      <td>[[1, 20, 1016, 8, 123, 263, 20, 187, 3003, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10]</td>\n","      <td>but a lot of people have a job fair tonight</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>Also, I got only 4 answers on the google form ...</td>\n","      <td>[[1, 1, 548, 916, 1, 5477, 33, 6, 1844, 135, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>also i got only answers on the google form</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>Vladimir, when will we have seminar?</td>\n","      <td>[[1, 40, 215, 37, 263, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>vladimir when will we have seminar</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>A couple at 111, too?</td>\n","      <td>[[1, 1068, 5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 5]</td>\n","      <td>a couple at too</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>It's on Anti-buying. And again, Zara:</td>\n","      <td>[[1, 33, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6]</td>\n","      <td>it s on anti buying and again zara:</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5922</th>\n","      <td>3143750</td>\n","      <td>The second thing, write all questions and thoughts about statistics in this doc:</td>\n","      <td>[[1, 567, 1, 402, 116, 3532, 81, 1983, 30, 5372, 24, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13]</td>\n","      <td>the second thing write all questions and thoughts about statistics in this doc:</td>\n","      <td>0</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>5923</th>\n","      <td>3143751</td>\n","      <td>Can Grayscale Actually Sell Bitcoin (BTC) After Unlock of GBTC Shares?</td>\n","      <td>[[1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 11]</td>\n","      <td>can grayscale actually sell bitcoin (btc) after unlock of gbtc shares</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5924</th>\n","      <td>3143752</td>\n","      <td>It's not a very operational dude putting them on the schedule. Wednesday is the first two online.</td>\n","      <td>[[1, 173, 20, 269, 1, 7926, 2715, 441, 33, 6, 1, 1, 125, 6, 41, 318, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 17]</td>\n","      <td>it s not a very operational dude putting them on the schedule wednesday is the first two online</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5925</th>\n","      <td>3143753</td>\n","      <td>Inspired by Sonia Miro's goddess and made a hell of a shooter. Lyner is a cat eyes Art Vision. It's not exactly sturdy, but it's thin enough for TV and CREATIVA.</td>\n","      <td>[[1, 243, 1, 1, 4540, 81, 308, 20, 1337, 8, 20, 1, 1, 125, 20, 437, 1780, 1, 1, 1, 173, 1034, 1, 16, 1, 4911, 1226, 102, 1, 81, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 31]</td>\n","      <td>inspired by sonia miro s goddess and made a hell of a shooter lyner is a cat eyes art vision it s not exactly sturdy but it s thin enough for tv and creativa</td>\n","      <td>0</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>5926</th>\n","      <td>3143754</td>\n","      <td>Okay, you don't have to worry, I did.</td>\n","      <td>[[1, 113, 1, 263, 18, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8]</td>\n","      <td>okay you don t have to worry i did</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5927 rows × 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c3793124-4ce9-483a-9f8b-6399be78ceb1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c3793124-4ce9-483a-9f8b-6399be78ceb1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c3793124-4ce9-483a-9f8b-6399be78ceb1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":272}]},{"cell_type":"code","source":[],"metadata":{"id":"rCMS1WL_whD5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"wH8q16DKwtNk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"3yzp8s_0wtLm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"rbof92suwtJE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["ans = []\n","for index, row in submition.iterrows():\n","    if row['category_is_bitcoin'] == 1:\n","        ans.append(1)\n","    else:\n","        ans.append(row['class_0_or_class_2'])"],"metadata":{"id":"Cw3cf-Lzwtoa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submition['category'] = pd.Series(ans)"],"metadata":{"id":"7vRfGbnBwtob"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["answer_for_only_1_class = submition[['id', 'category']]"],"metadata":{"id":"1fnP0rswwtoc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["answer_for_only_1_class.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1666090991918,"user_tz":-180,"elapsed":14,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"37c0a3f3-98cf-4b65-b49d-5c78b2546f09","id":"UboCBUOQwtod"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       id  category\n","0  275672         0\n","1  275673         0\n","2  275674         0\n","3  275675         0\n","4  275676         0"],"text/html":["\n","  <div id=\"df-8cee8d46-ce09-43bf-9000-88eb04eb851e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>category</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>275672</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>275673</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>275674</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>275675</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>275676</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8cee8d46-ce09-43bf-9000-88eb04eb851e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8cee8d46-ce09-43bf-9000-88eb04eb851e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8cee8d46-ce09-43bf-9000-88eb04eb851e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":276}]},{"cell_type":"code","source":["answer_for_only_1_class['category'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1666090993724,"user_tz":-180,"elapsed":9,"user":{"displayName":"Михаил Яковлев","userId":"08377244301379534836"}},"outputId":"e4d5b8c7-e4bd-4d50-ed0a-ff59cedeb9da","id":"wMm_jDjGwtod"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    3731\n","2    1283\n","1     913\n","Name: category, dtype: int64"]},"metadata":{},"execution_count":277}]},{"cell_type":"code","source":["answer_for_only_1_class.to_csv(\"ans_cnn_tfidf.csv\", index = False)"],"metadata":{"id":"3UUIvWZLwtoe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"lVWOZZlpw4Fz"},"execution_count":null,"outputs":[]}]}